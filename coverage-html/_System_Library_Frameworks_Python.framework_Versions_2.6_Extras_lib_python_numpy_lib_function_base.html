<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv='Content-Type' content='text/html; charset=utf-8'>
<title>Coverage for /System/Library/Frameworks/Python.framework/Versions/2.6/Extras/lib/python/numpy/lib/function_base</title>
<link rel='stylesheet' href='style.css' type='text/css'>
<script type='text/javascript' src='jquery-1.3.2.min.js'></script>
<script type='text/javascript'>
function toggle_lines(btn, cls) {
    var btn = $(btn);
    var hide = "hide_"+cls;
    if (btn.hasClass(hide)) {
        $("#source ."+cls).removeClass(hide);
        btn.removeClass(hide);
    }
    else {
        $("#source ."+cls).addClass(hide);
        btn.addClass(hide);
    }
}
</script>
</head>
<body>
<div id='header'>
    <div class='content'>
        <h1>Coverage for <b>/System/Library/Frameworks/Python.framework/Versions/2.6/Extras/lib/python/numpy/lib/function_base</b> :
            <span class='pc_cov'>11%</span>
        </h1>
        <h2 class='stats'>
            800 statements
            <span class='run hide_run' onclick='toggle_lines(this, "run")'>87 run</span>
            <span class='exc' onclick='toggle_lines(this, "exc")'>0 excluded</span>
            <span class='mis' onclick='toggle_lines(this, "mis")'>713 missing</span>
            
        </h2>
    </div>
</div>

<div id='source'>
<table cellspacing='0' cellpadding='0'>
<tr>
<td class='linenos' valign='top'>
<p class='stm run hide_run'>1</p>
<p class='stm run hide_run'>2</p>
<p class='pln'>3</p>
<p class='pln'>4</p>
<p class='pln'>5</p>
<p class='pln'>6</p>
<p class='pln'>7</p>
<p class='pln'>8</p>
<p class='pln'>9</p>
<p class='pln'>10</p>
<p class='pln'>11</p>
<p class='pln'>12</p>
<p class='pln'>13</p>
<p class='stm run hide_run'>14</p>
<p class='pln'>15</p>
<p class='stm run hide_run'>16</p>
<p class='stm run hide_run'>17</p>
<p class='stm run hide_run'>18</p>
<p class='pln'>19</p>
<p class='stm run hide_run'>20</p>
<p class='pln'>21</p>
<p class='stm run hide_run'>22</p>
<p class='pln'>23</p>
<p class='stm run hide_run'>24</p>
<p class='stm run hide_run'>25</p>
<p class='stm run hide_run'>26</p>
<p class='stm run hide_run'>27</p>
<p class='stm run hide_run'>28</p>
<p class='stm run hide_run'>29</p>
<p class='stm run hide_run'>30</p>
<p class='stm run hide_run'>31</p>
<p class='pln'>32</p>
<p class='pln'>33</p>
<p class='pln'>34</p>
<p class='stm run hide_run'>35</p>
<p class='pln'>36</p>
<p class='pln'>37</p>
<p class='pln'>38</p>
<p class='pln'>39</p>
<p class='pln'>40</p>
<p class='pln'>41</p>
<p class='pln'>42</p>
<p class='pln'>43</p>
<p class='pln'>44</p>
<p class='pln'>45</p>
<p class='pln'>46</p>
<p class='pln'>47</p>
<p class='pln'>48</p>
<p class='pln'>49</p>
<p class='pln'>50</p>
<p class='pln'>51</p>
<p class='pln'>52</p>
<p class='pln'>53</p>
<p class='pln'>54</p>
<p class='pln'>55</p>
<p class='pln'>56</p>
<p class='pln'>57</p>
<p class='pln'>58</p>
<p class='pln'>59</p>
<p class='pln'>60</p>
<p class='pln'>61</p>
<p class='pln'>62</p>
<p class='pln'>63</p>
<p class='pln'>64</p>
<p class='pln'>65</p>
<p class='pln'>66</p>
<p class='pln'>67</p>
<p class='pln'>68</p>
<p class='pln'>69</p>
<p class='pln'>70</p>
<p class='pln'>71</p>
<p class='pln'>72</p>
<p class='pln'>73</p>
<p class='pln'>74</p>
<p class='pln'>75</p>
<p class='pln'>76</p>
<p class='pln'>77</p>
<p class='pln'>78</p>
<p class='pln'>79</p>
<p class='pln'>80</p>
<p class='pln'>81</p>
<p class='pln'>82</p>
<p class='pln'>83</p>
<p class='pln'>84</p>
<p class='pln'>85</p>
<p class='pln'>86</p>
<p class='pln'>87</p>
<p class='pln'>88</p>
<p class='pln'>89</p>
<p class='pln'>90</p>
<p class='pln'>91</p>
<p class='pln'>92</p>
<p class='pln'>93</p>
<p class='pln'>94</p>
<p class='pln'>95</p>
<p class='pln'>96</p>
<p class='pln'>97</p>
<p class='pln'>98</p>
<p class='pln'>99</p>
<p class='stm mis'>100</p>
<p class='stm mis'>101</p>
<p class='stm mis'>102</p>
<p class='stm mis'>103</p>
<p class='stm mis'>104</p>
<p class='stm mis'>105</p>
<p class='stm mis'>106</p>
<p class='stm mis'>107</p>
<p class='stm mis'>108</p>
<p class='pln'>109</p>
<p class='stm mis'>110</p>
<p class='stm mis'>111</p>
<p class='stm mis'>112</p>
<p class='stm mis'>113</p>
<p class='pln'>114</p>
<p class='stm mis'>115</p>
<p class='pln'>116</p>
<p class='stm run hide_run'>117</p>
<p class='pln'>118</p>
<p class='pln'>119</p>
<p class='pln'>120</p>
<p class='pln'>121</p>
<p class='pln'>122</p>
<p class='pln'>123</p>
<p class='pln'>124</p>
<p class='pln'>125</p>
<p class='pln'>126</p>
<p class='pln'>127</p>
<p class='pln'>128</p>
<p class='pln'>129</p>
<p class='pln'>130</p>
<p class='pln'>131</p>
<p class='pln'>132</p>
<p class='pln'>133</p>
<p class='pln'>134</p>
<p class='pln'>135</p>
<p class='pln'>136</p>
<p class='pln'>137</p>
<p class='pln'>138</p>
<p class='pln'>139</p>
<p class='pln'>140</p>
<p class='pln'>141</p>
<p class='pln'>142</p>
<p class='pln'>143</p>
<p class='pln'>144</p>
<p class='pln'>145</p>
<p class='pln'>146</p>
<p class='pln'>147</p>
<p class='pln'>148</p>
<p class='pln'>149</p>
<p class='pln'>150</p>
<p class='pln'>151</p>
<p class='pln'>152</p>
<p class='pln'>153</p>
<p class='pln'>154</p>
<p class='pln'>155</p>
<p class='pln'>156</p>
<p class='pln'>157</p>
<p class='pln'>158</p>
<p class='pln'>159</p>
<p class='pln'>160</p>
<p class='pln'>161</p>
<p class='pln'>162</p>
<p class='pln'>163</p>
<p class='pln'>164</p>
<p class='pln'>165</p>
<p class='pln'>166</p>
<p class='pln'>167</p>
<p class='pln'>168</p>
<p class='pln'>169</p>
<p class='pln'>170</p>
<p class='pln'>171</p>
<p class='pln'>172</p>
<p class='pln'>173</p>
<p class='pln'>174</p>
<p class='pln'>175</p>
<p class='pln'>176</p>
<p class='pln'>177</p>
<p class='pln'>178</p>
<p class='pln'>179</p>
<p class='pln'>180</p>
<p class='pln'>181</p>
<p class='pln'>182</p>
<p class='pln'>183</p>
<p class='pln'>184</p>
<p class='pln'>185</p>
<p class='stm mis'>186</p>
<p class='stm mis'>187</p>
<p class='pln'>188</p>
<p class='stm run hide_run'>189</p>
<p class='stm mis'>190</p>
<p class='stm mis'>191</p>
<p class='stm mis'>192</p>
<p class='pln'>193</p>
<p class='stm run hide_run'>194</p>
<p class='pln'>195</p>
<p class='pln'>196</p>
<p class='pln'>197</p>
<p class='pln'>198</p>
<p class='pln'>199</p>
<p class='pln'>200</p>
<p class='pln'>201</p>
<p class='pln'>202</p>
<p class='pln'>203</p>
<p class='pln'>204</p>
<p class='pln'>205</p>
<p class='pln'>206</p>
<p class='pln'>207</p>
<p class='pln'>208</p>
<p class='pln'>209</p>
<p class='pln'>210</p>
<p class='pln'>211</p>
<p class='pln'>212</p>
<p class='pln'>213</p>
<p class='pln'>214</p>
<p class='pln'>215</p>
<p class='pln'>216</p>
<p class='pln'>217</p>
<p class='pln'>218</p>
<p class='pln'>219</p>
<p class='pln'>220</p>
<p class='pln'>221</p>
<p class='pln'>222</p>
<p class='pln'>223</p>
<p class='pln'>224</p>
<p class='pln'>225</p>
<p class='pln'>226</p>
<p class='pln'>227</p>
<p class='pln'>228</p>
<p class='pln'>229</p>
<p class='pln'>230</p>
<p class='pln'>231</p>
<p class='pln'>232</p>
<p class='pln'>233</p>
<p class='pln'>234</p>
<p class='pln'>235</p>
<p class='pln'>236</p>
<p class='pln'>237</p>
<p class='pln'>238</p>
<p class='pln'>239</p>
<p class='pln'>240</p>
<p class='pln'>241</p>
<p class='pln'>242</p>
<p class='pln'>243</p>
<p class='pln'>244</p>
<p class='pln'>245</p>
<p class='pln'>246</p>
<p class='pln'>247</p>
<p class='pln'>248</p>
<p class='pln'>249</p>
<p class='pln'>250</p>
<p class='pln'>251</p>
<p class='pln'>252</p>
<p class='pln'>253</p>
<p class='pln'>254</p>
<p class='pln'>255</p>
<p class='pln'>256</p>
<p class='pln'>257</p>
<p class='pln'>258</p>
<p class='pln'>259</p>
<p class='pln'>260</p>
<p class='pln'>261</p>
<p class='pln'>262</p>
<p class='pln'>263</p>
<p class='pln'>264</p>
<p class='stm mis'>265</p>
<p class='stm mis'>266</p>
<p class='pln'>267</p>
<p class='pln'>268</p>
<p class='pln'>269</p>
<p class='pln'>270</p>
<p class='pln'>271</p>
<p class='pln'>272</p>
<p class='pln'>273</p>
<p class='pln'>274</p>
<p class='pln'>275</p>
<p class='pln'>276</p>
<p class='pln'>277</p>
<p class='pln'>278</p>
<p class='stm mis'>279</p>
<p class='pln'>280</p>
<p class='stm mis'>281</p>
<p class='stm mis'>282</p>
<p class='stm mis'>283</p>
<p class='stm mis'>284</p>
<p class='pln'>285</p>
<p class='pln'>286</p>
<p class='stm mis'>287</p>
<p class='stm mis'>288</p>
<p class='stm mis'>289</p>
<p class='stm mis'>290</p>
<p class='stm mis'>291</p>
<p class='stm mis'>292</p>
<p class='stm mis'>293</p>
<p class='stm mis'>294</p>
<p class='pln'>295</p>
<p class='stm mis'>296</p>
<p class='stm mis'>297</p>
<p class='stm mis'>298</p>
<p class='stm mis'>299</p>
<p class='stm mis'>300</p>
<p class='stm mis'>301</p>
<p class='pln'>302</p>
<p class='pln'>303</p>
<p class='stm mis'>304</p>
<p class='stm mis'>305</p>
<p class='pln'>306</p>
<p class='pln'>307</p>
<p class='stm mis'>308</p>
<p class='stm mis'>309</p>
<p class='stm mis'>310</p>
<p class='stm mis'>311</p>
<p class='stm mis'>312</p>
<p class='stm mis'>313</p>
<p class='pln'>314</p>
<p class='stm mis'>315</p>
<p class='stm mis'>316</p>
<p class='stm mis'>317</p>
<p class='pln'>318</p>
<p class='stm mis'>319</p>
<p class='pln'>320</p>
<p class='pln'>321</p>
<p class='pln'>322</p>
<p class='pln'>323</p>
<p class='stm mis'>324</p>
<p class='stm mis'>325</p>
<p class='stm mis'>326</p>
<p class='pln'>327</p>
<p class='pln'>328</p>
<p class='pln'>329</p>
<p class='pln'>330</p>
<p class='pln'>331</p>
<p class='pln'>332</p>
<p class='pln'>333</p>
<p class='pln'>334</p>
<p class='pln'>335</p>
<p class='pln'>336</p>
<p class='pln'>337</p>
<p class='pln'>338</p>
<p class='pln'>339</p>
<p class='pln'>340</p>
<p class='pln'>341</p>
<p class='pln'>342</p>
<p class='pln'>343</p>
<p class='stm mis'>344</p>
<p class='stm mis'>345</p>
<p class='stm mis'>346</p>
<p class='stm mis'>347</p>
<p class='stm mis'>348</p>
<p class='stm mis'>349</p>
<p class='stm mis'>350</p>
<p class='pln'>351</p>
<p class='stm mis'>352</p>
<p class='stm mis'>353</p>
<p class='stm mis'>354</p>
<p class='stm mis'>355</p>
<p class='pln'>356</p>
<p class='pln'>357</p>
<p class='stm mis'>358</p>
<p class='stm mis'>359</p>
<p class='stm mis'>360</p>
<p class='stm mis'>361</p>
<p class='stm mis'>362</p>
<p class='stm mis'>363</p>
<p class='stm mis'>364</p>
<p class='stm mis'>365</p>
<p class='pln'>366</p>
<p class='stm mis'>367</p>
<p class='stm mis'>368</p>
<p class='stm mis'>369</p>
<p class='pln'>370</p>
<p class='pln'>371</p>
<p class='stm mis'>372</p>
<p class='stm mis'>373</p>
<p class='pln'>374</p>
<p class='stm mis'>375</p>
<p class='stm mis'>376</p>
<p class='pln'>377</p>
<p class='stm mis'>378</p>
<p class='stm mis'>379</p>
<p class='stm mis'>380</p>
<p class='stm mis'>381</p>
<p class='stm mis'>382</p>
<p class='pln'>383</p>
<p class='pln'>384</p>
<p class='stm mis'>385</p>
<p class='stm mis'>386</p>
<p class='stm mis'>387</p>
<p class='stm mis'>388</p>
<p class='stm mis'>389</p>
<p class='stm mis'>390</p>
<p class='stm mis'>391</p>
<p class='stm mis'>392</p>
<p class='stm mis'>393</p>
<p class='pln'>394</p>
<p class='stm mis'>395</p>
<p class='pln'>396</p>
<p class='stm mis'>397</p>
<p class='pln'>398</p>
<p class='stm mis'>399</p>
<p class='stm mis'>400</p>
<p class='stm mis'>401</p>
<p class='stm mis'>402</p>
<p class='stm mis'>403</p>
<p class='pln'>404</p>
<p class='pln'>405</p>
<p class='stm run hide_run'>406</p>
<p class='pln'>407</p>
<p class='pln'>408</p>
<p class='pln'>409</p>
<p class='pln'>410</p>
<p class='pln'>411</p>
<p class='pln'>412</p>
<p class='pln'>413</p>
<p class='pln'>414</p>
<p class='pln'>415</p>
<p class='pln'>416</p>
<p class='pln'>417</p>
<p class='pln'>418</p>
<p class='pln'>419</p>
<p class='pln'>420</p>
<p class='pln'>421</p>
<p class='pln'>422</p>
<p class='pln'>423</p>
<p class='pln'>424</p>
<p class='pln'>425</p>
<p class='pln'>426</p>
<p class='pln'>427</p>
<p class='pln'>428</p>
<p class='pln'>429</p>
<p class='pln'>430</p>
<p class='pln'>431</p>
<p class='pln'>432</p>
<p class='pln'>433</p>
<p class='pln'>434</p>
<p class='pln'>435</p>
<p class='pln'>436</p>
<p class='pln'>437</p>
<p class='pln'>438</p>
<p class='pln'>439</p>
<p class='pln'>440</p>
<p class='pln'>441</p>
<p class='pln'>442</p>
<p class='pln'>443</p>
<p class='pln'>444</p>
<p class='pln'>445</p>
<p class='pln'>446</p>
<p class='pln'>447</p>
<p class='pln'>448</p>
<p class='pln'>449</p>
<p class='pln'>450</p>
<p class='pln'>451</p>
<p class='pln'>452</p>
<p class='pln'>453</p>
<p class='pln'>454</p>
<p class='pln'>455</p>
<p class='pln'>456</p>
<p class='stm mis'>457</p>
<p class='pln'>458</p>
<p class='stm mis'>459</p>
<p class='stm mis'>460</p>
<p class='pln'>461</p>
<p class='stm mis'>462</p>
<p class='stm mis'>463</p>
<p class='pln'>464</p>
<p class='stm mis'>465</p>
<p class='stm mis'>466</p>
<p class='stm mis'>467</p>
<p class='stm mis'>468</p>
<p class='stm mis'>469</p>
<p class='pln'>470</p>
<p class='stm mis'>471</p>
<p class='stm mis'>472</p>
<p class='stm mis'>473</p>
<p class='stm mis'>474</p>
<p class='pln'>475</p>
<p class='stm mis'>476</p>
<p class='stm mis'>477</p>
<p class='pln'>478</p>
<p class='pln'>479</p>
<p class='pln'>480</p>
<p class='stm mis'>481</p>
<p class='stm mis'>482</p>
<p class='stm mis'>483</p>
<p class='pln'>484</p>
<p class='stm mis'>485</p>
<p class='stm mis'>486</p>
<p class='stm mis'>487</p>
<p class='stm mis'>488</p>
<p class='pln'>489</p>
<p class='pln'>490</p>
<p class='stm mis'>491</p>
<p class='stm mis'>492</p>
<p class='stm mis'>493</p>
<p class='stm mis'>494</p>
<p class='pln'>495</p>
<p class='pln'>496</p>
<p class='stm mis'>497</p>
<p class='stm mis'>498</p>
<p class='stm mis'>499</p>
<p class='stm mis'>500</p>
<p class='pln'>501</p>
<p class='stm mis'>502</p>
<p class='stm mis'>503</p>
<p class='stm mis'>504</p>
<p class='pln'>505</p>
<p class='stm mis'>506</p>
<p class='pln'>507</p>
<p class='pln'>508</p>
<p class='stm mis'>509</p>
<p class='stm mis'>510</p>
<p class='stm mis'>511</p>
<p class='pln'>512</p>
<p class='pln'>513</p>
<p class='pln'>514</p>
<p class='pln'>515</p>
<p class='stm mis'>516</p>
<p class='stm mis'>517</p>
<p class='pln'>518</p>
<p class='stm mis'>519</p>
<p class='pln'>520</p>
<p class='stm mis'>521</p>
<p class='pln'>522</p>
<p class='pln'>523</p>
<p class='stm mis'>524</p>
<p class='pln'>525</p>
<p class='pln'>526</p>
<p class='stm mis'>527</p>
<p class='pln'>528</p>
<p class='pln'>529</p>
<p class='stm mis'>530</p>
<p class='stm mis'>531</p>
<p class='stm mis'>532</p>
<p class='stm mis'>533</p>
<p class='stm mis'>534</p>
<p class='stm mis'>535</p>
<p class='pln'>536</p>
<p class='pln'>537</p>
<p class='pln'>538</p>
<p class='stm mis'>539</p>
<p class='stm mis'>540</p>
<p class='pln'>541</p>
<p class='stm mis'>542</p>
<p class='stm mis'>543</p>
<p class='stm mis'>544</p>
<p class='pln'>545</p>
<p class='pln'>546</p>
<p class='stm mis'>547</p>
<p class='stm mis'>548</p>
<p class='stm mis'>549</p>
<p class='stm mis'>550</p>
<p class='stm mis'>551</p>
<p class='pln'>552</p>
<p class='pln'>553</p>
<p class='stm mis'>554</p>
<p class='stm mis'>555</p>
<p class='pln'>556</p>
<p class='pln'>557</p>
<p class='stm mis'>558</p>
<p class='stm mis'>559</p>
<p class='stm mis'>560</p>
<p class='stm mis'>561</p>
<p class='stm mis'>562</p>
<p class='stm mis'>563</p>
<p class='stm mis'>564</p>
<p class='pln'>565</p>
<p class='stm mis'>566</p>
<p class='stm mis'>567</p>
<p class='stm mis'>568</p>
<p class='pln'>569</p>
<p class='pln'>570</p>
<p class='stm run hide_run'>571</p>
<p class='pln'>572</p>
<p class='pln'>573</p>
<p class='pln'>574</p>
<p class='pln'>575</p>
<p class='pln'>576</p>
<p class='pln'>577</p>
<p class='pln'>578</p>
<p class='pln'>579</p>
<p class='pln'>580</p>
<p class='pln'>581</p>
<p class='pln'>582</p>
<p class='pln'>583</p>
<p class='pln'>584</p>
<p class='pln'>585</p>
<p class='pln'>586</p>
<p class='pln'>587</p>
<p class='pln'>588</p>
<p class='pln'>589</p>
<p class='pln'>590</p>
<p class='pln'>591</p>
<p class='pln'>592</p>
<p class='pln'>593</p>
<p class='pln'>594</p>
<p class='pln'>595</p>
<p class='pln'>596</p>
<p class='pln'>597</p>
<p class='pln'>598</p>
<p class='pln'>599</p>
<p class='pln'>600</p>
<p class='pln'>601</p>
<p class='pln'>602</p>
<p class='pln'>603</p>
<p class='pln'>604</p>
<p class='pln'>605</p>
<p class='pln'>606</p>
<p class='pln'>607</p>
<p class='pln'>608</p>
<p class='pln'>609</p>
<p class='pln'>610</p>
<p class='pln'>611</p>
<p class='pln'>612</p>
<p class='pln'>613</p>
<p class='pln'>614</p>
<p class='pln'>615</p>
<p class='pln'>616</p>
<p class='pln'>617</p>
<p class='pln'>618</p>
<p class='pln'>619</p>
<p class='pln'>620</p>
<p class='pln'>621</p>
<p class='pln'>622</p>
<p class='pln'>623</p>
<p class='pln'>624</p>
<p class='pln'>625</p>
<p class='pln'>626</p>
<p class='stm mis'>627</p>
<p class='stm mis'>628</p>
<p class='pln'>629</p>
<p class='stm mis'>630</p>
<p class='stm mis'>631</p>
<p class='stm mis'>632</p>
<p class='pln'>633</p>
<p class='stm mis'>634</p>
<p class='stm mis'>635</p>
<p class='pln'>636</p>
<p class='pln'>637</p>
<p class='stm mis'>638</p>
<p class='stm mis'>639</p>
<p class='stm mis'>640</p>
<p class='stm mis'>641</p>
<p class='stm mis'>642</p>
<p class='stm mis'>643</p>
<p class='stm mis'>644</p>
<p class='pln'>645</p>
<p class='pln'>646</p>
<p class='stm mis'>647</p>
<p class='pln'>648</p>
<p class='stm mis'>649</p>
<p class='stm mis'>650</p>
<p class='stm mis'>651</p>
<p class='pln'>652</p>
<p class='stm mis'>653</p>
<p class='pln'>654</p>
<p class='stm mis'>655</p>
<p class='stm mis'>656</p>
<p class='stm mis'>657</p>
<p class='pln'>658</p>
<p class='stm mis'>659</p>
<p class='pln'>660</p>
<p class='stm run hide_run'>661</p>
<p class='pln'>662</p>
<p class='pln'>663</p>
<p class='pln'>664</p>
<p class='pln'>665</p>
<p class='pln'>666</p>
<p class='pln'>667</p>
<p class='pln'>668</p>
<p class='pln'>669</p>
<p class='pln'>670</p>
<p class='pln'>671</p>
<p class='pln'>672</p>
<p class='pln'>673</p>
<p class='pln'>674</p>
<p class='pln'>675</p>
<p class='pln'>676</p>
<p class='pln'>677</p>
<p class='pln'>678</p>
<p class='pln'>679</p>
<p class='pln'>680</p>
<p class='pln'>681</p>
<p class='pln'>682</p>
<p class='pln'>683</p>
<p class='pln'>684</p>
<p class='pln'>685</p>
<p class='pln'>686</p>
<p class='pln'>687</p>
<p class='pln'>688</p>
<p class='pln'>689</p>
<p class='pln'>690</p>
<p class='pln'>691</p>
<p class='pln'>692</p>
<p class='pln'>693</p>
<p class='pln'>694</p>
<p class='pln'>695</p>
<p class='pln'>696</p>
<p class='pln'>697</p>
<p class='pln'>698</p>
<p class='pln'>699</p>
<p class='pln'>700</p>
<p class='pln'>701</p>
<p class='pln'>702</p>
<p class='pln'>703</p>
<p class='pln'>704</p>
<p class='pln'>705</p>
<p class='pln'>706</p>
<p class='pln'>707</p>
<p class='pln'>708</p>
<p class='pln'>709</p>
<p class='pln'>710</p>
<p class='pln'>711</p>
<p class='pln'>712</p>
<p class='pln'>713</p>
<p class='pln'>714</p>
<p class='pln'>715</p>
<p class='pln'>716</p>
<p class='pln'>717</p>
<p class='pln'>718</p>
<p class='pln'>719</p>
<p class='pln'>720</p>
<p class='stm mis'>721</p>
<p class='stm mis'>722</p>
<p class='pln'>723</p>
<p class='stm mis'>724</p>
<p class='stm mis'>725</p>
<p class='pln'>726</p>
<p class='stm run hide_run'>727</p>
<p class='pln'>728</p>
<p class='pln'>729</p>
<p class='pln'>730</p>
<p class='pln'>731</p>
<p class='pln'>732</p>
<p class='pln'>733</p>
<p class='pln'>734</p>
<p class='pln'>735</p>
<p class='pln'>736</p>
<p class='pln'>737</p>
<p class='pln'>738</p>
<p class='pln'>739</p>
<p class='pln'>740</p>
<p class='pln'>741</p>
<p class='pln'>742</p>
<p class='pln'>743</p>
<p class='pln'>744</p>
<p class='pln'>745</p>
<p class='pln'>746</p>
<p class='pln'>747</p>
<p class='pln'>748</p>
<p class='pln'>749</p>
<p class='pln'>750</p>
<p class='pln'>751</p>
<p class='pln'>752</p>
<p class='pln'>753</p>
<p class='pln'>754</p>
<p class='pln'>755</p>
<p class='pln'>756</p>
<p class='pln'>757</p>
<p class='pln'>758</p>
<p class='pln'>759</p>
<p class='pln'>760</p>
<p class='pln'>761</p>
<p class='pln'>762</p>
<p class='pln'>763</p>
<p class='pln'>764</p>
<p class='pln'>765</p>
<p class='pln'>766</p>
<p class='pln'>767</p>
<p class='pln'>768</p>
<p class='pln'>769</p>
<p class='pln'>770</p>
<p class='pln'>771</p>
<p class='pln'>772</p>
<p class='pln'>773</p>
<p class='pln'>774</p>
<p class='pln'>775</p>
<p class='pln'>776</p>
<p class='pln'>777</p>
<p class='pln'>778</p>
<p class='pln'>779</p>
<p class='pln'>780</p>
<p class='pln'>781</p>
<p class='pln'>782</p>
<p class='pln'>783</p>
<p class='pln'>784</p>
<p class='pln'>785</p>
<p class='pln'>786</p>
<p class='pln'>787</p>
<p class='pln'>788</p>
<p class='pln'>789</p>
<p class='pln'>790</p>
<p class='pln'>791</p>
<p class='pln'>792</p>
<p class='pln'>793</p>
<p class='pln'>794</p>
<p class='pln'>795</p>
<p class='pln'>796</p>
<p class='pln'>797</p>
<p class='pln'>798</p>
<p class='pln'>799</p>
<p class='pln'>800</p>
<p class='pln'>801</p>
<p class='pln'>802</p>
<p class='stm mis'>803</p>
<p class='stm mis'>804</p>
<p class='stm mis'>805</p>
<p class='pln'>806</p>
<p class='pln'>807</p>
<p class='stm mis'>808</p>
<p class='stm mis'>809</p>
<p class='stm mis'>810</p>
<p class='stm mis'>811</p>
<p class='stm mis'>812</p>
<p class='stm mis'>813</p>
<p class='stm mis'>814</p>
<p class='stm mis'>815</p>
<p class='stm mis'>816</p>
<p class='stm mis'>817</p>
<p class='stm mis'>818</p>
<p class='pln'>819</p>
<p class='stm mis'>820</p>
<p class='pln'>821</p>
<p class='pln'>822</p>
<p class='pln'>823</p>
<p class='stm mis'>824</p>
<p class='stm mis'>825</p>
<p class='stm mis'>826</p>
<p class='stm mis'>827</p>
<p class='stm mis'>828</p>
<p class='stm mis'>829</p>
<p class='stm mis'>830</p>
<p class='pln'>831</p>
<p class='stm mis'>832</p>
<p class='stm mis'>833</p>
<p class='stm mis'>834</p>
<p class='pln'>835</p>
<p class='stm mis'>836</p>
<p class='stm mis'>837</p>
<p class='stm mis'>838</p>
<p class='stm mis'>839</p>
<p class='stm mis'>840</p>
<p class='pln'>841</p>
<p class='stm mis'>842</p>
<p class='stm mis'>843</p>
<p class='stm mis'>844</p>
<p class='stm mis'>845</p>
<p class='stm mis'>846</p>
<p class='stm mis'>847</p>
<p class='pln'>848</p>
<p class='stm run hide_run'>849</p>
<p class='pln'>850</p>
<p class='pln'>851</p>
<p class='pln'>852</p>
<p class='pln'>853</p>
<p class='pln'>854</p>
<p class='pln'>855</p>
<p class='pln'>856</p>
<p class='pln'>857</p>
<p class='pln'>858</p>
<p class='pln'>859</p>
<p class='pln'>860</p>
<p class='pln'>861</p>
<p class='pln'>862</p>
<p class='pln'>863</p>
<p class='pln'>864</p>
<p class='pln'>865</p>
<p class='pln'>866</p>
<p class='pln'>867</p>
<p class='pln'>868</p>
<p class='pln'>869</p>
<p class='pln'>870</p>
<p class='pln'>871</p>
<p class='pln'>872</p>
<p class='pln'>873</p>
<p class='pln'>874</p>
<p class='pln'>875</p>
<p class='pln'>876</p>
<p class='pln'>877</p>
<p class='pln'>878</p>
<p class='pln'>879</p>
<p class='pln'>880</p>
<p class='pln'>881</p>
<p class='pln'>882</p>
<p class='pln'>883</p>
<p class='pln'>884</p>
<p class='pln'>885</p>
<p class='pln'>886</p>
<p class='pln'>887</p>
<p class='pln'>888</p>
<p class='pln'>889</p>
<p class='stm mis'>890</p>
<p class='stm mis'>891</p>
<p class='stm mis'>892</p>
<p class='stm mis'>893</p>
<p class='stm mis'>894</p>
<p class='stm mis'>895</p>
<p class='stm mis'>896</p>
<p class='stm mis'>897</p>
<p class='stm mis'>898</p>
<p class='stm mis'>899</p>
<p class='stm mis'>900</p>
<p class='pln'>901</p>
<p class='pln'>902</p>
<p class='stm mis'>903</p>
<p class='stm mis'>904</p>
<p class='stm mis'>905</p>
<p class='stm mis'>906</p>
<p class='stm mis'>907</p>
<p class='stm mis'>908</p>
<p class='pln'>909</p>
<p class='stm mis'>910</p>
<p class='stm mis'>911</p>
<p class='pln'>912</p>
<p class='stm run hide_run'>913</p>
<p class='pln'>914</p>
<p class='pln'>915</p>
<p class='pln'>916</p>
<p class='pln'>917</p>
<p class='pln'>918</p>
<p class='pln'>919</p>
<p class='pln'>920</p>
<p class='pln'>921</p>
<p class='pln'>922</p>
<p class='pln'>923</p>
<p class='pln'>924</p>
<p class='pln'>925</p>
<p class='pln'>926</p>
<p class='pln'>927</p>
<p class='pln'>928</p>
<p class='pln'>929</p>
<p class='pln'>930</p>
<p class='pln'>931</p>
<p class='pln'>932</p>
<p class='pln'>933</p>
<p class='pln'>934</p>
<p class='pln'>935</p>
<p class='pln'>936</p>
<p class='pln'>937</p>
<p class='pln'>938</p>
<p class='pln'>939</p>
<p class='pln'>940</p>
<p class='pln'>941</p>
<p class='pln'>942</p>
<p class='pln'>943</p>
<p class='pln'>944</p>
<p class='pln'>945</p>
<p class='pln'>946</p>
<p class='pln'>947</p>
<p class='pln'>948</p>
<p class='pln'>949</p>
<p class='stm mis'>950</p>
<p class='pln'>951</p>
<p class='pln'>952</p>
<p class='pln'>953</p>
<p class='stm run hide_run'>954</p>
<p class='pln'>955</p>
<p class='pln'>956</p>
<p class='pln'>957</p>
<p class='pln'>958</p>
<p class='pln'>959</p>
<p class='pln'>960</p>
<p class='pln'>961</p>
<p class='pln'>962</p>
<p class='pln'>963</p>
<p class='pln'>964</p>
<p class='pln'>965</p>
<p class='pln'>966</p>
<p class='pln'>967</p>
<p class='pln'>968</p>
<p class='pln'>969</p>
<p class='pln'>970</p>
<p class='pln'>971</p>
<p class='pln'>972</p>
<p class='pln'>973</p>
<p class='pln'>974</p>
<p class='pln'>975</p>
<p class='pln'>976</p>
<p class='pln'>977</p>
<p class='pln'>978</p>
<p class='pln'>979</p>
<p class='pln'>980</p>
<p class='pln'>981</p>
<p class='pln'>982</p>
<p class='pln'>983</p>
<p class='pln'>984</p>
<p class='pln'>985</p>
<p class='stm mis'>986</p>
<p class='stm mis'>987</p>
<p class='stm mis'>988</p>
<p class='stm mis'>989</p>
<p class='stm mis'>990</p>
<p class='stm mis'>991</p>
<p class='stm mis'>992</p>
<p class='stm mis'>993</p>
<p class='pln'>994</p>
<p class='stm mis'>995</p>
<p class='pln'>996</p>
<p class='pln'>997</p>
<p class='pln'>998</p>
<p class='stm mis'>999</p>
<p class='pln'>1000</p>
<p class='pln'>1001</p>
<p class='stm mis'>1002</p>
<p class='stm mis'>1003</p>
<p class='stm mis'>1004</p>
<p class='pln'>1005</p>
<p class='stm mis'>1006</p>
<p class='stm mis'>1007</p>
<p class='stm mis'>1008</p>
<p class='pln'>1009</p>
<p class='stm mis'>1010</p>
<p class='pln'>1011</p>
<p class='stm mis'>1012</p>
<p class='stm mis'>1013</p>
<p class='stm mis'>1014</p>
<p class='stm mis'>1015</p>
<p class='pln'>1016</p>
<p class='stm mis'>1017</p>
<p class='stm mis'>1018</p>
<p class='stm mis'>1019</p>
<p class='stm mis'>1020</p>
<p class='pln'>1021</p>
<p class='stm mis'>1022</p>
<p class='stm mis'>1023</p>
<p class='stm mis'>1024</p>
<p class='stm mis'>1025</p>
<p class='pln'>1026</p>
<p class='stm mis'>1027</p>
<p class='pln'>1028</p>
<p class='pln'>1029</p>
<p class='stm mis'>1030</p>
<p class='pln'>1031</p>
<p class='pln'>1032</p>
<p class='stm mis'>1033</p>
<p class='stm mis'>1034</p>
<p class='stm mis'>1035</p>
<p class='pln'>1036</p>
<p class='stm mis'>1037</p>
<p class='stm mis'>1038</p>
<p class='pln'>1039</p>
<p class='stm mis'>1040</p>
<p class='pln'>1041</p>
<p class='pln'>1042</p>
<p class='stm run hide_run'>1043</p>
<p class='pln'>1044</p>
<p class='pln'>1045</p>
<p class='pln'>1046</p>
<p class='pln'>1047</p>
<p class='pln'>1048</p>
<p class='pln'>1049</p>
<p class='pln'>1050</p>
<p class='pln'>1051</p>
<p class='pln'>1052</p>
<p class='pln'>1053</p>
<p class='pln'>1054</p>
<p class='pln'>1055</p>
<p class='pln'>1056</p>
<p class='pln'>1057</p>
<p class='pln'>1058</p>
<p class='pln'>1059</p>
<p class='pln'>1060</p>
<p class='pln'>1061</p>
<p class='pln'>1062</p>
<p class='pln'>1063</p>
<p class='pln'>1064</p>
<p class='pln'>1065</p>
<p class='pln'>1066</p>
<p class='pln'>1067</p>
<p class='pln'>1068</p>
<p class='pln'>1069</p>
<p class='pln'>1070</p>
<p class='pln'>1071</p>
<p class='pln'>1072</p>
<p class='pln'>1073</p>
<p class='pln'>1074</p>
<p class='pln'>1075</p>
<p class='pln'>1076</p>
<p class='stm mis'>1077</p>
<p class='stm mis'>1078</p>
<p class='stm mis'>1079</p>
<p class='stm mis'>1080</p>
<p class='stm mis'>1081</p>
<p class='stm mis'>1082</p>
<p class='stm mis'>1083</p>
<p class='stm mis'>1084</p>
<p class='stm mis'>1085</p>
<p class='stm mis'>1086</p>
<p class='stm mis'>1087</p>
<p class='stm mis'>1088</p>
<p class='stm mis'>1089</p>
<p class='stm mis'>1090</p>
<p class='pln'>1091</p>
<p class='stm mis'>1092</p>
<p class='pln'>1093</p>
<p class='stm run hide_run'>1094</p>
<p class='stm run hide_run'>1095</p>
<p class='pln'>1096</p>
<p class='pln'>1097</p>
<p class='pln'>1098</p>
<p class='pln'>1099</p>
<p class='pln'>1100</p>
<p class='pln'>1101</p>
<p class='pln'>1102</p>
<p class='pln'>1103</p>
<p class='pln'>1104</p>
<p class='pln'>1105</p>
<p class='pln'>1106</p>
<p class='stm mis'>1107</p>
<p class='stm mis'>1108</p>
<p class='pln'>1109</p>
<p class='stm run hide_run'>1110</p>
<p class='stm run hide_run'>1111</p>
<p class='pln'>1112</p>
<p class='pln'>1113</p>
<p class='pln'>1114</p>
<p class='pln'>1115</p>
<p class='pln'>1116</p>
<p class='pln'>1117</p>
<p class='pln'>1118</p>
<p class='pln'>1119</p>
<p class='pln'>1120</p>
<p class='pln'>1121</p>
<p class='pln'>1122</p>
<p class='pln'>1123</p>
<p class='stm mis'>1124</p>
<p class='stm mis'>1125</p>
<p class='pln'>1126</p>
<p class='stm run hide_run'>1127</p>
<p class='stm run hide_run'>1128</p>
<p class='pln'>1129</p>
<p class='pln'>1130</p>
<p class='pln'>1131</p>
<p class='pln'>1132</p>
<p class='pln'>1133</p>
<p class='pln'>1134</p>
<p class='pln'>1135</p>
<p class='pln'>1136</p>
<p class='stm mis'>1137</p>
<p class='stm mis'>1138</p>
<p class='pln'>1139</p>
<p class='pln'>1140</p>
<p class='stm run hide_run'>1141</p>
<p class='pln'>1142</p>
<p class='pln'>1143</p>
<p class='pln'>1144</p>
<p class='pln'>1145</p>
<p class='pln'>1146</p>
<p class='pln'>1147</p>
<p class='pln'>1148</p>
<p class='pln'>1149</p>
<p class='pln'>1150</p>
<p class='pln'>1151</p>
<p class='pln'>1152</p>
<p class='pln'>1153</p>
<p class='pln'>1154</p>
<p class='pln'>1155</p>
<p class='pln'>1156</p>
<p class='pln'>1157</p>
<p class='pln'>1158</p>
<p class='pln'>1159</p>
<p class='pln'>1160</p>
<p class='pln'>1161</p>
<p class='pln'>1162</p>
<p class='pln'>1163</p>
<p class='pln'>1164</p>
<p class='pln'>1165</p>
<p class='pln'>1166</p>
<p class='pln'>1167</p>
<p class='pln'>1168</p>
<p class='pln'>1169</p>
<p class='pln'>1170</p>
<p class='pln'>1171</p>
<p class='pln'>1172</p>
<p class='pln'>1173</p>
<p class='pln'>1174</p>
<p class='pln'>1175</p>
<p class='pln'>1176</p>
<p class='pln'>1177</p>
<p class='pln'>1178</p>
<p class='pln'>1179</p>
<p class='pln'>1180</p>
<p class='pln'>1181</p>
<p class='pln'>1182</p>
<p class='pln'>1183</p>
<p class='pln'>1184</p>
<p class='pln'>1185</p>
<p class='pln'>1186</p>
<p class='pln'>1187</p>
<p class='pln'>1188</p>
<p class='pln'>1189</p>
<p class='pln'>1190</p>
<p class='pln'>1191</p>
<p class='pln'>1192</p>
<p class='pln'>1193</p>
<p class='pln'>1194</p>
<p class='pln'>1195</p>
<p class='pln'>1196</p>
<p class='pln'>1197</p>
<p class='pln'>1198</p>
<p class='pln'>1199</p>
<p class='pln'>1200</p>
<p class='pln'>1201</p>
<p class='pln'>1202</p>
<p class='pln'>1203</p>
<p class='pln'>1204</p>
<p class='pln'>1205</p>
<p class='pln'>1206</p>
<p class='pln'>1207</p>
<p class='stm mis'>1208</p>
<p class='stm mis'>1209</p>
<p class='pln'>1210</p>
<p class='stm mis'>1211</p>
<p class='pln'>1212</p>
<p class='pln'>1213</p>
<p class='stm run hide_run'>1214</p>
<p class='pln'>1215</p>
<p class='pln'>1216</p>
<p class='pln'>1217</p>
<p class='pln'>1218</p>
<p class='pln'>1219</p>
<p class='pln'>1220</p>
<p class='pln'>1221</p>
<p class='pln'>1222</p>
<p class='pln'>1223</p>
<p class='pln'>1224</p>
<p class='pln'>1225</p>
<p class='pln'>1226</p>
<p class='pln'>1227</p>
<p class='pln'>1228</p>
<p class='pln'>1229</p>
<p class='pln'>1230</p>
<p class='pln'>1231</p>
<p class='pln'>1232</p>
<p class='pln'>1233</p>
<p class='pln'>1234</p>
<p class='pln'>1235</p>
<p class='pln'>1236</p>
<p class='pln'>1237</p>
<p class='pln'>1238</p>
<p class='pln'>1239</p>
<p class='pln'>1240</p>
<p class='pln'>1241</p>
<p class='pln'>1242</p>
<p class='stm mis'>1243</p>
<p class='stm mis'>1244</p>
<p class='pln'>1245</p>
<p class='stm mis'>1246</p>
<p class='stm mis'>1247</p>
<p class='stm mis'>1248</p>
<p class='stm mis'>1249</p>
<p class='stm mis'>1250</p>
<p class='pln'>1251</p>
<p class='stm mis'>1252</p>
<p class='stm mis'>1253</p>
<p class='stm mis'>1254</p>
<p class='pln'>1255</p>
<p class='stm run hide_run'>1256</p>
<p class='pln'>1257</p>
<p class='pln'>1258</p>
<p class='pln'>1259</p>
<p class='pln'>1260</p>
<p class='pln'>1261</p>
<p class='pln'>1262</p>
<p class='pln'>1263</p>
<p class='pln'>1264</p>
<p class='pln'>1265</p>
<p class='pln'>1266</p>
<p class='pln'>1267</p>
<p class='pln'>1268</p>
<p class='pln'>1269</p>
<p class='pln'>1270</p>
<p class='pln'>1271</p>
<p class='pln'>1272</p>
<p class='pln'>1273</p>
<p class='pln'>1274</p>
<p class='pln'>1275</p>
<p class='pln'>1276</p>
<p class='pln'>1277</p>
<p class='stm mis'>1278</p>
<p class='stm mis'>1279</p>
<p class='stm mis'>1280</p>
<p class='stm mis'>1281</p>
<p class='stm mis'>1282</p>
<p class='stm mis'>1283</p>
<p class='stm mis'>1284</p>
<p class='stm mis'>1285</p>
<p class='stm mis'>1286</p>
<p class='stm mis'>1287</p>
<p class='stm mis'>1288</p>
<p class='stm mis'>1289</p>
<p class='pln'>1290</p>
<p class='stm run hide_run'>1291</p>
<p class='pln'>1292</p>
<p class='pln'>1293</p>
<p class='pln'>1294</p>
<p class='pln'>1295</p>
<p class='pln'>1296</p>
<p class='pln'>1297</p>
<p class='pln'>1298</p>
<p class='pln'>1299</p>
<p class='pln'>1300</p>
<p class='pln'>1301</p>
<p class='pln'>1302</p>
<p class='pln'>1303</p>
<p class='pln'>1304</p>
<p class='pln'>1305</p>
<p class='pln'>1306</p>
<p class='pln'>1307</p>
<p class='pln'>1308</p>
<p class='pln'>1309</p>
<p class='pln'>1310</p>
<p class='pln'>1311</p>
<p class='pln'>1312</p>
<p class='stm mis'>1313</p>
<p class='stm mis'>1314</p>
<p class='stm mis'>1315</p>
<p class='stm mis'>1316</p>
<p class='stm mis'>1317</p>
<p class='stm mis'>1318</p>
<p class='stm mis'>1319</p>
<p class='pln'>1320</p>
<p class='stm mis'>1321</p>
<p class='pln'>1322</p>
<p class='stm mis'>1323</p>
<p class='pln'>1324</p>
<p class='stm run hide_run'>1325</p>
<p class='pln'>1326</p>
<p class='pln'>1327</p>
<p class='pln'>1328</p>
<p class='pln'>1329</p>
<p class='pln'>1330</p>
<p class='pln'>1331</p>
<p class='pln'>1332</p>
<p class='pln'>1333</p>
<p class='pln'>1334</p>
<p class='pln'>1335</p>
<p class='pln'>1336</p>
<p class='pln'>1337</p>
<p class='pln'>1338</p>
<p class='pln'>1339</p>
<p class='pln'>1340</p>
<p class='pln'>1341</p>
<p class='pln'>1342</p>
<p class='pln'>1343</p>
<p class='stm mis'>1344</p>
<p class='stm mis'>1345</p>
<p class='stm mis'>1346</p>
<p class='stm mis'>1347</p>
<p class='stm mis'>1348</p>
<p class='stm mis'>1349</p>
<p class='stm mis'>1350</p>
<p class='stm mis'>1351</p>
<p class='stm mis'>1352</p>
<p class='stm mis'>1353</p>
<p class='stm mis'>1354</p>
<p class='stm mis'>1355</p>
<p class='pln'>1356</p>
<p class='stm run hide_run'>1357</p>
<p class='stm run hide_run'>1358</p>
<p class='stm mis'>1359</p>
<p class='pln'>1360</p>
<p class='stm run hide_run'>1361</p>
<p class='pln'>1362</p>
<p class='pln'>1363</p>
<p class='pln'>1364</p>
<p class='pln'>1365</p>
<p class='pln'>1366</p>
<p class='pln'>1367</p>
<p class='pln'>1368</p>
<p class='pln'>1369</p>
<p class='pln'>1370</p>
<p class='pln'>1371</p>
<p class='pln'>1372</p>
<p class='pln'>1373</p>
<p class='pln'>1374</p>
<p class='pln'>1375</p>
<p class='pln'>1376</p>
<p class='pln'>1377</p>
<p class='pln'>1378</p>
<p class='pln'>1379</p>
<p class='pln'>1380</p>
<p class='pln'>1381</p>
<p class='pln'>1382</p>
<p class='pln'>1383</p>
<p class='stm mis'>1384</p>
<p class='stm mis'>1385</p>
<p class='stm mis'>1386</p>
<p class='stm mis'>1387</p>
<p class='stm mis'>1388</p>
<p class='stm mis'>1389</p>
<p class='stm mis'>1390</p>
<p class='stm mis'>1391</p>
<p class='stm mis'>1392</p>
<p class='stm mis'>1393</p>
<p class='stm mis'>1394</p>
<p class='pln'>1395</p>
<p class='stm run hide_run'>1396</p>
<p class='pln'>1397</p>
<p class='pln'>1398</p>
<p class='pln'>1399</p>
<p class='pln'>1400</p>
<p class='pln'>1401</p>
<p class='pln'>1402</p>
<p class='pln'>1403</p>
<p class='pln'>1404</p>
<p class='pln'>1405</p>
<p class='pln'>1406</p>
<p class='pln'>1407</p>
<p class='pln'>1408</p>
<p class='pln'>1409</p>
<p class='pln'>1410</p>
<p class='pln'>1411</p>
<p class='pln'>1412</p>
<p class='pln'>1413</p>
<p class='pln'>1414</p>
<p class='pln'>1415</p>
<p class='pln'>1416</p>
<p class='pln'>1417</p>
<p class='pln'>1418</p>
<p class='pln'>1419</p>
<p class='pln'>1420</p>
<p class='pln'>1421</p>
<p class='pln'>1422</p>
<p class='pln'>1423</p>
<p class='pln'>1424</p>
<p class='pln'>1425</p>
<p class='pln'>1426</p>
<p class='pln'>1427</p>
<p class='pln'>1428</p>
<p class='pln'>1429</p>
<p class='pln'>1430</p>
<p class='pln'>1431</p>
<p class='pln'>1432</p>
<p class='pln'>1433</p>
<p class='pln'>1434</p>
<p class='pln'>1435</p>
<p class='stm mis'>1436</p>
<p class='pln'>1437</p>
<p class='stm run hide_run'>1438</p>
<p class='pln'>1439</p>
<p class='pln'>1440</p>
<p class='pln'>1441</p>
<p class='pln'>1442</p>
<p class='pln'>1443</p>
<p class='pln'>1444</p>
<p class='pln'>1445</p>
<p class='pln'>1446</p>
<p class='pln'>1447</p>
<p class='pln'>1448</p>
<p class='pln'>1449</p>
<p class='pln'>1450</p>
<p class='pln'>1451</p>
<p class='pln'>1452</p>
<p class='pln'>1453</p>
<p class='pln'>1454</p>
<p class='pln'>1455</p>
<p class='pln'>1456</p>
<p class='pln'>1457</p>
<p class='pln'>1458</p>
<p class='pln'>1459</p>
<p class='pln'>1460</p>
<p class='pln'>1461</p>
<p class='stm mis'>1462</p>
<p class='pln'>1463</p>
<p class='stm run hide_run'>1464</p>
<p class='pln'>1465</p>
<p class='pln'>1466</p>
<p class='pln'>1467</p>
<p class='pln'>1468</p>
<p class='pln'>1469</p>
<p class='pln'>1470</p>
<p class='pln'>1471</p>
<p class='pln'>1472</p>
<p class='pln'>1473</p>
<p class='pln'>1474</p>
<p class='pln'>1475</p>
<p class='pln'>1476</p>
<p class='pln'>1477</p>
<p class='pln'>1478</p>
<p class='pln'>1479</p>
<p class='pln'>1480</p>
<p class='pln'>1481</p>
<p class='pln'>1482</p>
<p class='pln'>1483</p>
<p class='pln'>1484</p>
<p class='pln'>1485</p>
<p class='stm mis'>1486</p>
<p class='stm mis'>1487</p>
<p class='stm mis'>1488</p>
<p class='stm mis'>1489</p>
<p class='pln'>1490</p>
<p class='stm mis'>1491</p>
<p class='stm mis'>1492</p>
<p class='pln'>1493</p>
<p class='stm mis'>1494</p>
<p class='pln'>1495</p>
<p class='stm run hide_run'>1496</p>
<p class='pln'>1497</p>
<p class='pln'>1498</p>
<p class='pln'>1499</p>
<p class='pln'>1500</p>
<p class='pln'>1501</p>
<p class='pln'>1502</p>
<p class='pln'>1503</p>
<p class='pln'>1504</p>
<p class='pln'>1505</p>
<p class='pln'>1506</p>
<p class='pln'>1507</p>
<p class='pln'>1508</p>
<p class='pln'>1509</p>
<p class='pln'>1510</p>
<p class='pln'>1511</p>
<p class='pln'>1512</p>
<p class='pln'>1513</p>
<p class='pln'>1514</p>
<p class='pln'>1515</p>
<p class='pln'>1516</p>
<p class='pln'>1517</p>
<p class='pln'>1518</p>
<p class='pln'>1519</p>
<p class='pln'>1520</p>
<p class='pln'>1521</p>
<p class='pln'>1522</p>
<p class='pln'>1523</p>
<p class='pln'>1524</p>
<p class='pln'>1525</p>
<p class='pln'>1526</p>
<p class='pln'>1527</p>
<p class='pln'>1528</p>
<p class='pln'>1529</p>
<p class='pln'>1530</p>
<p class='pln'>1531</p>
<p class='pln'>1532</p>
<p class='pln'>1533</p>
<p class='pln'>1534</p>
<p class='pln'>1535</p>
<p class='pln'>1536</p>
<p class='pln'>1537</p>
<p class='pln'>1538</p>
<p class='pln'>1539</p>
<p class='pln'>1540</p>
<p class='pln'>1541</p>
<p class='pln'>1542</p>
<p class='pln'>1543</p>
<p class='pln'>1544</p>
<p class='pln'>1545</p>
<p class='pln'>1546</p>
<p class='pln'>1547</p>
<p class='pln'>1548</p>
<p class='pln'>1549</p>
<p class='pln'>1550</p>
<p class='pln'>1551</p>
<p class='pln'>1552</p>
<p class='pln'>1553</p>
<p class='pln'>1554</p>
<p class='pln'>1555</p>
<p class='pln'>1556</p>
<p class='pln'>1557</p>
<p class='pln'>1558</p>
<p class='pln'>1559</p>
<p class='pln'>1560</p>
<p class='pln'>1561</p>
<p class='stm mis'>1562</p>
<p class='pln'>1563</p>
<p class='stm run hide_run'>1564</p>
<p class='pln'>1565</p>
<p class='pln'>1566</p>
<p class='pln'>1567</p>
<p class='pln'>1568</p>
<p class='pln'>1569</p>
<p class='pln'>1570</p>
<p class='pln'>1571</p>
<p class='pln'>1572</p>
<p class='pln'>1573</p>
<p class='pln'>1574</p>
<p class='pln'>1575</p>
<p class='pln'>1576</p>
<p class='pln'>1577</p>
<p class='pln'>1578</p>
<p class='pln'>1579</p>
<p class='pln'>1580</p>
<p class='pln'>1581</p>
<p class='pln'>1582</p>
<p class='pln'>1583</p>
<p class='pln'>1584</p>
<p class='pln'>1585</p>
<p class='pln'>1586</p>
<p class='pln'>1587</p>
<p class='pln'>1588</p>
<p class='pln'>1589</p>
<p class='pln'>1590</p>
<p class='pln'>1591</p>
<p class='pln'>1592</p>
<p class='pln'>1593</p>
<p class='pln'>1594</p>
<p class='pln'>1595</p>
<p class='pln'>1596</p>
<p class='pln'>1597</p>
<p class='pln'>1598</p>
<p class='pln'>1599</p>
<p class='pln'>1600</p>
<p class='pln'>1601</p>
<p class='pln'>1602</p>
<p class='pln'>1603</p>
<p class='pln'>1604</p>
<p class='pln'>1605</p>
<p class='pln'>1606</p>
<p class='pln'>1607</p>
<p class='pln'>1608</p>
<p class='pln'>1609</p>
<p class='pln'>1610</p>
<p class='pln'>1611</p>
<p class='pln'>1612</p>
<p class='pln'>1613</p>
<p class='pln'>1614</p>
<p class='pln'>1615</p>
<p class='pln'>1616</p>
<p class='pln'>1617</p>
<p class='pln'>1618</p>
<p class='pln'>1619</p>
<p class='pln'>1620</p>
<p class='pln'>1621</p>
<p class='stm mis'>1622</p>
<p class='pln'>1623</p>
<p class='stm run hide_run'>1624</p>
<p class='pln'>1625</p>
<p class='pln'>1626</p>
<p class='pln'>1627</p>
<p class='pln'>1628</p>
<p class='pln'>1629</p>
<p class='pln'>1630</p>
<p class='pln'>1631</p>
<p class='pln'>1632</p>
<p class='pln'>1633</p>
<p class='stm mis'>1634</p>
<p class='pln'>1635</p>
<p class='stm run hide_run'>1636</p>
<p class='pln'>1637</p>
<p class='pln'>1638</p>
<p class='pln'>1639</p>
<p class='pln'>1640</p>
<p class='pln'>1641</p>
<p class='pln'>1642</p>
<p class='pln'>1643</p>
<p class='pln'>1644</p>
<p class='pln'>1645</p>
<p class='pln'>1646</p>
<p class='pln'>1647</p>
<p class='pln'>1648</p>
<p class='pln'>1649</p>
<p class='pln'>1650</p>
<p class='pln'>1651</p>
<p class='pln'>1652</p>
<p class='pln'>1653</p>
<p class='pln'>1654</p>
<p class='pln'>1655</p>
<p class='pln'>1656</p>
<p class='pln'>1657</p>
<p class='pln'>1658</p>
<p class='pln'>1659</p>
<p class='pln'>1660</p>
<p class='pln'>1661</p>
<p class='pln'>1662</p>
<p class='pln'>1663</p>
<p class='pln'>1664</p>
<p class='pln'>1665</p>
<p class='pln'>1666</p>
<p class='pln'>1667</p>
<p class='pln'>1668</p>
<p class='pln'>1669</p>
<p class='pln'>1670</p>
<p class='pln'>1671</p>
<p class='pln'>1672</p>
<p class='pln'>1673</p>
<p class='pln'>1674</p>
<p class='pln'>1675</p>
<p class='pln'>1676</p>
<p class='pln'>1677</p>
<p class='pln'>1678</p>
<p class='pln'>1679</p>
<p class='pln'>1680</p>
<p class='pln'>1681</p>
<p class='pln'>1682</p>
<p class='pln'>1683</p>
<p class='pln'>1684</p>
<p class='pln'>1685</p>
<p class='pln'>1686</p>
<p class='pln'>1687</p>
<p class='pln'>1688</p>
<p class='pln'>1689</p>
<p class='pln'>1690</p>
<p class='pln'>1691</p>
<p class='stm mis'>1692</p>
<p class='pln'>1693</p>
<p class='stm run hide_run'>1694</p>
<p class='pln'>1695</p>
<p class='pln'>1696</p>
<p class='pln'>1697</p>
<p class='pln'>1698</p>
<p class='pln'>1699</p>
<p class='pln'>1700</p>
<p class='pln'>1701</p>
<p class='pln'>1702</p>
<p class='pln'>1703</p>
<p class='pln'>1704</p>
<p class='pln'>1705</p>
<p class='pln'>1706</p>
<p class='pln'>1707</p>
<p class='pln'>1708</p>
<p class='pln'>1709</p>
<p class='pln'>1710</p>
<p class='pln'>1711</p>
<p class='pln'>1712</p>
<p class='pln'>1713</p>
<p class='pln'>1714</p>
<p class='pln'>1715</p>
<p class='pln'>1716</p>
<p class='pln'>1717</p>
<p class='pln'>1718</p>
<p class='pln'>1719</p>
<p class='pln'>1720</p>
<p class='pln'>1721</p>
<p class='pln'>1722</p>
<p class='pln'>1723</p>
<p class='pln'>1724</p>
<p class='pln'>1725</p>
<p class='pln'>1726</p>
<p class='stm mis'>1727</p>
<p class='pln'>1728</p>
<p class='stm run hide_run'>1729</p>
<p class='pln'>1730</p>
<p class='pln'>1731</p>
<p class='pln'>1732</p>
<p class='pln'>1733</p>
<p class='pln'>1734</p>
<p class='pln'>1735</p>
<p class='pln'>1736</p>
<p class='pln'>1737</p>
<p class='pln'>1738</p>
<p class='pln'>1739</p>
<p class='pln'>1740</p>
<p class='pln'>1741</p>
<p class='pln'>1742</p>
<p class='pln'>1743</p>
<p class='stm mis'>1744</p>
<p class='stm mis'>1745</p>
<p class='stm mis'>1746</p>
<p class='stm mis'>1747</p>
<p class='stm mis'>1748</p>
<p class='pln'>1749</p>
<p class='stm mis'>1750</p>
<p class='stm mis'>1751</p>
<p class='stm mis'>1752</p>
<p class='pln'>1753</p>
<p class='pln'>1754</p>
<p class='pln'>1755</p>
<p class='stm run hide_run'>1756</p>
<p class='stm run hide_run'>1757</p>
<p class='stm mis'>1758</p>
<p class='stm mis'>1759</p>
<p class='stm mis'>1760</p>
<p class='stm mis'>1761</p>
<p class='stm mis'>1762</p>
<p class='stm mis'>1763</p>
<p class='stm mis'>1764</p>
<p class='pln'>1765</p>
<p class='stm mis'>1766</p>
<p class='stm mis'>1767</p>
<p class='stm mis'>1768</p>
<p class='stm mis'>1769</p>
<p class='stm mis'>1770</p>
<p class='stm mis'>1771</p>
<p class='stm mis'>1772</p>
<p class='stm mis'>1773</p>
<p class='stm mis'>1774</p>
<p class='stm mis'>1775</p>
<p class='stm mis'>1776</p>
<p class='stm mis'>1777</p>
<p class='stm mis'>1778</p>
<p class='stm mis'>1779</p>
<p class='stm mis'>1780</p>
<p class='stm mis'>1781</p>
<p class='stm mis'>1782</p>
<p class='pln'>1783</p>
<p class='pln'>1784</p>
<p class='stm run hide_run'>1785</p>
<p class='pln'>1786</p>
<p class='pln'>1787</p>
<p class='pln'>1788</p>
<p class='pln'>1789</p>
<p class='pln'>1790</p>
<p class='pln'>1791</p>
<p class='pln'>1792</p>
<p class='pln'>1793</p>
<p class='pln'>1794</p>
<p class='pln'>1795</p>
<p class='pln'>1796</p>
<p class='pln'>1797</p>
<p class='pln'>1798</p>
<p class='pln'>1799</p>
<p class='pln'>1800</p>
<p class='pln'>1801</p>
<p class='pln'>1802</p>
<p class='pln'>1803</p>
<p class='pln'>1804</p>
<p class='pln'>1805</p>
<p class='pln'>1806</p>
<p class='pln'>1807</p>
<p class='pln'>1808</p>
<p class='pln'>1809</p>
<p class='pln'>1810</p>
<p class='pln'>1811</p>
<p class='pln'>1812</p>
<p class='pln'>1813</p>
<p class='pln'>1814</p>
<p class='pln'>1815</p>
<p class='pln'>1816</p>
<p class='pln'>1817</p>
<p class='pln'>1818</p>
<p class='pln'>1819</p>
<p class='pln'>1820</p>
<p class='pln'>1821</p>
<p class='stm run hide_run'>1822</p>
<p class='stm mis'>1823</p>
<p class='stm mis'>1824</p>
<p class='stm mis'>1825</p>
<p class='stm mis'>1826</p>
<p class='stm mis'>1827</p>
<p class='stm mis'>1828</p>
<p class='pln'>1829</p>
<p class='stm mis'>1830</p>
<p class='stm mis'>1831</p>
<p class='stm mis'>1832</p>
<p class='stm mis'>1833</p>
<p class='stm mis'>1834</p>
<p class='pln'>1835</p>
<p class='stm mis'>1836</p>
<p class='stm mis'>1837</p>
<p class='stm mis'>1838</p>
<p class='stm mis'>1839</p>
<p class='stm mis'>1840</p>
<p class='stm mis'>1841</p>
<p class='stm mis'>1842</p>
<p class='stm mis'>1843</p>
<p class='pln'>1844</p>
<p class='stm mis'>1845</p>
<p class='stm mis'>1846</p>
<p class='pln'>1847</p>
<p class='stm run hide_run'>1848</p>
<p class='pln'>1849</p>
<p class='pln'>1850</p>
<p class='stm mis'>1851</p>
<p class='stm mis'>1852</p>
<p class='stm mis'>1853</p>
<p class='stm mis'>1854</p>
<p class='pln'>1855</p>
<p class='pln'>1856</p>
<p class='pln'>1857</p>
<p class='stm mis'>1858</p>
<p class='stm mis'>1859</p>
<p class='stm mis'>1860</p>
<p class='stm mis'>1861</p>
<p class='pln'>1862</p>
<p class='stm mis'>1863</p>
<p class='stm mis'>1864</p>
<p class='stm mis'>1865</p>
<p class='stm mis'>1866</p>
<p class='stm mis'>1867</p>
<p class='stm mis'>1868</p>
<p class='stm mis'>1869</p>
<p class='pln'>1870</p>
<p class='stm mis'>1871</p>
<p class='stm mis'>1872</p>
<p class='stm mis'>1873</p>
<p class='stm mis'>1874</p>
<p class='stm mis'>1875</p>
<p class='stm mis'>1876</p>
<p class='stm mis'>1877</p>
<p class='pln'>1878</p>
<p class='pln'>1879</p>
<p class='stm mis'>1880</p>
<p class='stm mis'>1881</p>
<p class='pln'>1882</p>
<p class='pln'>1883</p>
<p class='stm mis'>1884</p>
<p class='stm mis'>1885</p>
<p class='stm mis'>1886</p>
<p class='pln'>1887</p>
<p class='pln'>1888</p>
<p class='stm mis'>1889</p>
<p class='pln'>1890</p>
<p class='stm mis'>1891</p>
<p class='pln'>1892</p>
<p class='stm run hide_run'>1893</p>
<p class='pln'>1894</p>
<p class='pln'>1895</p>
<p class='pln'>1896</p>
<p class='pln'>1897</p>
<p class='pln'>1898</p>
<p class='pln'>1899</p>
<p class='pln'>1900</p>
<p class='pln'>1901</p>
<p class='pln'>1902</p>
<p class='pln'>1903</p>
<p class='pln'>1904</p>
<p class='pln'>1905</p>
<p class='pln'>1906</p>
<p class='pln'>1907</p>
<p class='pln'>1908</p>
<p class='pln'>1909</p>
<p class='pln'>1910</p>
<p class='pln'>1911</p>
<p class='pln'>1912</p>
<p class='pln'>1913</p>
<p class='pln'>1914</p>
<p class='pln'>1915</p>
<p class='pln'>1916</p>
<p class='pln'>1917</p>
<p class='pln'>1918</p>
<p class='pln'>1919</p>
<p class='pln'>1920</p>
<p class='pln'>1921</p>
<p class='pln'>1922</p>
<p class='pln'>1923</p>
<p class='pln'>1924</p>
<p class='pln'>1925</p>
<p class='pln'>1926</p>
<p class='pln'>1927</p>
<p class='pln'>1928</p>
<p class='pln'>1929</p>
<p class='pln'>1930</p>
<p class='pln'>1931</p>
<p class='pln'>1932</p>
<p class='pln'>1933</p>
<p class='pln'>1934</p>
<p class='pln'>1935</p>
<p class='pln'>1936</p>
<p class='pln'>1937</p>
<p class='pln'>1938</p>
<p class='pln'>1939</p>
<p class='pln'>1940</p>
<p class='pln'>1941</p>
<p class='pln'>1942</p>
<p class='pln'>1943</p>
<p class='pln'>1944</p>
<p class='pln'>1945</p>
<p class='pln'>1946</p>
<p class='pln'>1947</p>
<p class='pln'>1948</p>
<p class='pln'>1949</p>
<p class='pln'>1950</p>
<p class='pln'>1951</p>
<p class='pln'>1952</p>
<p class='pln'>1953</p>
<p class='pln'>1954</p>
<p class='pln'>1955</p>
<p class='pln'>1956</p>
<p class='pln'>1957</p>
<p class='pln'>1958</p>
<p class='pln'>1959</p>
<p class='pln'>1960</p>
<p class='pln'>1961</p>
<p class='pln'>1962</p>
<p class='pln'>1963</p>
<p class='pln'>1964</p>
<p class='pln'>1965</p>
<p class='pln'>1966</p>
<p class='stm mis'>1967</p>
<p class='stm mis'>1968</p>
<p class='stm mis'>1969</p>
<p class='stm mis'>1970</p>
<p class='stm mis'>1971</p>
<p class='stm mis'>1972</p>
<p class='pln'>1973</p>
<p class='stm mis'>1974</p>
<p class='stm mis'>1975</p>
<p class='pln'>1976</p>
<p class='pln'>1977</p>
<p class='stm mis'>1978</p>
<p class='stm mis'>1979</p>
<p class='stm mis'>1980</p>
<p class='pln'>1981</p>
<p class='stm mis'>1982</p>
<p class='stm mis'>1983</p>
<p class='stm mis'>1984</p>
<p class='pln'>1985</p>
<p class='stm mis'>1986</p>
<p class='pln'>1987</p>
<p class='stm mis'>1988</p>
<p class='stm mis'>1989</p>
<p class='pln'>1990</p>
<p class='stm mis'>1991</p>
<p class='pln'>1992</p>
<p class='stm mis'>1993</p>
<p class='stm mis'>1994</p>
<p class='pln'>1995</p>
<p class='stm mis'>1996</p>
<p class='pln'>1997</p>
<p class='stm run hide_run'>1998</p>
<p class='pln'>1999</p>
<p class='pln'>2000</p>
<p class='pln'>2001</p>
<p class='pln'>2002</p>
<p class='pln'>2003</p>
<p class='pln'>2004</p>
<p class='pln'>2005</p>
<p class='pln'>2006</p>
<p class='pln'>2007</p>
<p class='pln'>2008</p>
<p class='pln'>2009</p>
<p class='pln'>2010</p>
<p class='pln'>2011</p>
<p class='pln'>2012</p>
<p class='pln'>2013</p>
<p class='pln'>2014</p>
<p class='stm mis'>2015</p>
<p class='stm mis'>2016</p>
<p class='stm mis'>2017</p>
<p class='stm mis'>2018</p>
<p class='stm mis'>2019</p>
<p class='stm mis'>2020</p>
<p class='pln'>2021</p>
<p class='stm run hide_run'>2022</p>
<p class='pln'>2023</p>
<p class='pln'>2024</p>
<p class='pln'>2025</p>
<p class='pln'>2026</p>
<p class='pln'>2027</p>
<p class='pln'>2028</p>
<p class='pln'>2029</p>
<p class='pln'>2030</p>
<p class='pln'>2031</p>
<p class='pln'>2032</p>
<p class='pln'>2033</p>
<p class='pln'>2034</p>
<p class='pln'>2035</p>
<p class='pln'>2036</p>
<p class='pln'>2037</p>
<p class='pln'>2038</p>
<p class='pln'>2039</p>
<p class='pln'>2040</p>
<p class='pln'>2041</p>
<p class='pln'>2042</p>
<p class='pln'>2043</p>
<p class='pln'>2044</p>
<p class='pln'>2045</p>
<p class='pln'>2046</p>
<p class='pln'>2047</p>
<p class='pln'>2048</p>
<p class='pln'>2049</p>
<p class='pln'>2050</p>
<p class='pln'>2051</p>
<p class='pln'>2052</p>
<p class='pln'>2053</p>
<p class='pln'>2054</p>
<p class='pln'>2055</p>
<p class='pln'>2056</p>
<p class='pln'>2057</p>
<p class='pln'>2058</p>
<p class='pln'>2059</p>
<p class='pln'>2060</p>
<p class='pln'>2061</p>
<p class='pln'>2062</p>
<p class='pln'>2063</p>
<p class='pln'>2064</p>
<p class='pln'>2065</p>
<p class='pln'>2066</p>
<p class='pln'>2067</p>
<p class='pln'>2068</p>
<p class='pln'>2069</p>
<p class='pln'>2070</p>
<p class='pln'>2071</p>
<p class='pln'>2072</p>
<p class='pln'>2073</p>
<p class='pln'>2074</p>
<p class='pln'>2075</p>
<p class='pln'>2076</p>
<p class='pln'>2077</p>
<p class='pln'>2078</p>
<p class='pln'>2079</p>
<p class='pln'>2080</p>
<p class='pln'>2081</p>
<p class='pln'>2082</p>
<p class='pln'>2083</p>
<p class='pln'>2084</p>
<p class='pln'>2085</p>
<p class='pln'>2086</p>
<p class='pln'>2087</p>
<p class='pln'>2088</p>
<p class='pln'>2089</p>
<p class='pln'>2090</p>
<p class='pln'>2091</p>
<p class='pln'>2092</p>
<p class='pln'>2093</p>
<p class='pln'>2094</p>
<p class='pln'>2095</p>
<p class='pln'>2096</p>
<p class='pln'>2097</p>
<p class='pln'>2098</p>
<p class='pln'>2099</p>
<p class='pln'>2100</p>
<p class='pln'>2101</p>
<p class='pln'>2102</p>
<p class='pln'>2103</p>
<p class='pln'>2104</p>
<p class='pln'>2105</p>
<p class='stm mis'>2106</p>
<p class='stm mis'>2107</p>
<p class='stm mis'>2108</p>
<p class='stm mis'>2109</p>
<p class='stm mis'>2110</p>
<p class='stm mis'>2111</p>
<p class='pln'>2112</p>
<p class='stm run hide_run'>2113</p>
<p class='pln'>2114</p>
<p class='pln'>2115</p>
<p class='pln'>2116</p>
<p class='pln'>2117</p>
<p class='pln'>2118</p>
<p class='pln'>2119</p>
<p class='pln'>2120</p>
<p class='pln'>2121</p>
<p class='pln'>2122</p>
<p class='pln'>2123</p>
<p class='pln'>2124</p>
<p class='pln'>2125</p>
<p class='pln'>2126</p>
<p class='pln'>2127</p>
<p class='pln'>2128</p>
<p class='pln'>2129</p>
<p class='pln'>2130</p>
<p class='pln'>2131</p>
<p class='pln'>2132</p>
<p class='pln'>2133</p>
<p class='pln'>2134</p>
<p class='pln'>2135</p>
<p class='pln'>2136</p>
<p class='pln'>2137</p>
<p class='pln'>2138</p>
<p class='pln'>2139</p>
<p class='pln'>2140</p>
<p class='pln'>2141</p>
<p class='pln'>2142</p>
<p class='pln'>2143</p>
<p class='pln'>2144</p>
<p class='pln'>2145</p>
<p class='pln'>2146</p>
<p class='pln'>2147</p>
<p class='pln'>2148</p>
<p class='pln'>2149</p>
<p class='pln'>2150</p>
<p class='pln'>2151</p>
<p class='pln'>2152</p>
<p class='pln'>2153</p>
<p class='pln'>2154</p>
<p class='pln'>2155</p>
<p class='pln'>2156</p>
<p class='pln'>2157</p>
<p class='pln'>2158</p>
<p class='pln'>2159</p>
<p class='pln'>2160</p>
<p class='pln'>2161</p>
<p class='pln'>2162</p>
<p class='pln'>2163</p>
<p class='pln'>2164</p>
<p class='pln'>2165</p>
<p class='pln'>2166</p>
<p class='pln'>2167</p>
<p class='pln'>2168</p>
<p class='pln'>2169</p>
<p class='pln'>2170</p>
<p class='pln'>2171</p>
<p class='pln'>2172</p>
<p class='pln'>2173</p>
<p class='pln'>2174</p>
<p class='pln'>2175</p>
<p class='pln'>2176</p>
<p class='pln'>2177</p>
<p class='pln'>2178</p>
<p class='pln'>2179</p>
<p class='pln'>2180</p>
<p class='pln'>2181</p>
<p class='pln'>2182</p>
<p class='pln'>2183</p>
<p class='pln'>2184</p>
<p class='pln'>2185</p>
<p class='pln'>2186</p>
<p class='pln'>2187</p>
<p class='pln'>2188</p>
<p class='pln'>2189</p>
<p class='pln'>2190</p>
<p class='pln'>2191</p>
<p class='pln'>2192</p>
<p class='pln'>2193</p>
<p class='pln'>2194</p>
<p class='pln'>2195</p>
<p class='pln'>2196</p>
<p class='pln'>2197</p>
<p class='pln'>2198</p>
<p class='pln'>2199</p>
<p class='pln'>2200</p>
<p class='pln'>2201</p>
<p class='pln'>2202</p>
<p class='stm mis'>2203</p>
<p class='stm mis'>2204</p>
<p class='stm mis'>2205</p>
<p class='stm mis'>2206</p>
<p class='stm mis'>2207</p>
<p class='stm mis'>2208</p>
<p class='pln'>2209</p>
<p class='stm run hide_run'>2210</p>
<p class='pln'>2211</p>
<p class='pln'>2212</p>
<p class='pln'>2213</p>
<p class='pln'>2214</p>
<p class='pln'>2215</p>
<p class='pln'>2216</p>
<p class='pln'>2217</p>
<p class='pln'>2218</p>
<p class='pln'>2219</p>
<p class='pln'>2220</p>
<p class='pln'>2221</p>
<p class='pln'>2222</p>
<p class='pln'>2223</p>
<p class='pln'>2224</p>
<p class='pln'>2225</p>
<p class='pln'>2226</p>
<p class='pln'>2227</p>
<p class='pln'>2228</p>
<p class='pln'>2229</p>
<p class='pln'>2230</p>
<p class='pln'>2231</p>
<p class='pln'>2232</p>
<p class='pln'>2233</p>
<p class='pln'>2234</p>
<p class='pln'>2235</p>
<p class='pln'>2236</p>
<p class='pln'>2237</p>
<p class='pln'>2238</p>
<p class='pln'>2239</p>
<p class='pln'>2240</p>
<p class='pln'>2241</p>
<p class='pln'>2242</p>
<p class='pln'>2243</p>
<p class='pln'>2244</p>
<p class='pln'>2245</p>
<p class='pln'>2246</p>
<p class='pln'>2247</p>
<p class='pln'>2248</p>
<p class='pln'>2249</p>
<p class='pln'>2250</p>
<p class='pln'>2251</p>
<p class='pln'>2252</p>
<p class='pln'>2253</p>
<p class='pln'>2254</p>
<p class='pln'>2255</p>
<p class='pln'>2256</p>
<p class='pln'>2257</p>
<p class='pln'>2258</p>
<p class='pln'>2259</p>
<p class='pln'>2260</p>
<p class='pln'>2261</p>
<p class='pln'>2262</p>
<p class='pln'>2263</p>
<p class='pln'>2264</p>
<p class='pln'>2265</p>
<p class='pln'>2266</p>
<p class='pln'>2267</p>
<p class='pln'>2268</p>
<p class='pln'>2269</p>
<p class='pln'>2270</p>
<p class='pln'>2271</p>
<p class='pln'>2272</p>
<p class='pln'>2273</p>
<p class='pln'>2274</p>
<p class='pln'>2275</p>
<p class='pln'>2276</p>
<p class='pln'>2277</p>
<p class='pln'>2278</p>
<p class='pln'>2279</p>
<p class='pln'>2280</p>
<p class='pln'>2281</p>
<p class='pln'>2282</p>
<p class='pln'>2283</p>
<p class='pln'>2284</p>
<p class='pln'>2285</p>
<p class='pln'>2286</p>
<p class='pln'>2287</p>
<p class='pln'>2288</p>
<p class='pln'>2289</p>
<p class='pln'>2290</p>
<p class='pln'>2291</p>
<p class='pln'>2292</p>
<p class='stm mis'>2293</p>
<p class='stm mis'>2294</p>
<p class='stm mis'>2295</p>
<p class='stm mis'>2296</p>
<p class='stm mis'>2297</p>
<p class='stm mis'>2298</p>
<p class='pln'>2299</p>
<p class='stm run hide_run'>2300</p>
<p class='pln'>2301</p>
<p class='pln'>2302</p>
<p class='pln'>2303</p>
<p class='pln'>2304</p>
<p class='pln'>2305</p>
<p class='pln'>2306</p>
<p class='pln'>2307</p>
<p class='pln'>2308</p>
<p class='pln'>2309</p>
<p class='pln'>2310</p>
<p class='pln'>2311</p>
<p class='pln'>2312</p>
<p class='pln'>2313</p>
<p class='pln'>2314</p>
<p class='pln'>2315</p>
<p class='pln'>2316</p>
<p class='pln'>2317</p>
<p class='pln'>2318</p>
<p class='pln'>2319</p>
<p class='pln'>2320</p>
<p class='pln'>2321</p>
<p class='pln'>2322</p>
<p class='pln'>2323</p>
<p class='pln'>2324</p>
<p class='pln'>2325</p>
<p class='pln'>2326</p>
<p class='pln'>2327</p>
<p class='pln'>2328</p>
<p class='pln'>2329</p>
<p class='pln'>2330</p>
<p class='pln'>2331</p>
<p class='pln'>2332</p>
<p class='pln'>2333</p>
<p class='pln'>2334</p>
<p class='pln'>2335</p>
<p class='pln'>2336</p>
<p class='pln'>2337</p>
<p class='pln'>2338</p>
<p class='pln'>2339</p>
<p class='pln'>2340</p>
<p class='pln'>2341</p>
<p class='pln'>2342</p>
<p class='pln'>2343</p>
<p class='pln'>2344</p>
<p class='pln'>2345</p>
<p class='pln'>2346</p>
<p class='pln'>2347</p>
<p class='pln'>2348</p>
<p class='pln'>2349</p>
<p class='pln'>2350</p>
<p class='pln'>2351</p>
<p class='pln'>2352</p>
<p class='pln'>2353</p>
<p class='pln'>2354</p>
<p class='pln'>2355</p>
<p class='pln'>2356</p>
<p class='pln'>2357</p>
<p class='pln'>2358</p>
<p class='pln'>2359</p>
<p class='pln'>2360</p>
<p class='pln'>2361</p>
<p class='pln'>2362</p>
<p class='pln'>2363</p>
<p class='pln'>2364</p>
<p class='pln'>2365</p>
<p class='pln'>2366</p>
<p class='pln'>2367</p>
<p class='pln'>2368</p>
<p class='pln'>2369</p>
<p class='pln'>2370</p>
<p class='pln'>2371</p>
<p class='pln'>2372</p>
<p class='pln'>2373</p>
<p class='pln'>2374</p>
<p class='pln'>2375</p>
<p class='pln'>2376</p>
<p class='pln'>2377</p>
<p class='pln'>2378</p>
<p class='pln'>2379</p>
<p class='pln'>2380</p>
<p class='pln'>2381</p>
<p class='stm mis'>2382</p>
<p class='stm mis'>2383</p>
<p class='stm mis'>2384</p>
<p class='stm mis'>2385</p>
<p class='stm mis'>2386</p>
<p class='stm mis'>2387</p>
<p class='pln'>2388</p>
<p class='pln'>2389</p>
<p class='pln'>2390</p>
<p class='stm run hide_run'>2391</p>
<p class='pln'>2392</p>
<p class='pln'>2393</p>
<p class='pln'>2394</p>
<p class='pln'>2395</p>
<p class='pln'>2396</p>
<p class='pln'>2397</p>
<p class='pln'>2398</p>
<p class='pln'>2399</p>
<p class='pln'>2400</p>
<p class='pln'>2401</p>
<p class='pln'>2402</p>
<p class='pln'>2403</p>
<p class='pln'>2404</p>
<p class='pln'>2405</p>
<p class='pln'>2406</p>
<p class='pln'>2407</p>
<p class='pln'>2408</p>
<p class='pln'>2409</p>
<p class='pln'>2410</p>
<p class='pln'>2411</p>
<p class='pln'>2412</p>
<p class='pln'>2413</p>
<p class='pln'>2414</p>
<p class='pln'>2415</p>
<p class='pln'>2416</p>
<p class='pln'>2417</p>
<p class='pln'>2418</p>
<p class='pln'>2419</p>
<p class='pln'>2420</p>
<p class='pln'>2421</p>
<p class='pln'>2422</p>
<p class='stm run hide_run'>2423</p>
<p class='pln'>2424</p>
<p class='pln'>2425</p>
<p class='pln'>2426</p>
<p class='pln'>2427</p>
<p class='pln'>2428</p>
<p class='pln'>2429</p>
<p class='pln'>2430</p>
<p class='pln'>2431</p>
<p class='pln'>2432</p>
<p class='pln'>2433</p>
<p class='pln'>2434</p>
<p class='pln'>2435</p>
<p class='pln'>2436</p>
<p class='pln'>2437</p>
<p class='pln'>2438</p>
<p class='pln'>2439</p>
<p class='pln'>2440</p>
<p class='pln'>2441</p>
<p class='pln'>2442</p>
<p class='pln'>2443</p>
<p class='pln'>2444</p>
<p class='pln'>2445</p>
<p class='pln'>2446</p>
<p class='pln'>2447</p>
<p class='pln'>2448</p>
<p class='pln'>2449</p>
<p class='stm run hide_run'>2450</p>
<p class='stm mis'>2451</p>
<p class='stm mis'>2452</p>
<p class='pln'>2453</p>
<p class='stm mis'>2454</p>
<p class='stm mis'>2455</p>
<p class='stm mis'>2456</p>
<p class='stm mis'>2457</p>
<p class='pln'>2458</p>
<p class='stm mis'>2459</p>
<p class='pln'>2460</p>
<p class='stm run hide_run'>2461</p>
<p class='stm mis'>2462</p>
<p class='pln'>2463</p>
<p class='stm run hide_run'>2464</p>
<p class='stm mis'>2465</p>
<p class='pln'>2466</p>
<p class='stm run hide_run'>2467</p>
<p class='pln'>2468</p>
<p class='pln'>2469</p>
<p class='pln'>2470</p>
<p class='pln'>2471</p>
<p class='pln'>2472</p>
<p class='pln'>2473</p>
<p class='pln'>2474</p>
<p class='pln'>2475</p>
<p class='pln'>2476</p>
<p class='pln'>2477</p>
<p class='pln'>2478</p>
<p class='pln'>2479</p>
<p class='pln'>2480</p>
<p class='pln'>2481</p>
<p class='pln'>2482</p>
<p class='pln'>2483</p>
<p class='pln'>2484</p>
<p class='pln'>2485</p>
<p class='pln'>2486</p>
<p class='pln'>2487</p>
<p class='pln'>2488</p>
<p class='pln'>2489</p>
<p class='pln'>2490</p>
<p class='pln'>2491</p>
<p class='pln'>2492</p>
<p class='pln'>2493</p>
<p class='pln'>2494</p>
<p class='pln'>2495</p>
<p class='pln'>2496</p>
<p class='pln'>2497</p>
<p class='pln'>2498</p>
<p class='pln'>2499</p>
<p class='pln'>2500</p>
<p class='pln'>2501</p>
<p class='stm mis'>2502</p>
<p class='stm mis'>2503</p>
<p class='stm mis'>2504</p>
<p class='stm mis'>2505</p>
<p class='stm mis'>2506</p>
<p class='stm mis'>2507</p>
<p class='stm mis'>2508</p>
<p class='stm mis'>2509</p>
<p class='stm mis'>2510</p>
<p class='pln'>2511</p>
<p class='pln'>2512</p>
<p class='pln'>2513</p>
<p class='stm run hide_run'>2514</p>
<p class='pln'>2515</p>
<p class='pln'>2516</p>
<p class='pln'>2517</p>
<p class='pln'>2518</p>
<p class='pln'>2519</p>
<p class='pln'>2520</p>
<p class='pln'>2521</p>
<p class='pln'>2522</p>
<p class='pln'>2523</p>
<p class='pln'>2524</p>
<p class='pln'>2525</p>
<p class='pln'>2526</p>
<p class='pln'>2527</p>
<p class='pln'>2528</p>
<p class='pln'>2529</p>
<p class='pln'>2530</p>
<p class='pln'>2531</p>
<p class='pln'>2532</p>
<p class='pln'>2533</p>
<p class='pln'>2534</p>
<p class='pln'>2535</p>
<p class='pln'>2536</p>
<p class='pln'>2537</p>
<p class='pln'>2538</p>
<p class='pln'>2539</p>
<p class='pln'>2540</p>
<p class='pln'>2541</p>
<p class='pln'>2542</p>
<p class='pln'>2543</p>
<p class='pln'>2544</p>
<p class='pln'>2545</p>
<p class='pln'>2546</p>
<p class='pln'>2547</p>
<p class='pln'>2548</p>
<p class='pln'>2549</p>
<p class='pln'>2550</p>
<p class='pln'>2551</p>
<p class='pln'>2552</p>
<p class='pln'>2553</p>
<p class='pln'>2554</p>
<p class='pln'>2555</p>
<p class='pln'>2556</p>
<p class='pln'>2557</p>
<p class='pln'>2558</p>
<p class='pln'>2559</p>
<p class='pln'>2560</p>
<p class='pln'>2561</p>
<p class='pln'>2562</p>
<p class='pln'>2563</p>
<p class='pln'>2564</p>
<p class='pln'>2565</p>
<p class='pln'>2566</p>
<p class='pln'>2567</p>
<p class='pln'>2568</p>
<p class='pln'>2569</p>
<p class='pln'>2570</p>
<p class='pln'>2571</p>
<p class='pln'>2572</p>
<p class='pln'>2573</p>
<p class='pln'>2574</p>
<p class='pln'>2575</p>
<p class='pln'>2576</p>
<p class='pln'>2577</p>
<p class='pln'>2578</p>
<p class='pln'>2579</p>
<p class='pln'>2580</p>
<p class='pln'>2581</p>
<p class='pln'>2582</p>
<p class='pln'>2583</p>
<p class='pln'>2584</p>
<p class='pln'>2585</p>
<p class='pln'>2586</p>
<p class='pln'>2587</p>
<p class='pln'>2588</p>
<p class='pln'>2589</p>
<p class='pln'>2590</p>
<p class='pln'>2591</p>
<p class='pln'>2592</p>
<p class='pln'>2593</p>
<p class='pln'>2594</p>
<p class='pln'>2595</p>
<p class='pln'>2596</p>
<p class='pln'>2597</p>
<p class='pln'>2598</p>
<p class='pln'>2599</p>
<p class='pln'>2600</p>
<p class='pln'>2601</p>
<p class='pln'>2602</p>
<p class='pln'>2603</p>
<p class='pln'>2604</p>
<p class='pln'>2605</p>
<p class='pln'>2606</p>
<p class='pln'>2607</p>
<p class='pln'>2608</p>
<p class='pln'>2609</p>
<p class='pln'>2610</p>
<p class='pln'>2611</p>
<p class='pln'>2612</p>
<p class='pln'>2613</p>
<p class='pln'>2614</p>
<p class='pln'>2615</p>
<p class='pln'>2616</p>
<p class='pln'>2617</p>
<p class='pln'>2618</p>
<p class='pln'>2619</p>
<p class='pln'>2620</p>
<p class='pln'>2621</p>
<p class='pln'>2622</p>
<p class='pln'>2623</p>
<p class='pln'>2624</p>
<p class='pln'>2625</p>
<p class='pln'>2626</p>
<p class='stm mis'>2627</p>
<p class='stm mis'>2628</p>
<p class='stm mis'>2629</p>
<p class='stm mis'>2630</p>
<p class='pln'>2631</p>
<p class='stm run hide_run'>2632</p>
<p class='pln'>2633</p>
<p class='pln'>2634</p>
<p class='pln'>2635</p>
<p class='pln'>2636</p>
<p class='pln'>2637</p>
<p class='pln'>2638</p>
<p class='pln'>2639</p>
<p class='pln'>2640</p>
<p class='pln'>2641</p>
<p class='pln'>2642</p>
<p class='pln'>2643</p>
<p class='pln'>2644</p>
<p class='pln'>2645</p>
<p class='pln'>2646</p>
<p class='pln'>2647</p>
<p class='pln'>2648</p>
<p class='pln'>2649</p>
<p class='pln'>2650</p>
<p class='pln'>2651</p>
<p class='pln'>2652</p>
<p class='pln'>2653</p>
<p class='pln'>2654</p>
<p class='pln'>2655</p>
<p class='pln'>2656</p>
<p class='pln'>2657</p>
<p class='pln'>2658</p>
<p class='pln'>2659</p>
<p class='pln'>2660</p>
<p class='pln'>2661</p>
<p class='pln'>2662</p>
<p class='pln'>2663</p>
<p class='pln'>2664</p>
<p class='pln'>2665</p>
<p class='pln'>2666</p>
<p class='pln'>2667</p>
<p class='pln'>2668</p>
<p class='pln'>2669</p>
<p class='pln'>2670</p>
<p class='pln'>2671</p>
<p class='pln'>2672</p>
<p class='pln'>2673</p>
<p class='pln'>2674</p>
<p class='pln'>2675</p>
<p class='pln'>2676</p>
<p class='pln'>2677</p>
<p class='pln'>2678</p>
<p class='pln'>2679</p>
<p class='pln'>2680</p>
<p class='pln'>2681</p>
<p class='pln'>2682</p>
<p class='pln'>2683</p>
<p class='pln'>2684</p>
<p class='pln'>2685</p>
<p class='pln'>2686</p>
<p class='pln'>2687</p>
<p class='pln'>2688</p>
<p class='pln'>2689</p>
<p class='pln'>2690</p>
<p class='pln'>2691</p>
<p class='pln'>2692</p>
<p class='pln'>2693</p>
<p class='pln'>2694</p>
<p class='pln'>2695</p>
<p class='pln'>2696</p>
<p class='pln'>2697</p>
<p class='pln'>2698</p>
<p class='pln'>2699</p>
<p class='pln'>2700</p>
<p class='pln'>2701</p>
<p class='stm mis'>2702</p>
<p class='stm mis'>2703</p>
<p class='pln'>2704</p>
<p class='stm run hide_run'>2705</p>
<p class='pln'>2706</p>
<p class='pln'>2707</p>
<p class='pln'>2708</p>
<p class='pln'>2709</p>
<p class='pln'>2710</p>
<p class='pln'>2711</p>
<p class='pln'>2712</p>
<p class='pln'>2713</p>
<p class='pln'>2714</p>
<p class='pln'>2715</p>
<p class='pln'>2716</p>
<p class='pln'>2717</p>
<p class='pln'>2718</p>
<p class='pln'>2719</p>
<p class='pln'>2720</p>
<p class='pln'>2721</p>
<p class='pln'>2722</p>
<p class='pln'>2723</p>
<p class='pln'>2724</p>
<p class='pln'>2725</p>
<p class='pln'>2726</p>
<p class='pln'>2727</p>
<p class='stm mis'>2728</p>
<p class='stm mis'>2729</p>
<p class='stm mis'>2730</p>
<p class='pln'>2731</p>
<p class='stm run hide_run'>2732</p>
<p class='pln'>2733</p>
<p class='pln'>2734</p>
<p class='pln'>2735</p>
<p class='pln'>2736</p>
<p class='pln'>2737</p>
<p class='pln'>2738</p>
<p class='pln'>2739</p>
<p class='pln'>2740</p>
<p class='pln'>2741</p>
<p class='pln'>2742</p>
<p class='pln'>2743</p>
<p class='pln'>2744</p>
<p class='pln'>2745</p>
<p class='pln'>2746</p>
<p class='pln'>2747</p>
<p class='pln'>2748</p>
<p class='pln'>2749</p>
<p class='pln'>2750</p>
<p class='pln'>2751</p>
<p class='pln'>2752</p>
<p class='pln'>2753</p>
<p class='pln'>2754</p>
<p class='pln'>2755</p>
<p class='pln'>2756</p>
<p class='pln'>2757</p>
<p class='pln'>2758</p>
<p class='pln'>2759</p>
<p class='pln'>2760</p>
<p class='pln'>2761</p>
<p class='pln'>2762</p>
<p class='pln'>2763</p>
<p class='pln'>2764</p>
<p class='pln'>2765</p>
<p class='pln'>2766</p>
<p class='pln'>2767</p>
<p class='pln'>2768</p>
<p class='pln'>2769</p>
<p class='pln'>2770</p>
<p class='pln'>2771</p>
<p class='pln'>2772</p>
<p class='pln'>2773</p>
<p class='pln'>2774</p>
<p class='pln'>2775</p>
<p class='pln'>2776</p>
<p class='pln'>2777</p>
<p class='pln'>2778</p>
<p class='pln'>2779</p>
<p class='pln'>2780</p>
<p class='pln'>2781</p>
<p class='pln'>2782</p>
<p class='pln'>2783</p>
<p class='pln'>2784</p>
<p class='pln'>2785</p>
<p class='pln'>2786</p>
<p class='pln'>2787</p>
<p class='pln'>2788</p>
<p class='pln'>2789</p>
<p class='pln'>2790</p>
<p class='pln'>2791</p>
<p class='pln'>2792</p>
<p class='pln'>2793</p>
<p class='pln'>2794</p>
<p class='pln'>2795</p>
<p class='pln'>2796</p>
<p class='pln'>2797</p>
<p class='pln'>2798</p>
<p class='pln'>2799</p>
<p class='pln'>2800</p>
<p class='pln'>2801</p>
<p class='pln'>2802</p>
<p class='pln'>2803</p>
<p class='pln'>2804</p>
<p class='pln'>2805</p>
<p class='stm mis'>2806</p>
<p class='stm mis'>2807</p>
<p class='stm mis'>2808</p>
<p class='stm mis'>2809</p>
<p class='pln'>2810</p>
<p class='stm mis'>2811</p>
<p class='stm mis'>2812</p>
<p class='pln'>2813</p>
<p class='stm mis'>2814</p>
<p class='stm mis'>2815</p>
<p class='stm mis'>2816</p>
<p class='stm mis'>2817</p>
<p class='stm mis'>2818</p>
<p class='stm mis'>2819</p>
<p class='pln'>2820</p>
<p class='stm mis'>2821</p>
<p class='pln'>2822</p>
<p class='stm mis'>2823</p>
<p class='pln'>2824</p>
<p class='pln'>2825</p>
<p class='stm mis'>2826</p>
<p class='pln'>2827</p>
<p class='stm run hide_run'>2828</p>
<p class='pln'>2829</p>
<p class='pln'>2830</p>
<p class='pln'>2831</p>
<p class='pln'>2832</p>
<p class='pln'>2833</p>
<p class='pln'>2834</p>
<p class='pln'>2835</p>
<p class='pln'>2836</p>
<p class='pln'>2837</p>
<p class='pln'>2838</p>
<p class='pln'>2839</p>
<p class='pln'>2840</p>
<p class='pln'>2841</p>
<p class='pln'>2842</p>
<p class='pln'>2843</p>
<p class='pln'>2844</p>
<p class='pln'>2845</p>
<p class='pln'>2846</p>
<p class='pln'>2847</p>
<p class='pln'>2848</p>
<p class='pln'>2849</p>
<p class='pln'>2850</p>
<p class='pln'>2851</p>
<p class='pln'>2852</p>
<p class='stm mis'>2853</p>
<p class='stm mis'>2854</p>
<p class='stm mis'>2855</p>
<p class='pln'>2856</p>
<p class='stm mis'>2857</p>
<p class='stm mis'>2858</p>
<p class='stm mis'>2859</p>
<p class='stm mis'>2860</p>
<p class='stm mis'>2861</p>
<p class='stm mis'>2862</p>
<p class='stm mis'>2863</p>
<p class='pln'>2864</p>
<p class='pln'>2865</p>
<p class='stm run hide_run'>2866</p>
<p class='pln'>2867</p>
<p class='pln'>2868</p>
<p class='pln'>2869</p>
<p class='pln'>2870</p>
<p class='pln'>2871</p>
<p class='pln'>2872</p>
<p class='pln'>2873</p>
<p class='pln'>2874</p>
<p class='pln'>2875</p>
<p class='pln'>2876</p>
<p class='pln'>2877</p>
<p class='pln'>2878</p>
<p class='pln'>2879</p>
<p class='pln'>2880</p>
<p class='stm run hide_run'>2881</p>
<p class='stm run hide_run'>2882</p>
<p class='stm run hide_run'>2883</p>
<p class='stm run hide_run'>2884</p>
<p class='stm run hide_run'>2885</p>
<p class='stm run hide_run'>2886</p>
<p class='stm run hide_run'>2887</p>
<p class='stm mis'>2888</p>
<p class='stm mis'>2889</p>
<p class='stm mis'>2890</p>
<p class='stm run hide_run'>2891</p>
<p class='stm run hide_run'>2892</p>
<p class='pln'>2893</p>
<p class='pln'>2894</p>
<p class='pln'>2895</p>
<p class='stm run hide_run'>2896</p>
<p class='pln'>2897</p>
<p class='pln'>2898</p>
<p class='pln'>2899</p>
<p class='pln'>2900</p>
<p class='pln'>2901</p>
<p class='pln'>2902</p>
<p class='pln'>2903</p>
<p class='pln'>2904</p>
<p class='pln'>2905</p>
<p class='pln'>2906</p>
<p class='pln'>2907</p>
<p class='pln'>2908</p>
<p class='pln'>2909</p>
<p class='pln'>2910</p>
<p class='pln'>2911</p>
<p class='pln'>2912</p>
<p class='pln'>2913</p>
<p class='pln'>2914</p>
<p class='pln'>2915</p>
<p class='pln'>2916</p>
<p class='pln'>2917</p>
<p class='pln'>2918</p>
<p class='pln'>2919</p>
<p class='pln'>2920</p>
<p class='pln'>2921</p>
<p class='pln'>2922</p>
<p class='pln'>2923</p>
<p class='pln'>2924</p>
<p class='pln'>2925</p>
<p class='pln'>2926</p>
<p class='pln'>2927</p>
<p class='pln'>2928</p>
<p class='pln'>2929</p>
<p class='pln'>2930</p>
<p class='pln'>2931</p>
<p class='pln'>2932</p>
<p class='pln'>2933</p>
<p class='pln'>2934</p>
<p class='pln'>2935</p>
<p class='stm mis'>2936</p>
<p class='stm mis'>2937</p>
<p class='stm mis'>2938</p>
<p class='stm mis'>2939</p>
<p class='stm mis'>2940</p>
<p class='pln'>2941</p>
<p class='stm mis'>2942</p>
<p class='stm mis'>2943</p>
<p class='stm mis'>2944</p>
<p class='pln'>2945</p>
<p class='stm run hide_run'>2946</p>
<p class='pln'>2947</p>
<p class='pln'>2948</p>
<p class='pln'>2949</p>
<p class='pln'>2950</p>
<p class='pln'>2951</p>
<p class='pln'>2952</p>
<p class='pln'>2953</p>
<p class='pln'>2954</p>
<p class='pln'>2955</p>
<p class='pln'>2956</p>
<p class='pln'>2957</p>
<p class='pln'>2958</p>
<p class='pln'>2959</p>
<p class='pln'>2960</p>
<p class='pln'>2961</p>
<p class='pln'>2962</p>
<p class='pln'>2963</p>
<p class='pln'>2964</p>
<p class='pln'>2965</p>
<p class='pln'>2966</p>
<p class='pln'>2967</p>
<p class='pln'>2968</p>
<p class='pln'>2969</p>
<p class='pln'>2970</p>
<p class='pln'>2971</p>
<p class='pln'>2972</p>
<p class='pln'>2973</p>
<p class='pln'>2974</p>
<p class='pln'>2975</p>
<p class='pln'>2976</p>
<p class='pln'>2977</p>
<p class='pln'>2978</p>
<p class='pln'>2979</p>
<p class='pln'>2980</p>
<p class='pln'>2981</p>
<p class='pln'>2982</p>
<p class='stm mis'>2983</p>
<p class='stm mis'>2984</p>
<p class='stm mis'>2985</p>
<p class='stm mis'>2986</p>
<p class='stm mis'>2987</p>
<p class='stm mis'>2988</p>
<p class='pln'>2989</p>
<p class='pln'>2990</p>
<p class='stm mis'>2991</p>
<p class='stm mis'>2992</p>
<p class='stm mis'>2993</p>
<p class='stm mis'>2994</p>
<p class='stm mis'>2995</p>
<p class='stm mis'>2996</p>
<p class='stm mis'>2997</p>
<p class='stm mis'>2998</p>
<p class='stm mis'>2999</p>
<p class='stm mis'>3000</p>
<p class='pln'>3001</p>
<p class='stm mis'>3002</p>
<p class='stm mis'>3003</p>
<p class='stm mis'>3004</p>
<p class='stm mis'>3005</p>
<p class='stm mis'>3006</p>
<p class='stm mis'>3007</p>
<p class='stm mis'>3008</p>
<p class='stm mis'>3009</p>
<p class='stm mis'>3010</p>
<p class='stm mis'>3011</p>
<p class='stm mis'>3012</p>
<p class='stm mis'>3013</p>
<p class='stm mis'>3014</p>
<p class='stm mis'>3015</p>
<p class='stm mis'>3016</p>
<p class='stm mis'>3017</p>
<p class='stm mis'>3018</p>
<p class='stm mis'>3019</p>
<p class='stm mis'>3020</p>
<p class='stm mis'>3021</p>
<p class='stm mis'>3022</p>
<p class='stm mis'>3023</p>
<p class='pln'>3024</p>
<p class='stm mis'>3025</p>
<p class='stm mis'>3026</p>
<p class='stm mis'>3027</p>
<p class='pln'>3028</p>
<p class='stm mis'>3029</p>
<p class='stm mis'>3030</p>
<p class='pln'>3031</p>
<p class='stm mis'>3032</p>
<p class='stm mis'>3033</p>
<p class='pln'>3034</p>
<p class='stm mis'>3035</p>
<p class='stm mis'>3036</p>
<p class='pln'>3037</p>
<p class='stm mis'>3038</p>
<p class='stm mis'>3039</p>
<p class='stm mis'>3040</p>
<p class='stm mis'>3041</p>
<p class='pln'>3042</p>
<p class='stm mis'>3043</p>
<p class='stm mis'>3044</p>
<p class='pln'>3045</p>
<p class='stm mis'>3046</p>
<p class='stm mis'>3047</p>
<p class='stm mis'>3048</p>
<p class='stm mis'>3049</p>
<p class='stm mis'>3050</p>
<p class='stm mis'>3051</p>
<p class='stm mis'>3052</p>
<p class='pln'>3053</p>
<p class='stm mis'>3054</p>
<p class='stm mis'>3055</p>
<p class='stm mis'>3056</p>
<p class='stm mis'>3057</p>
<p class='stm mis'>3058</p>
<p class='stm mis'>3059</p>
<p class='stm mis'>3060</p>
<p class='pln'>3061</p>
<p class='stm mis'>3062</p>
<p class='pln'>3063</p>
<p class='stm run hide_run'>3064</p>
<p class='pln'>3065</p>
<p class='pln'>3066</p>
<p class='pln'>3067</p>
<p class='pln'>3068</p>
<p class='pln'>3069</p>
<p class='pln'>3070</p>
<p class='pln'>3071</p>
<p class='pln'>3072</p>
<p class='pln'>3073</p>
<p class='pln'>3074</p>
<p class='pln'>3075</p>
<p class='pln'>3076</p>
<p class='pln'>3077</p>
<p class='pln'>3078</p>
<p class='pln'>3079</p>
<p class='pln'>3080</p>
<p class='pln'>3081</p>
<p class='pln'>3082</p>
<p class='pln'>3083</p>
<p class='pln'>3084</p>
<p class='pln'>3085</p>
<p class='pln'>3086</p>
<p class='pln'>3087</p>
<p class='pln'>3088</p>
<p class='pln'>3089</p>
<p class='pln'>3090</p>
<p class='pln'>3091</p>
<p class='pln'>3092</p>
<p class='stm mis'>3093</p>
<p class='stm mis'>3094</p>
<p class='stm mis'>3095</p>
<p class='stm mis'>3096</p>
<p class='stm mis'>3097</p>
<p class='stm mis'>3098</p>
<p class='pln'>3099</p>
<p class='stm mis'>3100</p>
<p class='stm mis'>3101</p>
<p class='stm mis'>3102</p>
<p class='stm mis'>3103</p>
<p class='stm mis'>3104</p>
<p class='stm mis'>3105</p>
<p class='stm mis'>3106</p>
<p class='stm mis'>3107</p>
<p class='stm mis'>3108</p>
<p class='stm mis'>3109</p>
<p class='stm mis'>3110</p>
<p class='stm mis'>3111</p>
<p class='pln'>3112</p>
<p class='stm mis'>3113</p>
<p class='stm mis'>3114</p>
<p class='stm mis'>3115</p>
<p class='stm mis'>3116</p>
<p class='stm mis'>3117</p>
<p class='stm mis'>3118</p>
<p class='stm mis'>3119</p>
<p class='stm mis'>3120</p>
<p class='pln'>3121</p>
<p class='stm mis'>3122</p>
<p class='stm mis'>3123</p>
<p class='stm mis'>3124</p>
<p class='stm mis'>3125</p>
<p class='stm mis'>3126</p>
<p class='stm mis'>3127</p>
<p class='stm mis'>3128</p>
<p class='stm mis'>3129</p>
<p class='stm mis'>3130</p>
<p class='stm mis'>3131</p>
<p class='stm mis'>3132</p>
<p class='stm mis'>3133</p>
<p class='stm mis'>3134</p>
<p class='pln'>3135</p>
<p class='stm mis'>3136</p>
<p class='pln'>3137</p>
<p class='stm mis'>3138</p>
<p class='pln'>3139</p>
<p class='pln'>3140</p>
<p class='pln'>3141</p>
<p class='pln'>3142</p>
<p class='pln'>3143</p>
<p class='stm mis'>3144</p>
<p class='stm mis'>3145</p>
<p class='stm mis'>3146</p>
<p class='stm mis'>3147</p>
<p class='stm mis'>3148</p>
<p class='stm mis'>3149</p>
<p class='stm mis'>3150</p>
<p class='stm mis'>3151</p>
<p class='stm mis'>3152</p>
<p class='stm mis'>3153</p>
<p class='stm mis'>3154</p>
<p class='pln'>3155</p>
<p class='stm mis'>3156</p>
<p class='stm mis'>3157</p>
<p class='stm mis'>3158</p>
<p class='pln'>3159</p>
<p class='stm run hide_run'>3160</p>
<p class='pln'>3161</p>
<p class='pln'>3162</p>
<p class='pln'>3163</p>
<p class='pln'>3164</p>
<p class='pln'>3165</p>
<p class='pln'>3166</p>
<p class='pln'>3167</p>
<p class='pln'>3168</p>
<p class='pln'>3169</p>
<p class='pln'>3170</p>
<p class='pln'>3171</p>
<p class='pln'>3172</p>
<p class='pln'>3173</p>
<p class='pln'>3174</p>
<p class='pln'>3175</p>
<p class='pln'>3176</p>
<p class='pln'>3177</p>
<p class='pln'>3178</p>
<p class='pln'>3179</p>
<p class='pln'>3180</p>
<p class='pln'>3181</p>
<p class='pln'>3182</p>
<p class='pln'>3183</p>
<p class='pln'>3184</p>
<p class='pln'>3185</p>
<p class='pln'>3186</p>
<p class='pln'>3187</p>
<p class='pln'>3188</p>
<p class='pln'>3189</p>
<p class='pln'>3190</p>
<p class='pln'>3191</p>
<p class='pln'>3192</p>
<p class='pln'>3193</p>
<p class='stm mis'>3194</p>
<p class='stm mis'>3195</p>
<p class='stm mis'>3196</p>
<p class='stm mis'>3197</p>
<p class='stm mis'>3198</p>
<p class='stm mis'>3199</p>
<p class='stm mis'>3200</p>
    
</td>
<td class='text' valign='top'>
<p class='stm run hide_run'><span class='nam'>__docformat__</span> <span class='op'>=</span> <span class='str'>&quot;restructuredtext en&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='nam'>__all__</span> <span class='op'>=</span> <span class='op'>[</span><span class='str'>&#39;logspace&#39;</span><span class='op'>,</span> <span class='str'>&#39;linspace&#39;</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class='str'>&#39;select&#39;</span><span class='op'>,</span> <span class='str'>&#39;piecewise&#39;</span><span class='op'>,</span> <span class='str'>&#39;trim_zeros&#39;</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class='str'>&#39;copy&#39;</span><span class='op'>,</span> <span class='str'>&#39;iterable&#39;</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class='str'>&#39;diff&#39;</span><span class='op'>,</span> <span class='str'>&#39;gradient&#39;</span><span class='op'>,</span> <span class='str'>&#39;angle&#39;</span><span class='op'>,</span> <span class='str'>&#39;unwrap&#39;</span><span class='op'>,</span> <span class='str'>&#39;sort_complex&#39;</span><span class='op'>,</span> <span class='str'>&#39;disp&#39;</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class='str'>&#39;unique&#39;</span><span class='op'>,</span> <span class='str'>&#39;extract&#39;</span><span class='op'>,</span> <span class='str'>&#39;place&#39;</span><span class='op'>,</span> <span class='str'>&#39;nansum&#39;</span><span class='op'>,</span> <span class='str'>&#39;nanmax&#39;</span><span class='op'>,</span> <span class='str'>&#39;nanargmax&#39;</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class='str'>&#39;nanargmin&#39;</span><span class='op'>,</span> <span class='str'>&#39;nanmin&#39;</span><span class='op'>,</span> <span class='str'>&#39;vectorize&#39;</span><span class='op'>,</span> <span class='str'>&#39;asarray_chkfinite&#39;</span><span class='op'>,</span> <span class='str'>&#39;average&#39;</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class='str'>&#39;histogram&#39;</span><span class='op'>,</span> <span class='str'>&#39;histogramdd&#39;</span><span class='op'>,</span> <span class='str'>&#39;bincount&#39;</span><span class='op'>,</span> <span class='str'>&#39;digitize&#39;</span><span class='op'>,</span> <span class='str'>&#39;cov&#39;</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class='str'>&#39;corrcoef&#39;</span><span class='op'>,</span> <span class='str'>&#39;msort&#39;</span><span class='op'>,</span> <span class='str'>&#39;median&#39;</span><span class='op'>,</span> <span class='str'>&#39;sinc&#39;</span><span class='op'>,</span> <span class='str'>&#39;hamming&#39;</span><span class='op'>,</span> <span class='str'>&#39;hanning&#39;</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class='str'>&#39;bartlett&#39;</span><span class='op'>,</span> <span class='str'>&#39;blackman&#39;</span><span class='op'>,</span> <span class='str'>&#39;kaiser&#39;</span><span class='op'>,</span> <span class='str'>&#39;trapz&#39;</span><span class='op'>,</span> <span class='str'>&#39;i0&#39;</span><span class='op'>,</span> <span class='str'>&#39;add_newdoc&#39;</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class='str'>&#39;add_docstring&#39;</span><span class='op'>,</span> <span class='str'>&#39;meshgrid&#39;</span><span class='op'>,</span> <span class='str'>&#39;delete&#39;</span><span class='op'>,</span> <span class='str'>&#39;insert&#39;</span><span class='op'>,</span> <span class='str'>&#39;append&#39;</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class='str'>&#39;interp&#39;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>import</span> <span class='nam'>warnings</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>import</span> <span class='nam'>types</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>import</span> <span class='nam'>numpy</span><span class='op'>.</span><span class='nam'>core</span><span class='op'>.</span><span class='nam'>numeric</span> <span class='key'>as</span> <span class='nam'>_nx</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>from</span> <span class='nam'>numpy</span><span class='op'>.</span><span class='nam'>core</span><span class='op'>.</span><span class='nam'>numeric</span> <span class='key'>import</span> <span class='nam'>ones</span><span class='op'>,</span> <span class='nam'>zeros</span><span class='op'>,</span> <span class='nam'>arange</span><span class='op'>,</span> <span class='nam'>concatenate</span><span class='op'>,</span> <span class='nam'>array</span><span class='op'>,</span> <span class='xx'>\</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp;&nbsp; <span class='nam'>asarray</span><span class='op'>,</span> <span class='nam'>asanyarray</span><span class='op'>,</span> <span class='nam'>empty</span><span class='op'>,</span> <span class='nam'>empty_like</span><span class='op'>,</span> <span class='nam'>ndarray</span><span class='op'>,</span> <span class='nam'>around</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>from</span> <span class='nam'>numpy</span><span class='op'>.</span><span class='nam'>core</span><span class='op'>.</span><span class='nam'>numeric</span> <span class='key'>import</span> <span class='nam'>ScalarType</span><span class='op'>,</span> <span class='nam'>dot</span><span class='op'>,</span> <span class='nam'>where</span><span class='op'>,</span> <span class='nam'>newaxis</span><span class='op'>,</span> <span class='nam'>intp</span><span class='op'>,</span> <span class='xx'>\</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp;&nbsp; <span class='nam'>integer</span><span class='op'>,</span> <span class='nam'>isscalar</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>from</span> <span class='nam'>numpy</span><span class='op'>.</span><span class='nam'>core</span><span class='op'>.</span><span class='nam'>umath</span> <span class='key'>import</span> <span class='nam'>pi</span><span class='op'>,</span> <span class='nam'>multiply</span><span class='op'>,</span> <span class='nam'>add</span><span class='op'>,</span> <span class='nam'>arctan2</span><span class='op'>,</span>&nbsp; <span class='xx'>\</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp;&nbsp; <span class='nam'>frompyfunc</span><span class='op'>,</span> <span class='nam'>isnan</span><span class='op'>,</span> <span class='nam'>cos</span><span class='op'>,</span> <span class='nam'>less_equal</span><span class='op'>,</span> <span class='nam'>sqrt</span><span class='op'>,</span> <span class='nam'>sin</span><span class='op'>,</span> <span class='nam'>mod</span><span class='op'>,</span> <span class='nam'>exp</span><span class='op'>,</span> <span class='nam'>log10</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>from</span> <span class='nam'>numpy</span><span class='op'>.</span><span class='nam'>core</span><span class='op'>.</span><span class='nam'>fromnumeric</span> <span class='key'>import</span> <span class='nam'>ravel</span><span class='op'>,</span> <span class='nam'>nonzero</span><span class='op'>,</span> <span class='nam'>choose</span><span class='op'>,</span> <span class='nam'>sort</span><span class='op'>,</span> <span class='nam'>mean</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>from</span> <span class='nam'>numpy</span><span class='op'>.</span><span class='nam'>core</span><span class='op'>.</span><span class='nam'>numerictypes</span> <span class='key'>import</span> <span class='nam'>typecodes</span><span class='op'>,</span> <span class='nam'>number</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>from</span> <span class='nam'>numpy</span><span class='op'>.</span><span class='nam'>lib</span><span class='op'>.</span><span class='nam'>shape_base</span> <span class='key'>import</span> <span class='nam'>atleast_1d</span><span class='op'>,</span> <span class='nam'>atleast_2d</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>from</span> <span class='nam'>numpy</span><span class='op'>.</span><span class='nam'>lib</span><span class='op'>.</span><span class='nam'>twodim_base</span> <span class='key'>import</span> <span class='nam'>diag</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>from</span> <span class='nam'>_compiled_base</span> <span class='key'>import</span> <span class='nam'>_insert</span><span class='op'>,</span> <span class='nam'>add_docstring</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>from</span> <span class='nam'>_compiled_base</span> <span class='key'>import</span> <span class='nam'>digitize</span><span class='op'>,</span> <span class='nam'>bincount</span><span class='op'>,</span> <span class='nam'>interp</span> <span class='key'>as</span> <span class='nam'>compiled_interp</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>from</span> <span class='nam'>arraysetops</span> <span class='key'>import</span> <span class='nam'>setdiff1d</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>import</span> <span class='nam'>numpy</span> <span class='key'>as</span> <span class='nam'>np</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'>#end Fernando&#39;s utilities</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>linspace</span><span class='op'>(</span><span class='nam'>start</span><span class='op'>,</span> <span class='nam'>stop</span><span class='op'>,</span> <span class='nam'>num</span><span class='op'>=</span><span class='num'>50</span><span class='op'>,</span> <span class='nam'>endpoint</span><span class='op'>=</span><span class='nam'>True</span><span class='op'>,</span> <span class='nam'>retstep</span><span class='op'>=</span><span class='nam'>False</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return evenly spaced numbers over a specified interval.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns `num` evenly spaced samples, calculated over the</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; interval [`start`, `stop` ].</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The endpoint of the interval can optionally be excluded.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; start : {float, int}</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The starting value of the sequence.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; stop : {float, int}</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The end value of the sequence, unless `endpoint` is set to False.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; In that case, the sequence consists of all but the last of ``num + 1``</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; evenly spaced samples, so that `stop` is excluded.&nbsp; Note that the step</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; size changes when `endpoint` is False.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; num : int, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Number of samples to generate. Default is 50.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; endpoint : bool, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; If True, `stop` is the last sample. Otherwise, it is not included.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Default is True.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; retstep : bool, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; If True, return (`samples`, `step`), where `step` is the spacing</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; between samples.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; samples : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; There are `num` equally spaced samples in the closed interval</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; ``[start, stop]`` or the half-open interval ``[start, stop)``</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; (depending on whether `endpoint` is True or False).</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; step : float (only if `retstep` is True)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Size of spacing between samples.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; arange : Similiar to `linspace`, but uses a step size (instead of the</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; number of samples).</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; logspace : Samples uniformly distributed in log space.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.linspace(2.0, 3.0, num=5)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; array([ 2.&nbsp; ,&nbsp; 2.25,&nbsp; 2.5 ,&nbsp; 2.75,&nbsp; 3.&nbsp; ])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.linspace(2.0, 3.0, num=5, endpoint=False)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; array([ 2. ,&nbsp; 2.2,&nbsp; 2.4,&nbsp; 2.6,&nbsp; 2.8])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.linspace(2.0, 3.0, num=5, retstep=True)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; (array([ 2.&nbsp; ,&nbsp; 2.25,&nbsp; 2.5 ,&nbsp; 2.75,&nbsp; 3.&nbsp; ]), 0.25)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Graphical illustration:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; import matplotlib.pyplot as plt</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; N = 8</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; y = np.zeros(N)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; x1 = np.linspace(0, 10, N, endpoint=True)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; x2 = np.linspace(0, 10, N, endpoint=False)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.plot(x1, y, &#39;o&#39;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.plot(x2, y + 0.5, &#39;o&#39;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.ylim([-0.5, 1])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.show()</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>num</span> <span class='op'>=</span> <span class='nam'>int</span><span class='op'>(</span><span class='nam'>num</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>num</span> <span class='op'>&lt;=</span> <span class='num'>0</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>array</span><span class='op'>(</span><span class='op'>[</span><span class='op'>]</span><span class='op'>,</span> <span class='nam'>float</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>endpoint</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>num</span> <span class='op'>==</span> <span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>array</span><span class='op'>(</span><span class='op'>[</span><span class='nam'>float</span><span class='op'>(</span><span class='nam'>start</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>step</span> <span class='op'>=</span> <span class='op'>(</span><span class='nam'>stop</span><span class='op'>-</span><span class='nam'>start</span><span class='op'>)</span><span class='op'>/</span><span class='nam'>float</span><span class='op'>(</span><span class='op'>(</span><span class='nam'>num</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>y</span> <span class='op'>=</span> <span class='nam'>_nx</span><span class='op'>.</span><span class='nam'>arange</span><span class='op'>(</span><span class='num'>0</span><span class='op'>,</span> <span class='nam'>num</span><span class='op'>)</span> <span class='op'>*</span> <span class='nam'>step</span> <span class='op'>+</span> <span class='nam'>start</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>y</span><span class='op'>[</span><span class='op'>-</span><span class='num'>1</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>stop</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>step</span> <span class='op'>=</span> <span class='op'>(</span><span class='nam'>stop</span><span class='op'>-</span><span class='nam'>start</span><span class='op'>)</span><span class='op'>/</span><span class='nam'>float</span><span class='op'>(</span><span class='nam'>num</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>y</span> <span class='op'>=</span> <span class='nam'>_nx</span><span class='op'>.</span><span class='nam'>arange</span><span class='op'>(</span><span class='num'>0</span><span class='op'>,</span> <span class='nam'>num</span><span class='op'>)</span> <span class='op'>*</span> <span class='nam'>step</span> <span class='op'>+</span> <span class='nam'>start</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>retstep</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>y</span><span class='op'>,</span> <span class='nam'>step</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>y</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>logspace</span><span class='op'>(</span><span class='nam'>start</span><span class='op'>,</span><span class='nam'>stop</span><span class='op'>,</span><span class='nam'>num</span><span class='op'>=</span><span class='num'>50</span><span class='op'>,</span><span class='nam'>endpoint</span><span class='op'>=</span><span class='nam'>True</span><span class='op'>,</span><span class='nam'>base</span><span class='op'>=</span><span class='num'>10.0</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return numbers spaced evenly on a log scale.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; In linear space, the sequence starts at ``base ** start``</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; (`base` to the power of `start`) and ends with ``base ** stop``</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; (see `endpoint` below).</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; start : float</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; ``base ** start`` is the starting value of the sequence.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; stop : float</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; ``base ** stop`` is the final value of the sequence, unless `endpoint`</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; is False.&nbsp; In that case, ``num + 1`` values are spaced over the</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; interval in log-space, of which all but the last (a sequence of</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; length ``num``) are returned.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; num : integer, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Number of samples to generate.&nbsp; Default is 50.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; endpoint : boolean, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; If true, `stop` is the last sample. Otherwise, it is not included.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Default is True.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; base : float, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The base of the log space. The step size between the elements in</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; ``ln(samples) / ln(base)`` (or ``log_base(samples)``) is uniform.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Default is 10.0.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; samples : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; `num` samples, equally spaced on a log scale.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; arange : Similiar to linspace, with the step size specified instead of the</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; number of samples. Note that, when used with a float endpoint, the</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; endpoint may or may not be included.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; linspace : Similar to logspace, but with the samples uniformly distributed</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; in linear space, instead of log space.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Logspace is equivalent to the code</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; y = linspace(start, stop, num=num, endpoint=endpoint)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; power(base, y)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.logspace(2.0, 3.0, num=4)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; array([&nbsp; 100.&nbsp; &nbsp; &nbsp; &nbsp; ,&nbsp;&nbsp; 215.443469&nbsp; ,&nbsp;&nbsp; 464.15888336,&nbsp; 1000.&nbsp; &nbsp; &nbsp; &nbsp; ])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.logspace(2.0, 3.0, num=4, endpoint=False)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; array([ 100.&nbsp; &nbsp; &nbsp; &nbsp; ,&nbsp; 177.827941&nbsp; ,&nbsp; 316.22776602,&nbsp; 562.34132519])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.logspace(2.0, 3.0, num=4, base=2.0)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; array([ 4.&nbsp; &nbsp; &nbsp; &nbsp; ,&nbsp; 5.0396842 ,&nbsp; 6.34960421,&nbsp; 8.&nbsp; &nbsp; &nbsp; &nbsp; ])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Graphical illustration:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; import matplotlib.pyplot as plt</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; N = 10</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; x1 = np.logspace(0.1, 1, N, endpoint=True)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; x2 = np.logspace(0.1, 1, N, endpoint=False)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; y = np.zeros(N)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.plot(x1, y, &#39;o&#39;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.plot(x2, y + 0.5, &#39;o&#39;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.ylim([-0.5, 1])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.show()</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>y</span> <span class='op'>=</span> <span class='nam'>linspace</span><span class='op'>(</span><span class='nam'>start</span><span class='op'>,</span><span class='nam'>stop</span><span class='op'>,</span><span class='nam'>num</span><span class='op'>=</span><span class='nam'>num</span><span class='op'>,</span><span class='nam'>endpoint</span><span class='op'>=</span><span class='nam'>endpoint</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>_nx</span><span class='op'>.</span><span class='nam'>power</span><span class='op'>(</span><span class='nam'>base</span><span class='op'>,</span><span class='nam'>y</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>iterable</span><span class='op'>(</span><span class='nam'>y</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>try</span><span class='op'>:</span> <span class='nam'>iter</span><span class='op'>(</span><span class='nam'>y</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>except</span><span class='op'>:</span> <span class='key'>return</span> <span class='num'>0</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='num'>1</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>histogram</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>,</span> <span class='nam'>bins</span><span class='op'>=</span><span class='num'>10</span><span class='op'>,</span> <span class='nam'>range</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>,</span> <span class='nam'>normed</span><span class='op'>=</span><span class='nam'>False</span><span class='op'>,</span> <span class='nam'>weights</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>,</span> <span class='nam'>new</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Compute the histogram of a set of data.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; a : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Input data.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; bins : int or sequence of scalars, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; If `bins` is an int, it defines the number of equal-width</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; bins in the given range (10, by default). If `bins` is a sequence,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; it defines the bin edges, including the rightmost edge, allowing</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; for non-uniform bin widths.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; range : (float, float), optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The lower and upper range of the bins.&nbsp; If not provided, range</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; is simply ``(a.min(), a.max())``.&nbsp; Values outside the range are</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; ignored. Note that with `new` set to False, values below</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; the range are ignored, while those above the range are tallied</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; in the rightmost bin.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; normed : bool, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; If False, the result will contain the number of samples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; in each bin.&nbsp; If True, the result is the value of the</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; probability *density* function at the bin, normalized such that</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; the *integral* over the range is 1. Note that the sum of the</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; histogram values will often not be equal to 1; it is not a</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; probability *mass* function.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; weights : array_like, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; An array of weights, of the same shape as `a`.&nbsp; Each value in `a`</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; only contributes its associated weight towards the bin count</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; (instead of 1).&nbsp; If `normed` is True, the weights are normalized,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; so that the integral of the density over the range remains 1.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The `weights` keyword is only available with `new` set to True.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; new : {None, True, False}, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Whether to use the new semantics for histogram:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * None : the new behaviour is used, and a warning is printed,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * True : the new behaviour is used and no warning is printed,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; * False : the old behaviour is used and a message is printed</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; warning about future deprecation.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; hist : array</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The values of the histogram. See `normed` and `weights` for a</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; description of the possible semantics.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; bin_edges : array of dtype float</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Return the bin edges ``(length(hist)+1)``.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; With ``new=False``, return the left bin edges (``length(hist)``).</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; histogramdd</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; All but the last (righthand-most) bin is half-open.&nbsp; In other words, if</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; `bins` is::</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; [1, 2, 3, 4]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; then the first bin is ``[1, 2)`` (including 1, but excluding 2) and the</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; second ``[2, 3)``.&nbsp; The last bin, however, is ``[3, 4]``, which *includes*</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 4.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.histogram([1,2,1], bins=[0,1,2,3], new=True)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; (array([0, 2, 1]), array([0, 1, 2, 3]))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># Old behavior</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>new</span> <span class='op'>==</span> <span class='nam'>False</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>warnings</span><span class='op'>.</span><span class='nam'>warn</span><span class='op'>(</span><span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The original semantics of histogram is scheduled to be</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; deprecated in NumPy 1.3. The new semantics fixes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; long-standing issues with outliers handling. The main</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; changes concern</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; 1. the definition of the bin edges,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; now including the rightmost edge, and</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; 2. the handling of upper outliers,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; now ignored rather than tallied in the rightmost bin.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Please read the docstring for more information.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &quot;&quot;&quot;</span><span class='op'>,</span> <span class='nam'>Warning</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>a</span> <span class='op'>=</span> <span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>ravel</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='op'>(</span><span class='nam'>range</span> <span class='key'>is</span> <span class='key'>not</span> <span class='nam'>None</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>mn</span><span class='op'>,</span> <span class='nam'>mx</span> <span class='op'>=</span> <span class='nam'>range</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='op'>(</span><span class='nam'>mn</span> <span class='op'>&gt;</span> <span class='nam'>mx</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>AttributeError</span><span class='op'>,</span> <span class='xx'>\</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='str'>&#39;max must be larger than min in range parameter.&#39;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='key'>not</span> <span class='nam'>iterable</span><span class='op'>(</span><span class='nam'>bins</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>range</span> <span class='key'>is</span> <span class='nam'>None</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>range</span> <span class='op'>=</span> <span class='op'>(</span><span class='nam'>a</span><span class='op'>.</span><span class='nam'>min</span><span class='op'>(</span><span class='op'>)</span><span class='op'>,</span> <span class='nam'>a</span><span class='op'>.</span><span class='nam'>max</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>mn</span><span class='op'>,</span> <span class='nam'>mx</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>mi</span><span class='op'>+</span><span class='num'>0.0</span> <span class='key'>for</span> <span class='nam'>mi</span> <span class='key'>in</span> <span class='nam'>range</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>mn</span> <span class='op'>==</span> <span class='nam'>mx</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>mn</span> <span class='op'>-=</span> <span class='num'>0.5</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>mx</span> <span class='op'>+=</span> <span class='num'>0.5</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>bins</span> <span class='op'>=</span> <span class='nam'>linspace</span><span class='op'>(</span><span class='nam'>mn</span><span class='op'>,</span> <span class='nam'>mx</span><span class='op'>,</span> <span class='nam'>bins</span><span class='op'>,</span> <span class='nam'>endpoint</span><span class='op'>=</span><span class='nam'>False</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>normed</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>ValueError</span><span class='op'>,</span> <span class='str'>&#39;Use new=True to pass bin edges explicitly.&#39;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>ValueError</span><span class='op'>,</span> <span class='str'>&#39;Use new=True to pass bin edges explicitly.&#39;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>bins</span> <span class='op'>=</span> <span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>bins</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='op'>(</span><span class='nam'>np</span><span class='op'>.</span><span class='nam'>diff</span><span class='op'>(</span><span class='nam'>bins</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='num'>0</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>any</span><span class='op'>(</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>AttributeError</span><span class='op'>,</span> <span class='str'>&#39;bins must increase monotonically.&#39;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>weights</span> <span class='key'>is</span> <span class='key'>not</span> <span class='nam'>None</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>ValueError</span><span class='op'>,</span> <span class='str'>&#39;weights are only available with new=True.&#39;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># best block size probably depends on processor cache size</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>block</span> <span class='op'>=</span> <span class='num'>65536</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>n</span> <span class='op'>=</span> <span class='nam'>sort</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>[</span><span class='op'>:</span><span class='nam'>block</span><span class='op'>]</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>searchsorted</span><span class='op'>(</span><span class='nam'>bins</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>i</span> <span class='key'>in</span> <span class='nam'>xrange</span><span class='op'>(</span><span class='nam'>block</span><span class='op'>,</span> <span class='nam'>a</span><span class='op'>.</span><span class='nam'>size</span><span class='op'>,</span> <span class='nam'>block</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>n</span> <span class='op'>+=</span> <span class='nam'>sort</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>:</span><span class='nam'>i</span><span class='op'>+</span><span class='nam'>block</span><span class='op'>]</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>searchsorted</span><span class='op'>(</span><span class='nam'>bins</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>n</span> <span class='op'>=</span> <span class='nam'>concatenate</span><span class='op'>(</span><span class='op'>[</span><span class='nam'>n</span><span class='op'>,</span> <span class='op'>[</span><span class='nam'>len</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>)</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>n</span> <span class='op'>=</span> <span class='nam'>n</span><span class='op'>[</span><span class='num'>1</span><span class='op'>:</span><span class='op'>]</span><span class='op'>-</span><span class='nam'>n</span><span class='op'>[</span><span class='op'>:</span><span class='op'>-</span><span class='num'>1</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>normed</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>db</span> <span class='op'>=</span> <span class='nam'>bins</span><span class='op'>[</span><span class='num'>1</span><span class='op'>]</span> <span class='op'>-</span> <span class='nam'>bins</span><span class='op'>[</span><span class='num'>0</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='num'>1.0</span><span class='op'>/</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>.</span><span class='nam'>size</span><span class='op'>*</span><span class='nam'>db</span><span class='op'>)</span> <span class='op'>*</span> <span class='nam'>n</span><span class='op'>,</span> <span class='nam'>bins</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>n</span><span class='op'>,</span> <span class='nam'>bins</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># New behavior</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>elif</span> <span class='nam'>new</span> <span class='key'>in</span> <span class='op'>[</span><span class='nam'>True</span><span class='op'>,</span> <span class='nam'>None</span><span class='op'>]</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>new</span> <span class='key'>is</span> <span class='nam'>None</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>warnings</span><span class='op'>.</span><span class='nam'>warn</span><span class='op'>(</span><span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The semantics of histogram has been modified in</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the current release to fix long-standing issues with</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; outliers handling. The main changes concern</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1. the definition of the bin edges,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; now including the rightmost edge, and</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2. the handling of upper outliers, now ignored rather</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; than tallied in the rightmost bin.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The previous behaviour is still accessible using</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; `new=False`, but is scheduled to be deprecated in the</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; next release (1.3).</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *This warning will not printed in the 1.3 release.*</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Use `new=True` to bypass this warning.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Please read the docstring for more information.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;&quot;&quot;</span><span class='op'>,</span> <span class='nam'>Warning</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>a</span> <span class='op'>=</span> <span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>weights</span> <span class='key'>is</span> <span class='key'>not</span> <span class='nam'>None</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>weights</span> <span class='op'>=</span> <span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>weights</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>any</span><span class='op'>(</span><span class='nam'>weights</span><span class='op'>.</span><span class='nam'>shape</span> <span class='op'>!=</span> <span class='nam'>a</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>ValueError</span><span class='op'>,</span> <span class='str'>&#39;weights should have the same shape as a.&#39;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>weights</span> <span class='op'>=</span> <span class='nam'>weights</span><span class='op'>.</span><span class='nam'>ravel</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>a</span> <span class='op'>=</span>&nbsp; <span class='nam'>a</span><span class='op'>.</span><span class='nam'>ravel</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='op'>(</span><span class='nam'>range</span> <span class='key'>is</span> <span class='key'>not</span> <span class='nam'>None</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>mn</span><span class='op'>,</span> <span class='nam'>mx</span> <span class='op'>=</span> <span class='nam'>range</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='op'>(</span><span class='nam'>mn</span> <span class='op'>&gt;</span> <span class='nam'>mx</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>AttributeError</span><span class='op'>,</span> <span class='xx'>\</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='str'>&#39;max must be larger than min in range parameter.&#39;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='key'>not</span> <span class='nam'>iterable</span><span class='op'>(</span><span class='nam'>bins</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>range</span> <span class='key'>is</span> <span class='nam'>None</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>range</span> <span class='op'>=</span> <span class='op'>(</span><span class='nam'>a</span><span class='op'>.</span><span class='nam'>min</span><span class='op'>(</span><span class='op'>)</span><span class='op'>,</span> <span class='nam'>a</span><span class='op'>.</span><span class='nam'>max</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>mn</span><span class='op'>,</span> <span class='nam'>mx</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>mi</span><span class='op'>+</span><span class='num'>0.0</span> <span class='key'>for</span> <span class='nam'>mi</span> <span class='key'>in</span> <span class='nam'>range</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>mn</span> <span class='op'>==</span> <span class='nam'>mx</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>mn</span> <span class='op'>-=</span> <span class='num'>0.5</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>mx</span> <span class='op'>+=</span> <span class='num'>0.5</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>bins</span> <span class='op'>=</span> <span class='nam'>linspace</span><span class='op'>(</span><span class='nam'>mn</span><span class='op'>,</span> <span class='nam'>mx</span><span class='op'>,</span> <span class='nam'>bins</span><span class='op'>+</span><span class='num'>1</span><span class='op'>,</span> <span class='nam'>endpoint</span><span class='op'>=</span><span class='nam'>True</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>bins</span> <span class='op'>=</span> <span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>bins</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='op'>(</span><span class='nam'>np</span><span class='op'>.</span><span class='nam'>diff</span><span class='op'>(</span><span class='nam'>bins</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='num'>0</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>any</span><span class='op'>(</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>AttributeError</span><span class='op'>,</span> <span class='str'>&#39;bins must increase monotonically.&#39;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># Histogram is an integer or a float array depending on the weights.</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>weights</span> <span class='key'>is</span> <span class='nam'>None</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>ntype</span> <span class='op'>=</span> <span class='nam'>int</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>ntype</span> <span class='op'>=</span> <span class='nam'>weights</span><span class='op'>.</span><span class='nam'>dtype</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>n</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>zeros</span><span class='op'>(</span><span class='nam'>bins</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>,</span> <span class='nam'>ntype</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>block</span> <span class='op'>=</span> <span class='num'>65536</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>weights</span> <span class='key'>is</span> <span class='nam'>None</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>i</span> <span class='key'>in</span> <span class='nam'>arange</span><span class='op'>(</span><span class='num'>0</span><span class='op'>,</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>)</span><span class='op'>,</span> <span class='nam'>block</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>sa</span> <span class='op'>=</span> <span class='nam'>sort</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>:</span><span class='nam'>i</span><span class='op'>+</span><span class='nam'>block</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>n</span> <span class='op'>+=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>r_</span><span class='op'>[</span><span class='nam'>sa</span><span class='op'>.</span><span class='nam'>searchsorted</span><span class='op'>(</span><span class='nam'>bins</span><span class='op'>[</span><span class='op'>:</span><span class='op'>-</span><span class='num'>1</span><span class='op'>]</span><span class='op'>,</span> <span class='str'>&#39;left&#39;</span><span class='op'>)</span><span class='op'>,</span> <span class='xx'>\</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>sa</span><span class='op'>.</span><span class='nam'>searchsorted</span><span class='op'>(</span><span class='nam'>bins</span><span class='op'>[</span><span class='op'>-</span><span class='num'>1</span><span class='op'>]</span><span class='op'>,</span> <span class='str'>&#39;right&#39;</span><span class='op'>)</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>zero</span> <span class='op'>=</span> <span class='nam'>array</span><span class='op'>(</span><span class='num'>0</span><span class='op'>,</span> <span class='nam'>dtype</span><span class='op'>=</span><span class='nam'>ntype</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>i</span> <span class='key'>in</span> <span class='nam'>arange</span><span class='op'>(</span><span class='num'>0</span><span class='op'>,</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>)</span><span class='op'>,</span> <span class='nam'>block</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>tmp_a</span> <span class='op'>=</span> <span class='nam'>a</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>:</span><span class='nam'>i</span><span class='op'>+</span><span class='nam'>block</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>tmp_w</span> <span class='op'>=</span> <span class='nam'>weights</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>:</span><span class='nam'>i</span><span class='op'>+</span><span class='nam'>block</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>sorting_index</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>argsort</span><span class='op'>(</span><span class='nam'>tmp_a</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>sa</span> <span class='op'>=</span> <span class='nam'>tmp_a</span><span class='op'>[</span><span class='nam'>sorting_index</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>sw</span> <span class='op'>=</span> <span class='nam'>tmp_w</span><span class='op'>[</span><span class='nam'>sorting_index</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>cw</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>concatenate</span><span class='op'>(</span><span class='op'>(</span><span class='op'>[</span><span class='nam'>zero</span><span class='op'>,</span><span class='op'>]</span><span class='op'>,</span> <span class='nam'>sw</span><span class='op'>.</span><span class='nam'>cumsum</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>bin_index</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>r_</span><span class='op'>[</span><span class='nam'>sa</span><span class='op'>.</span><span class='nam'>searchsorted</span><span class='op'>(</span><span class='nam'>bins</span><span class='op'>[</span><span class='op'>:</span><span class='op'>-</span><span class='num'>1</span><span class='op'>]</span><span class='op'>,</span> <span class='str'>&#39;left&#39;</span><span class='op'>)</span><span class='op'>,</span> <span class='xx'>\</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>sa</span><span class='op'>.</span><span class='nam'>searchsorted</span><span class='op'>(</span><span class='nam'>bins</span><span class='op'>[</span><span class='op'>-</span><span class='num'>1</span><span class='op'>]</span><span class='op'>,</span> <span class='str'>&#39;right&#39;</span><span class='op'>)</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>n</span> <span class='op'>+=</span> <span class='nam'>cw</span><span class='op'>[</span><span class='nam'>bin_index</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>n</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>diff</span><span class='op'>(</span><span class='nam'>n</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>normed</span> <span class='key'>is</span> <span class='nam'>False</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>n</span><span class='op'>,</span> <span class='nam'>bins</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>elif</span> <span class='nam'>normed</span> <span class='key'>is</span> <span class='nam'>True</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>db</span> <span class='op'>=</span> <span class='nam'>array</span><span class='op'>(</span><span class='nam'>np</span><span class='op'>.</span><span class='nam'>diff</span><span class='op'>(</span><span class='nam'>bins</span><span class='op'>)</span><span class='op'>,</span> <span class='nam'>float</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>n</span><span class='op'>/</span><span class='op'>(</span><span class='nam'>n</span><span class='op'>*</span><span class='nam'>db</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>sum</span><span class='op'>(</span><span class='op'>)</span><span class='op'>,</span> <span class='nam'>bins</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>histogramdd</span><span class='op'>(</span><span class='nam'>sample</span><span class='op'>,</span> <span class='nam'>bins</span><span class='op'>=</span><span class='num'>10</span><span class='op'>,</span> <span class='nam'>range</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>,</span> <span class='nam'>normed</span><span class='op'>=</span><span class='nam'>False</span><span class='op'>,</span> <span class='nam'>weights</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Compute the multidimensional histogram of some data.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; sample : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Data to histogram passed as a sequence of D arrays of length N, or</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; as an (N,D) array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; bins : sequence or int, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The bin specification:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; * A sequence of arrays describing the bin edges along each dimension.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; * The number of bins for each dimension (nx, ny, ... =bins)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; * The number of bins for all dimensions (nx=ny=...=bins).</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; range : sequence, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; A sequence of lower and upper bin edges to be used if the edges are</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; not given explicitely in `bins`. Defaults to the minimum and maximum</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; values along each dimension.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; normed : boolean, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; If False, returns the number of samples in each bin. If True, returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; the bin density, ie, the bin count divided by the bin hypervolume.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; weights : array_like (N,), optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; An array of values `w_i` weighing each sample `(x_i, y_i, z_i, ...)`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Weights are normalized to 1 if normed is True. If normed is False, the</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; values of the returned histogram are equal to the sum of the weights</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; belonging to the samples falling into each bin.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; H : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The multidimensional histogram of sample x. See normed and weights for</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; the different possible semantics.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; edges : list</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; A list of D arrays describing the bin edges for each dimension.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; histogram: 1D histogram</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; histogram2d: 2D histogram</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; r = np.random.randn(100,3)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; H, edges = np.histogramdd(r, bins = (5, 8, 4))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; H.shape, edges[0].size, edges[1].size, edges[2].size</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ((5,8,4), 6, 9, 5)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>try</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># Sample is an ND-array.</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>N</span><span class='op'>,</span> <span class='nam'>D</span> <span class='op'>=</span> <span class='nam'>sample</span><span class='op'>.</span><span class='nam'>shape</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>except</span> <span class='op'>(</span><span class='nam'>AttributeError</span><span class='op'>,</span> <span class='nam'>ValueError</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># Sample is a sequence of 1D arrays.</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>sample</span> <span class='op'>=</span> <span class='nam'>atleast_2d</span><span class='op'>(</span><span class='nam'>sample</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>T</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>N</span><span class='op'>,</span> <span class='nam'>D</span> <span class='op'>=</span> <span class='nam'>sample</span><span class='op'>.</span><span class='nam'>shape</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>nbin</span> <span class='op'>=</span> <span class='nam'>empty</span><span class='op'>(</span><span class='nam'>D</span><span class='op'>,</span> <span class='nam'>int</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>edges</span> <span class='op'>=</span> <span class='nam'>D</span><span class='op'>*</span><span class='op'>[</span><span class='nam'>None</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>dedges</span> <span class='op'>=</span> <span class='nam'>D</span><span class='op'>*</span><span class='op'>[</span><span class='nam'>None</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>weights</span> <span class='key'>is</span> <span class='key'>not</span> <span class='nam'>None</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>weights</span> <span class='op'>=</span> <span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>weights</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>try</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>M</span> <span class='op'>=</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>bins</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>M</span> <span class='op'>!=</span> <span class='nam'>D</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>AttributeError</span><span class='op'>,</span> <span class='str'>&#39;The dimension of bins must be equal &#39;</span> <span class='xx'>\</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='str'>&#39;to the dimension of the sample x.&#39;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>except</span> <span class='nam'>TypeError</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>bins</span> <span class='op'>=</span> <span class='nam'>D</span><span class='op'>*</span><span class='op'>[</span><span class='nam'>bins</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># Select range for each dimension</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># Used only if number of bins is given.</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>range</span> <span class='key'>is</span> <span class='nam'>None</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>smin</span> <span class='op'>=</span> <span class='nam'>atleast_1d</span><span class='op'>(</span><span class='nam'>array</span><span class='op'>(</span><span class='nam'>sample</span><span class='op'>.</span><span class='nam'>min</span><span class='op'>(</span><span class='num'>0</span><span class='op'>)</span><span class='op'>,</span> <span class='nam'>float</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>smax</span> <span class='op'>=</span> <span class='nam'>atleast_1d</span><span class='op'>(</span><span class='nam'>array</span><span class='op'>(</span><span class='nam'>sample</span><span class='op'>.</span><span class='nam'>max</span><span class='op'>(</span><span class='num'>0</span><span class='op'>)</span><span class='op'>,</span> <span class='nam'>float</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>smin</span> <span class='op'>=</span> <span class='nam'>zeros</span><span class='op'>(</span><span class='nam'>D</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>smax</span> <span class='op'>=</span> <span class='nam'>zeros</span><span class='op'>(</span><span class='nam'>D</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>i</span> <span class='key'>in</span> <span class='nam'>arange</span><span class='op'>(</span><span class='nam'>D</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>smin</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='op'>,</span> <span class='nam'>smax</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>range</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># Make sure the bins have a finite width.</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>i</span> <span class='key'>in</span> <span class='nam'>arange</span><span class='op'>(</span><span class='nam'>len</span><span class='op'>(</span><span class='nam'>smin</span><span class='op'>)</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>smin</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span> <span class='op'>==</span> <span class='nam'>smax</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>smin</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>smin</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span> <span class='op'>-</span> <span class='num'>.5</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>smax</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>smax</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span> <span class='op'>+</span> <span class='num'>.5</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># Create edge arrays</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>i</span> <span class='key'>in</span> <span class='nam'>arange</span><span class='op'>(</span><span class='nam'>D</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>isscalar</span><span class='op'>(</span><span class='nam'>bins</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>nbin</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>bins</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span> <span class='op'>+</span> <span class='num'>2</span> <span class='com'># +2 for outlier bins</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>edges</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>linspace</span><span class='op'>(</span><span class='nam'>smin</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='op'>,</span> <span class='nam'>smax</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='op'>,</span> <span class='nam'>nbin</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>edges</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>bins</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='op'>,</span> <span class='nam'>float</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>nbin</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>edges</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='op'>)</span><span class='op'>+</span><span class='num'>1</span>&nbsp; <span class='com'># +1 for outlier bins</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>dedges</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>diff</span><span class='op'>(</span><span class='nam'>edges</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>nbin</span> <span class='op'>=</span>&nbsp; <span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>nbin</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># Compute the bin number each sample falls into.</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>Ncount</span> <span class='op'>=</span> <span class='op'>{</span><span class='op'>}</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>i</span> <span class='key'>in</span> <span class='nam'>arange</span><span class='op'>(</span><span class='nam'>D</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>Ncount</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>digitize</span><span class='op'>(</span><span class='nam'>sample</span><span class='op'>[</span><span class='op'>:</span><span class='op'>,</span><span class='nam'>i</span><span class='op'>]</span><span class='op'>,</span> <span class='nam'>edges</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># Using digitize, values that fall on an edge are put in the right bin.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># For the rightmost bin, we want values equal to the right</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># edge to be counted in the last bin, and not as an outlier.</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>outliers</span> <span class='op'>=</span> <span class='nam'>zeros</span><span class='op'>(</span><span class='nam'>N</span><span class='op'>,</span> <span class='nam'>int</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>i</span> <span class='key'>in</span> <span class='nam'>arange</span><span class='op'>(</span><span class='nam'>D</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># Rounding precision</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>decimal</span> <span class='op'>=</span> <span class='nam'>int</span><span class='op'>(</span><span class='op'>-</span><span class='nam'>log10</span><span class='op'>(</span><span class='nam'>dedges</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='op'>.</span><span class='nam'>min</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span><span class='num'>6</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># Find which points are on the rightmost edge.</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>on_edge</span> <span class='op'>=</span> <span class='nam'>where</span><span class='op'>(</span><span class='nam'>around</span><span class='op'>(</span><span class='nam'>sample</span><span class='op'>[</span><span class='op'>:</span><span class='op'>,</span><span class='nam'>i</span><span class='op'>]</span><span class='op'>,</span> <span class='nam'>decimal</span><span class='op'>)</span> <span class='op'>==</span> <span class='nam'>around</span><span class='op'>(</span><span class='nam'>edges</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='op'>[</span><span class='op'>-</span><span class='num'>1</span><span class='op'>]</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class='nam'>decimal</span><span class='op'>)</span><span class='op'>)</span><span class='op'>[</span><span class='num'>0</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># Shift these points one bin to the left.</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>Ncount</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='op'>[</span><span class='nam'>on_edge</span><span class='op'>]</span> <span class='op'>-=</span> <span class='num'>1</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># Flattened histogram matrix (1D)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>hist</span> <span class='op'>=</span> <span class='nam'>zeros</span><span class='op'>(</span><span class='nam'>nbin</span><span class='op'>.</span><span class='nam'>prod</span><span class='op'>(</span><span class='op'>)</span><span class='op'>,</span> <span class='nam'>float</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># Compute the sample indices in the flattened histogram matrix.</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>ni</span> <span class='op'>=</span> <span class='nam'>nbin</span><span class='op'>.</span><span class='nam'>argsort</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>shape</span> <span class='op'>=</span> <span class='op'>[</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>xy</span> <span class='op'>=</span> <span class='nam'>zeros</span><span class='op'>(</span><span class='nam'>N</span><span class='op'>,</span> <span class='nam'>int</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>i</span> <span class='key'>in</span> <span class='nam'>arange</span><span class='op'>(</span><span class='num'>0</span><span class='op'>,</span> <span class='nam'>D</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>xy</span> <span class='op'>+=</span> <span class='nam'>Ncount</span><span class='op'>[</span><span class='nam'>ni</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>*</span> <span class='nam'>nbin</span><span class='op'>[</span><span class='nam'>ni</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>+</span><span class='num'>1</span><span class='op'>:</span><span class='op'>]</span><span class='op'>]</span><span class='op'>.</span><span class='nam'>prod</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>xy</span> <span class='op'>+=</span> <span class='nam'>Ncount</span><span class='op'>[</span><span class='nam'>ni</span><span class='op'>[</span><span class='op'>-</span><span class='num'>1</span><span class='op'>]</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># Compute the number of repetitions in xy and assign it to the</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># flattened histmat.</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>xy</span><span class='op'>)</span> <span class='op'>==</span> <span class='num'>0</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>zeros</span><span class='op'>(</span><span class='nam'>nbin</span><span class='op'>-</span><span class='num'>2</span><span class='op'>,</span> <span class='nam'>int</span><span class='op'>)</span><span class='op'>,</span> <span class='nam'>edges</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>flatcount</span> <span class='op'>=</span> <span class='nam'>bincount</span><span class='op'>(</span><span class='nam'>xy</span><span class='op'>,</span> <span class='nam'>weights</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>a</span> <span class='op'>=</span> <span class='nam'>arange</span><span class='op'>(</span><span class='nam'>len</span><span class='op'>(</span><span class='nam'>flatcount</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>hist</span><span class='op'>[</span><span class='nam'>a</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>flatcount</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># Shape into a proper matrix</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>hist</span> <span class='op'>=</span> <span class='nam'>hist</span><span class='op'>.</span><span class='nam'>reshape</span><span class='op'>(</span><span class='nam'>sort</span><span class='op'>(</span><span class='nam'>nbin</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>i</span> <span class='key'>in</span> <span class='nam'>arange</span><span class='op'>(</span><span class='nam'>nbin</span><span class='op'>.</span><span class='nam'>size</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>j</span> <span class='op'>=</span> <span class='nam'>ni</span><span class='op'>.</span><span class='nam'>argsort</span><span class='op'>(</span><span class='op'>)</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>hist</span> <span class='op'>=</span> <span class='nam'>hist</span><span class='op'>.</span><span class='nam'>swapaxes</span><span class='op'>(</span><span class='nam'>i</span><span class='op'>,</span><span class='nam'>j</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>ni</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='op'>,</span><span class='nam'>ni</span><span class='op'>[</span><span class='nam'>j</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>ni</span><span class='op'>[</span><span class='nam'>j</span><span class='op'>]</span><span class='op'>,</span><span class='nam'>ni</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># Remove outliers (indices 0 and -1 for each dimension).</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>core</span> <span class='op'>=</span> <span class='nam'>D</span><span class='op'>*</span><span class='op'>[</span><span class='nam'>slice</span><span class='op'>(</span><span class='num'>1</span><span class='op'>,</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>hist</span> <span class='op'>=</span> <span class='nam'>hist</span><span class='op'>[</span><span class='nam'>core</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># Normalize if normed is True</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>normed</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>s</span> <span class='op'>=</span> <span class='nam'>hist</span><span class='op'>.</span><span class='nam'>sum</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>i</span> <span class='key'>in</span> <span class='nam'>arange</span><span class='op'>(</span><span class='nam'>D</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>shape</span> <span class='op'>=</span> <span class='nam'>ones</span><span class='op'>(</span><span class='nam'>D</span><span class='op'>,</span> <span class='nam'>int</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>shape</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>nbin</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='op'>-</span><span class='num'>2</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>hist</span> <span class='op'>=</span> <span class='nam'>hist</span> <span class='op'>/</span> <span class='nam'>dedges</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='op'>.</span><span class='nam'>reshape</span><span class='op'>(</span><span class='nam'>shape</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>hist</span> <span class='op'>/=</span> <span class='nam'>s</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='op'>(</span><span class='nam'>hist</span><span class='op'>.</span><span class='nam'>shape</span> <span class='op'>!=</span> <span class='nam'>nbin</span><span class='op'>-</span><span class='num'>2</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>any</span><span class='op'>(</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='str'>&#39;Internal Shape Error&#39;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>hist</span><span class='op'>,</span> <span class='nam'>edges</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>average</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>,</span> <span class='nam'>weights</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>,</span> <span class='nam'>returned</span><span class='op'>=</span><span class='nam'>False</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return the weighted average of array over the specified axis.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; a : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Data to be averaged.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; axis : int, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Axis along which to average `a`. If `None`, averaging is done over the</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; entire array irrespective of its shape.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; weights : array_like, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The importance that each datum has in the computation of the average.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The weights array can either be 1-D (in which case its length must be</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; the size of `a` along the given axis) or of the same shape as `a`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; If `weights=None`, then all data in `a` are assumed to have a</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; weight equal to one.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; returned : bool, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Default is `False`. If `True`, the tuple (`average`, `sum_of_weights`)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; is returned, otherwise only the average is returned.&nbsp; Note that</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; if `weights=None`, `sum_of_weights` is equivalent to the number of</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; elements over which the average is taken.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; average, [sum_of_weights] : {array_type, double}</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Return the average along the specified axis. When returned is `True`,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; return a tuple with the average as the first element and the sum</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; of the weights as the second element. The return type is `Float`</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; if `a` is of integer type, otherwise it is of the same type as `a`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; `sum_of_weights` is of the same type as `average`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Raises</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ZeroDivisionError</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; When all weights along axis are zero. See `numpy.ma.average` for a</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; version robust to this type of error.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; TypeError</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; When the length of 1D `weights` is not the same as the shape of `a`</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; along axis.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ma.average : average for masked arrays</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; data = range(1,5)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; data</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; [1, 2, 3, 4]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.average(data)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 2.5</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.average(range(1,11), weights=range(10,0,-1))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 4.0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='key'>not</span> <span class='nam'>isinstance</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>,</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>matrix</span><span class='op'>)</span> <span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>a</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>weights</span> <span class='key'>is</span> <span class='nam'>None</span> <span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>avg</span> <span class='op'>=</span> <span class='nam'>a</span><span class='op'>.</span><span class='nam'>mean</span><span class='op'>(</span><span class='nam'>axis</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>scl</span> <span class='op'>=</span> <span class='nam'>avg</span><span class='op'>.</span><span class='nam'>dtype</span><span class='op'>.</span><span class='nam'>type</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>.</span><span class='nam'>size</span><span class='op'>/</span><span class='nam'>avg</span><span class='op'>.</span><span class='nam'>size</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span> <span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>a</span> <span class='op'>=</span> <span class='nam'>a</span> <span class='op'>+</span> <span class='num'>0.0</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>wgt</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>array</span><span class='op'>(</span><span class='nam'>weights</span><span class='op'>,</span> <span class='nam'>dtype</span><span class='op'>=</span><span class='nam'>a</span><span class='op'>.</span><span class='nam'>dtype</span><span class='op'>,</span> <span class='nam'>copy</span><span class='op'>=</span><span class='num'>0</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># Sanity checks</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>a</span><span class='op'>.</span><span class='nam'>shape</span> <span class='op'>!=</span> <span class='nam'>wgt</span><span class='op'>.</span><span class='nam'>shape</span> <span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>axis</span> <span class='key'>is</span> <span class='nam'>None</span> <span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>TypeError</span><span class='op'>,</span> <span class='str'>&quot;Axis must be specified when shapes of a and weights differ.&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>wgt</span><span class='op'>.</span><span class='nam'>ndim</span> <span class='op'>!=</span> <span class='num'>1</span> <span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>TypeError</span><span class='op'>,</span> <span class='str'>&quot;1D weights expected when shapes of a and weights differ.&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>wgt</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>[</span><span class='num'>0</span><span class='op'>]</span> <span class='op'>!=</span> <span class='nam'>a</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>ValueError</span><span class='op'>,</span> <span class='str'>&quot;Length of weights not compatible with specified axis.&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># setup wgt to broadcast along axis</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>wgt</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>array</span><span class='op'>(</span><span class='nam'>wgt</span><span class='op'>,</span> <span class='nam'>copy</span><span class='op'>=</span><span class='num'>0</span><span class='op'>,</span> <span class='nam'>ndmin</span><span class='op'>=</span><span class='nam'>a</span><span class='op'>.</span><span class='nam'>ndim</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>swapaxes</span><span class='op'>(</span><span class='op'>-</span><span class='num'>1</span><span class='op'>,</span><span class='nam'>axis</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>scl</span> <span class='op'>=</span> <span class='nam'>wgt</span><span class='op'>.</span><span class='nam'>sum</span><span class='op'>(</span><span class='nam'>axis</span><span class='op'>=</span><span class='nam'>axis</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='op'>(</span><span class='nam'>scl</span> <span class='op'>==</span> <span class='num'>0.0</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>any</span><span class='op'>(</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>ZeroDivisionError</span><span class='op'>,</span> <span class='str'>&quot;Weights sum to zero, can&#39;t be normalized&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>avg</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>multiply</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>,</span><span class='nam'>wgt</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>sum</span><span class='op'>(</span><span class='nam'>axis</span><span class='op'>)</span><span class='op'>/</span><span class='nam'>scl</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>returned</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>scl</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>multiply</span><span class='op'>(</span><span class='nam'>avg</span><span class='op'>,</span><span class='num'>0</span><span class='op'>)</span> <span class='op'>+</span> <span class='nam'>scl</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>avg</span><span class='op'>,</span> <span class='nam'>scl</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>avg</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>asarray_chkfinite</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Convert the input to an array, checking for NaNs or Infs.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; a : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Input data, in any form that can be converted to an array.&nbsp; This</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; includes lists, lists of tuples, tuples, tuples of tuples, tuples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; of lists and ndarrays.&nbsp; Success requires no NaNs or Infs.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; dtype : data-type, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; By default, the data-type is inferred from the input data.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; order : {&#39;C&#39;, &#39;F&#39;}, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Whether to use row-major (&#39;C&#39;) or column-major (&#39;FORTRAN&#39;) memory</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; representation.&nbsp; Defaults to &#39;C&#39;.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Array interpretation of `a`.&nbsp; No copy is performed if the input</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; is already an ndarray.&nbsp; If `a` is a subclass of ndarray, a base</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; class ndarray is returned.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Raises</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ValueError</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Raises ValueError if `a` contains NaN (Not a Number) or Inf (Infinity).</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; asarray : Create and array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; asanyarray : Similar function which passes through subclasses.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ascontiguousarray : Convert input to a contiguous array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; asfarray : Convert input to a floating point ndarray.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; asfortranarray : Convert input to an ndarray with column-major</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; memory order.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; fromiter : Create an array from an iterator.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; fromfunction : Construct an array by executing a function on grid</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; positions.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Convert a list into an array.&nbsp; If all elements are finite</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ``asarray_chkfinite`` is identical to ``asarray``.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; a = [1, 2]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.asarray_chkfinite(a)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([1, 2])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Raises ValueError if array_like contains Nans or Infs.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; a = [1, 2, np.inf]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; try:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ...&nbsp; &nbsp;&nbsp; np.asarray_chkfinite(a)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ... except ValueError:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ...&nbsp; &nbsp;&nbsp; print &#39;ValueError&#39;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ...</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ValueError</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>a</span> <span class='op'>=</span> <span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='op'>(</span><span class='nam'>a</span><span class='op'>.</span><span class='nam'>dtype</span><span class='op'>.</span><span class='nam'>char</span> <span class='key'>in</span> <span class='nam'>typecodes</span><span class='op'>[</span><span class='str'>&#39;AllFloat&#39;</span><span class='op'>]</span><span class='op'>)</span> <span class='xx'>\</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class='key'>and</span> <span class='op'>(</span><span class='nam'>_nx</span><span class='op'>.</span><span class='nam'>isnan</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>any</span><span class='op'>(</span><span class='op'>)</span> <span class='key'>or</span> <span class='nam'>_nx</span><span class='op'>.</span><span class='nam'>isinf</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>any</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>ValueError</span><span class='op'>,</span> <span class='str'>&quot;array must not contain infs or NaNs&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>a</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>piecewise</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>,</span> <span class='nam'>condlist</span><span class='op'>,</span> <span class='nam'>funclist</span><span class='op'>,</span> <span class='op'>*</span><span class='nam'>args</span><span class='op'>,</span> <span class='op'>**</span><span class='nam'>kw</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Evaluate a piecewise-defined function.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Given a set of conditions and corresponding functions, evaluate each</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; function on the input data wherever its condition is true.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; x : (N,) ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The input domain.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; condlist : list of M (N,)-shaped boolean arrays</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Each boolean array corresponds to a function in `funclist`.&nbsp; Wherever</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; `condlist[i]` is True, `funclist[i](x)` is used as the output value.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Each boolean array in `condlist` selects a piece of `x`,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; and should therefore be of the same shape as `x`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The length of `condlist` must correspond to that of `funclist`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; If one extra function is given, i.e. if the length of `funclist` is</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; M+1, then that extra function is the default value, used wherever</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; all conditions are false.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; funclist : list of M or M+1 callables, f(x,*args,**kw), or values</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Each function is evaluated over `x` wherever its corresponding</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; condition is True.&nbsp; It should take an array as input and give an array</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; or a scalar value as output.&nbsp; If, instead of a callable,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; a value is provided then a constant function (``lambda x: value``) is</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; assumed.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; args : tuple, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Any further arguments given to `piecewise` are passed to the functions</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; upon execution, i.e., if called ``piecewise(...,...,1,&#39;a&#39;)``, then</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; each function is called as ``f(x,1,&#39;a&#39;)``.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; kw : dictionary, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Keyword arguments used in calling `piecewise` are passed to the</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; functions upon execution, i.e., if called</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; ``piecewise(...,...,lambda=1)``, then each function is called as</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; ``f(x,lambda=1)``.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The output is the same shape and type as x and is found by</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; calling the functions in `funclist` on the appropriate portions of `x`,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; as defined by the boolean arrays in `condlist`.&nbsp; Portions not covered</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; by any condition have undefined values.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; This is similar to choose or select, except that functions are</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; evaluated on elements of `x` that satisfy the corresponding condition from</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; `condlist`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The result is::</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |--</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |funclist[0](x[condlist[0]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; out = |funclist[1](x[condlist[1]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |...</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |funclist[n2](x[condlist[n2]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |--</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Define the sigma function, which is -1 for ``x &lt; 0`` and +1 for ``x &gt;= 0``.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; x = np.arange(6) - 2.5 # x runs from -2.5 to 2.5 in steps of 1</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.piecewise(x, [x &lt; 0, x &gt;= 0.5], [-1,1])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([-1., -1., -1.,&nbsp; 1.,&nbsp; 1.,&nbsp; 1.])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Define the absolute value, which is ``-x`` for ``x &lt;0`` and ``x`` for</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ``x &gt;= 0``.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.piecewise(x, [x &lt; 0, x &gt;= 0], [lambda x: -x, lambda x: x])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 2.5,&nbsp; 1.5,&nbsp; 0.5,&nbsp; 0.5,&nbsp; 1.5,&nbsp; 2.5])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>x</span> <span class='op'>=</span> <span class='nam'>asanyarray</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>n2</span> <span class='op'>=</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>funclist</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>isscalar</span><span class='op'>(</span><span class='nam'>condlist</span><span class='op'>)</span> <span class='key'>or</span> <span class='xx'>\</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class='key'>not</span> <span class='op'>(</span><span class='nam'>isinstance</span><span class='op'>(</span><span class='nam'>condlist</span><span class='op'>[</span><span class='num'>0</span><span class='op'>]</span><span class='op'>,</span> <span class='nam'>list</span><span class='op'>)</span> <span class='key'>or</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>isinstance</span><span class='op'>(</span><span class='nam'>condlist</span><span class='op'>[</span><span class='num'>0</span><span class='op'>]</span><span class='op'>,</span> <span class='nam'>ndarray</span><span class='op'>)</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>condlist</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>condlist</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>condlist</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>c</span><span class='op'>,</span> <span class='nam'>dtype</span><span class='op'>=</span><span class='nam'>bool</span><span class='op'>)</span> <span class='key'>for</span> <span class='nam'>c</span> <span class='key'>in</span> <span class='nam'>condlist</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>n</span> <span class='op'>=</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>condlist</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>n</span> <span class='op'>==</span> <span class='nam'>n2</span><span class='op'>-</span><span class='num'>1</span><span class='op'>:</span>&nbsp; <span class='com'># compute the &quot;otherwise&quot; condition.</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>totlist</span> <span class='op'>=</span> <span class='nam'>condlist</span><span class='op'>[</span><span class='num'>0</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>k</span> <span class='key'>in</span> <span class='nam'>range</span><span class='op'>(</span><span class='num'>1</span><span class='op'>,</span> <span class='nam'>n</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>totlist</span> <span class='op'>|=</span> <span class='nam'>condlist</span><span class='op'>[</span><span class='nam'>k</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>condlist</span><span class='op'>.</span><span class='nam'>append</span><span class='op'>(</span><span class='op'>~</span><span class='nam'>totlist</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>n</span> <span class='op'>+=</span> <span class='num'>1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='op'>(</span><span class='nam'>n</span> <span class='op'>!=</span> <span class='nam'>n2</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>ValueError</span><span class='op'>,</span> <span class='str'>&quot;function list and condition list &quot;</span> <span class='xx'>\</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='str'>&quot;must be the same&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>zerod</span> <span class='op'>=</span> <span class='nam'>False</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># This is a hack to work around problems with NumPy&#39;s</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'>#&nbsp; handling of 0-d arrays and boolean indexing with</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'>#&nbsp; numpy.bool_ scalars</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>x</span><span class='op'>.</span><span class='nam'>ndim</span> <span class='op'>==</span> <span class='num'>0</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>x</span> <span class='op'>=</span> <span class='nam'>x</span><span class='op'>[</span><span class='nam'>None</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>zerod</span> <span class='op'>=</span> <span class='nam'>True</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>newcondlist</span> <span class='op'>=</span> <span class='op'>[</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>k</span> <span class='key'>in</span> <span class='nam'>range</span><span class='op'>(</span><span class='nam'>n</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>condlist</span><span class='op'>[</span><span class='nam'>k</span><span class='op'>]</span><span class='op'>.</span><span class='nam'>ndim</span> <span class='op'>==</span> <span class='num'>0</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>condition</span> <span class='op'>=</span> <span class='nam'>condlist</span><span class='op'>[</span><span class='nam'>k</span><span class='op'>]</span><span class='op'>[</span><span class='nam'>None</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>condition</span> <span class='op'>=</span> <span class='nam'>condlist</span><span class='op'>[</span><span class='nam'>k</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>newcondlist</span><span class='op'>.</span><span class='nam'>append</span><span class='op'>(</span><span class='nam'>condition</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>condlist</span> <span class='op'>=</span> <span class='nam'>newcondlist</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>y</span> <span class='op'>=</span> <span class='nam'>zeros</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>,</span> <span class='nam'>x</span><span class='op'>.</span><span class='nam'>dtype</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>k</span> <span class='key'>in</span> <span class='nam'>range</span><span class='op'>(</span><span class='nam'>n</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>item</span> <span class='op'>=</span> <span class='nam'>funclist</span><span class='op'>[</span><span class='nam'>k</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='key'>not</span> <span class='nam'>callable</span><span class='op'>(</span><span class='nam'>item</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>y</span><span class='op'>[</span><span class='nam'>condlist</span><span class='op'>[</span><span class='nam'>k</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>item</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>vals</span> <span class='op'>=</span> <span class='nam'>x</span><span class='op'>[</span><span class='nam'>condlist</span><span class='op'>[</span><span class='nam'>k</span><span class='op'>]</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>vals</span><span class='op'>.</span><span class='nam'>size</span> <span class='op'>&gt;</span> <span class='num'>0</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>y</span><span class='op'>[</span><span class='nam'>condlist</span><span class='op'>[</span><span class='nam'>k</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>item</span><span class='op'>(</span><span class='nam'>vals</span><span class='op'>,</span> <span class='op'>*</span><span class='nam'>args</span><span class='op'>,</span> <span class='op'>**</span><span class='nam'>kw</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>zerod</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>y</span> <span class='op'>=</span> <span class='nam'>y</span><span class='op'>.</span><span class='nam'>squeeze</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>y</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>select</span><span class='op'>(</span><span class='nam'>condlist</span><span class='op'>,</span> <span class='nam'>choicelist</span><span class='op'>,</span> <span class='nam'>default</span><span class='op'>=</span><span class='num'>0</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return an array drawn from elements in choicelist, depending on conditions.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; condlist : list of N boolean arrays of length M</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The conditions C_0 through C_(N-1) which determine</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; from which vector the output elements are taken.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; choicelist : list of N arrays of length M</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Th vectors V_0 through V_(N-1), from which the output</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; elements are chosen.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; output : 1-dimensional array of length M</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The output at position m is the m-th element of the first</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vector V_n for which C_n[m] is non-zero.&nbsp; Note that the</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; output depends on the order of conditions, since the</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; first satisfied condition is used.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Equivalent to:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ::</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; output = []</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; for m in range(M):</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; output += [V[m] for V,C in zip(values,cond) if C[m]]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or [default]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; t = np.arange(10)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; s = np.arange(10)*100</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; condlist = [t == 4, t &gt; 5]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; choicelist = [s, t]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.select(condlist, choicelist)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([&nbsp; 0,&nbsp;&nbsp; 0,&nbsp;&nbsp; 0,&nbsp;&nbsp; 0, 400,&nbsp;&nbsp; 0,&nbsp;&nbsp; 6,&nbsp;&nbsp; 7,&nbsp;&nbsp; 8,&nbsp;&nbsp; 9])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>n</span> <span class='op'>=</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>condlist</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>n2</span> <span class='op'>=</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>choicelist</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>n2</span> <span class='op'>!=</span> <span class='nam'>n</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>ValueError</span><span class='op'>,</span> <span class='str'>&quot;list of cases must be same length as list of conditions&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>choicelist</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>default</span><span class='op'>]</span> <span class='op'>+</span> <span class='nam'>choicelist</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>S</span> <span class='op'>=</span> <span class='num'>0</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>pfac</span> <span class='op'>=</span> <span class='num'>1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>k</span> <span class='key'>in</span> <span class='nam'>range</span><span class='op'>(</span><span class='num'>1</span><span class='op'>,</span> <span class='nam'>n</span><span class='op'>+</span><span class='num'>1</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>S</span> <span class='op'>+=</span> <span class='nam'>k</span> <span class='op'>*</span> <span class='nam'>pfac</span> <span class='op'>*</span> <span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>condlist</span><span class='op'>[</span><span class='nam'>k</span><span class='op'>-</span><span class='num'>1</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>k</span> <span class='op'>&lt;</span> <span class='nam'>n</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>pfac</span> <span class='op'>*=</span> <span class='op'>(</span><span class='num'>1</span><span class='op'>-</span><span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>condlist</span><span class='op'>[</span><span class='nam'>k</span><span class='op'>-</span><span class='num'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># handle special case of a 1-element condition but</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'>#&nbsp; a multi-element choice</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>type</span><span class='op'>(</span><span class='nam'>S</span><span class='op'>)</span> <span class='key'>in</span> <span class='nam'>ScalarType</span> <span class='key'>or</span> <span class='nam'>max</span><span class='op'>(</span><span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>S</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>)</span><span class='op'>==</span><span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>pfac</span> <span class='op'>=</span> <span class='nam'>asarray</span><span class='op'>(</span><span class='num'>1</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>k</span> <span class='key'>in</span> <span class='nam'>range</span><span class='op'>(</span><span class='nam'>n2</span><span class='op'>+</span><span class='num'>1</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>pfac</span> <span class='op'>=</span> <span class='nam'>pfac</span> <span class='op'>+</span> <span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>choicelist</span><span class='op'>[</span><span class='nam'>k</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>type</span><span class='op'>(</span><span class='nam'>S</span><span class='op'>)</span> <span class='key'>in</span> <span class='nam'>ScalarType</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>S</span> <span class='op'>=</span> <span class='nam'>S</span><span class='op'>*</span><span class='nam'>ones</span><span class='op'>(</span><span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>pfac</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>,</span> <span class='nam'>type</span><span class='op'>(</span><span class='nam'>S</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>S</span> <span class='op'>=</span> <span class='nam'>S</span><span class='op'>*</span><span class='nam'>ones</span><span class='op'>(</span><span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>pfac</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>,</span> <span class='nam'>S</span><span class='op'>.</span><span class='nam'>dtype</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>choose</span><span class='op'>(</span><span class='nam'>S</span><span class='op'>,</span> <span class='nam'>tuple</span><span class='op'>(</span><span class='nam'>choicelist</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>copy</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return an array copy of the given object.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; a : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Input data.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; arr : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Array interpretation of `a`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; This is equivalent to</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.array(a, copy=True)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Create an array x, with a reference y and a copy z:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; x = np.array([1, 2, 3])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; y = x</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; z = np.copy(x)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Note that, when we modify x, y changes, but not z:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; x[0] = 10</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; x[0] == y[0]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; True</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; x[0] == z[0]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; False</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>array</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>,</span> <span class='nam'>copy</span><span class='op'>=</span><span class='nam'>True</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'># Basic operations</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>gradient</span><span class='op'>(</span><span class='nam'>f</span><span class='op'>,</span> <span class='op'>*</span><span class='nam'>varargs</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return the gradient of an N-dimensional array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The gradient is computed using central differences in the interior</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; and first differences at the boundaries. The returned gradient hence has</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; the same shape as the input array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; f : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; An N-dimensional array containing samples of a scalar function.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; `*varargs` : scalars</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; 0, 1, or N scalars specifying the sample distances in each direction,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; that is: `dx`, `dy`, `dz`, ... The default distance is 1.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; g : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; N arrays of the same shape as `f` giving the derivative of `f` with</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; respect to each dimension.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.gradient(np.array([[1,1],[3,4]]))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; [array([[ 2.,&nbsp; 3.],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [ 2.,&nbsp; 3.]]),</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp;&nbsp; array([[ 0.,&nbsp; 0.],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [ 1.,&nbsp; 1.]])]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>N</span> <span class='op'>=</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>f</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>)</span>&nbsp; <span class='com'># number of dimensions</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>n</span> <span class='op'>=</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>varargs</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>n</span> <span class='op'>==</span> <span class='num'>0</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>dx</span> <span class='op'>=</span> <span class='op'>[</span><span class='num'>1.0</span><span class='op'>]</span><span class='op'>*</span><span class='nam'>N</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>elif</span> <span class='nam'>n</span> <span class='op'>==</span> <span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>dx</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>varargs</span><span class='op'>[</span><span class='num'>0</span><span class='op'>]</span><span class='op'>]</span><span class='op'>*</span><span class='nam'>N</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>elif</span> <span class='nam'>n</span> <span class='op'>==</span> <span class='nam'>N</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>dx</span> <span class='op'>=</span> <span class='nam'>list</span><span class='op'>(</span><span class='nam'>varargs</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>SyntaxError</span><span class='op'>,</span> <span class='str'>&quot;invalid number of arguments&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># use central differences on interior and first differences on endpoints</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>outvals</span> <span class='op'>=</span> <span class='op'>[</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># create slice objects --- initially all are [:, :, ..., :]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>slice1</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>]</span><span class='op'>*</span><span class='nam'>N</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>slice2</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>]</span><span class='op'>*</span><span class='nam'>N</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>slice3</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>]</span><span class='op'>*</span><span class='nam'>N</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>otype</span> <span class='op'>=</span> <span class='nam'>f</span><span class='op'>.</span><span class='nam'>dtype</span><span class='op'>.</span><span class='nam'>char</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>otype</span> <span class='key'>not</span> <span class='key'>in</span> <span class='op'>[</span><span class='str'>&#39;f&#39;</span><span class='op'>,</span> <span class='str'>&#39;d&#39;</span><span class='op'>,</span> <span class='str'>&#39;F&#39;</span><span class='op'>,</span> <span class='str'>&#39;D&#39;</span><span class='op'>]</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>otype</span> <span class='op'>=</span> <span class='str'>&#39;d&#39;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>axis</span> <span class='key'>in</span> <span class='nam'>range</span><span class='op'>(</span><span class='nam'>N</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># select out appropriate parts for this dimension</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>out</span> <span class='op'>=</span> <span class='nam'>zeros</span><span class='op'>(</span><span class='nam'>f</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>,</span> <span class='nam'>f</span><span class='op'>.</span><span class='nam'>dtype</span><span class='op'>.</span><span class='nam'>char</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slice1</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='num'>1</span><span class='op'>,</span> <span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slice2</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='num'>2</span><span class='op'>,</span> <span class='nam'>None</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slice3</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>,</span> <span class='op'>-</span><span class='num'>2</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># 1D equivalent -- out[1:-1] = (f[2:] - f[:-2])/2.0</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>out</span><span class='op'>[</span><span class='nam'>slice1</span><span class='op'>]</span> <span class='op'>=</span> <span class='op'>(</span><span class='nam'>f</span><span class='op'>[</span><span class='nam'>slice2</span><span class='op'>]</span> <span class='op'>-</span> <span class='nam'>f</span><span class='op'>[</span><span class='nam'>slice3</span><span class='op'>]</span><span class='op'>)</span><span class='op'>/</span><span class='num'>2.0</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slice1</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='num'>0</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slice2</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='num'>1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slice3</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='num'>0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># 1D equivalent -- out[0] = (f[1] - f[0])</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>out</span><span class='op'>[</span><span class='nam'>slice1</span><span class='op'>]</span> <span class='op'>=</span> <span class='op'>(</span><span class='nam'>f</span><span class='op'>[</span><span class='nam'>slice2</span><span class='op'>]</span> <span class='op'>-</span> <span class='nam'>f</span><span class='op'>[</span><span class='nam'>slice3</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slice1</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='op'>-</span><span class='num'>1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slice2</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='op'>-</span><span class='num'>1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slice3</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='op'>-</span><span class='num'>2</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># 1D equivalent -- out[-1] = (f[-1] - f[-2])</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>out</span><span class='op'>[</span><span class='nam'>slice1</span><span class='op'>]</span> <span class='op'>=</span> <span class='op'>(</span><span class='nam'>f</span><span class='op'>[</span><span class='nam'>slice2</span><span class='op'>]</span> <span class='op'>-</span> <span class='nam'>f</span><span class='op'>[</span><span class='nam'>slice3</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># divide by step size</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>outvals</span><span class='op'>.</span><span class='nam'>append</span><span class='op'>(</span><span class='nam'>out</span> <span class='op'>/</span> <span class='nam'>dx</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># reset the slice object in this dimension to &quot;:&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slice1</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slice2</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slice3</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>N</span> <span class='op'>==</span> <span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>outvals</span><span class='op'>[</span><span class='num'>0</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>outvals</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>diff</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>,</span> <span class='nam'>n</span><span class='op'>=</span><span class='num'>1</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Calculate the nth order discrete difference along given axis.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; a : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Input array</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; n : int, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The number of times values are differenced.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; axis : int, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The axis along which the difference is taken.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The `n` order differences.&nbsp; The shape of the output is the same as `a`</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; except along `axis` where the dimension is `n` less.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; x = np.array([0,1,3,9,5,10])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.diff(x)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 1,&nbsp; 2,&nbsp; 6, -4,&nbsp; 5])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.diff(x,n=2)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([&nbsp; 1,&nbsp;&nbsp; 4, -10,&nbsp;&nbsp; 9])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; x = np.array([[1,3,6,10],[0,5,6,8]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.diff(x)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([[2, 3, 4],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; [5, 1, 2]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.diff(x,axis=0)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([[-1,&nbsp; 2,&nbsp; 0, -2]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>n</span> <span class='op'>==</span> <span class='num'>0</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>a</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>n</span> <span class='op'>&lt;</span> <span class='num'>0</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>ValueError</span><span class='op'>,</span> <span class='str'>&#39;order must be non-negative but got &#39;</span> <span class='op'>+</span> <span class='nam'>repr</span><span class='op'>(</span><span class='nam'>n</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>a</span> <span class='op'>=</span> <span class='nam'>asanyarray</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>nd</span> <span class='op'>=</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>slice1</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>]</span><span class='op'>*</span><span class='nam'>nd</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>slice2</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>]</span><span class='op'>*</span><span class='nam'>nd</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>slice1</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='num'>1</span><span class='op'>,</span> <span class='nam'>None</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>slice2</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>,</span> <span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>slice1</span> <span class='op'>=</span> <span class='nam'>tuple</span><span class='op'>(</span><span class='nam'>slice1</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>slice2</span> <span class='op'>=</span> <span class='nam'>tuple</span><span class='op'>(</span><span class='nam'>slice2</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>n</span> <span class='op'>&gt;</span> <span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>diff</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>[</span><span class='nam'>slice1</span><span class='op'>]</span><span class='op'>-</span><span class='nam'>a</span><span class='op'>[</span><span class='nam'>slice2</span><span class='op'>]</span><span class='op'>,</span> <span class='nam'>n</span><span class='op'>-</span><span class='num'>1</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='nam'>axis</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>a</span><span class='op'>[</span><span class='nam'>slice1</span><span class='op'>]</span><span class='op'>-</span><span class='nam'>a</span><span class='op'>[</span><span class='nam'>slice2</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>try</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'>&nbsp; &nbsp; <span class='nam'>add_docstring</span><span class='op'>(</span><span class='nam'>digitize</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>r&quot;&quot;&quot;digitize(x,bins)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>Return the index of the bin to which each value of x belongs.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>Each index i returned is such that bins[i-1] &lt;= x &lt; bins[i] if</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>bins is monotonically increasing, or bins [i-1] &gt; x &gt;= bins[i] if</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>bins is monotonically decreasing.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>Beyond the bounds of the bins 0 or len(bins) is returned as appropriate.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&quot;&quot;&quot;</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'><span class='key'>except</span> <span class='nam'>RuntimeError</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>pass</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>try</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'>&nbsp; &nbsp; <span class='nam'>add_docstring</span><span class='op'>(</span><span class='nam'>bincount</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>r&quot;&quot;&quot;bincount(x,weights=None)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>Return the number of occurrences of each value in x.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>x must be a list of non-negative integers.&nbsp; The output, b[i],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>represents the number of times that i is found in x.&nbsp; If weights</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>is specified, every occurrence of i at a position p contributes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>weights[p] instead of 1.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>See also: histogram, digitize, unique.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&quot;&quot;&quot;</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'><span class='key'>except</span> <span class='nam'>RuntimeError</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>pass</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>try</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'>&nbsp; &nbsp; <span class='nam'>add_docstring</span><span class='op'>(</span><span class='nam'>add_docstring</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>r&quot;&quot;&quot;docstring(obj, docstring)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>Add a docstring to a built-in obj if possible.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>If the obj already has a docstring raise a RuntimeError</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>If this routine does not know how to add a docstring to the object</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>raise a TypeError</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&quot;&quot;&quot;</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'><span class='key'>except</span> <span class='nam'>RuntimeError</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>pass</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>interp</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>,</span> <span class='nam'>xp</span><span class='op'>,</span> <span class='nam'>fp</span><span class='op'>,</span> <span class='nam'>left</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>,</span> <span class='nam'>right</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; One-dimensional linear interpolation.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns the one-dimensional piecewise linear interpolant to a function</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; with given values at discrete data-points.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; x : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The x-coordinates of the interpolated values.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; xp : 1-D sequence of floats</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The x-coordinates of the data points, must be increasing.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; fp : 1-D sequence of floats</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The y-coordinates of the data points, same length as `xp`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; left : float, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Value to return for `x &lt; xp[0]`, default is `fp[0]`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; right : float, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Value to return for `x &gt; xp[-1]`, defaults is `fp[-1]`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; y : {float, ndarray}</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The interpolated values, same shape as `x`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Raises</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ValueError</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; If `xp` and `fp` have different length</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Does not check that the x-coordinate sequence `xp` is increasing.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; If `xp` is not increasing, the results are nonsense.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; A simple check for increasingness is::</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; np.all(np.diff(xp) &gt; 0)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; xp = [1, 2, 3]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; fp = [3, 2, 0]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.interp(2.5, xp, fp)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 1.0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.interp([0, 1, 1.5, 2.72, 3.14], xp, fp)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 3. ,&nbsp; 3. ,&nbsp; 2.5,&nbsp; 0.56,&nbsp; 0. ])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; UNDEF = -99.0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.interp(3.14, xp, fp, right=UNDEF)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -99.0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Plot an interpolant to the sine function:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; x = np.linspace(0, 2*np.pi, 10)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; y = np.sin(x)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; xvals = np.linspace(0, 2*np.pi, 50)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; yinterp = np.interp(xvals, x, y)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; import matplotlib.pyplot as plt</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.plot(x, y, &#39;o&#39;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.plot(xvals, yinterp, &#39;-x&#39;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.show()</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>isinstance</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>,</span> <span class='op'>(</span><span class='nam'>float</span><span class='op'>,</span> <span class='nam'>int</span><span class='op'>,</span> <span class='nam'>number</span><span class='op'>)</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>compiled_interp</span><span class='op'>(</span><span class='op'>[</span><span class='nam'>x</span><span class='op'>]</span><span class='op'>,</span> <span class='nam'>xp</span><span class='op'>,</span> <span class='nam'>fp</span><span class='op'>,</span> <span class='nam'>left</span><span class='op'>,</span> <span class='nam'>right</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>item</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>compiled_interp</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>,</span> <span class='nam'>xp</span><span class='op'>,</span> <span class='nam'>fp</span><span class='op'>,</span> <span class='nam'>left</span><span class='op'>,</span> <span class='nam'>right</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>angle</span><span class='op'>(</span><span class='nam'>z</span><span class='op'>,</span> <span class='nam'>deg</span><span class='op'>=</span><span class='num'>0</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return the angle of the complex argument.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; z : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; A complex number or sequence of complex numbers.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; deg : bool, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Return angle in degrees if True, radians if False (default).</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; angle : {ndarray, scalar}</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The counterclockwise angle from the positive real axis on</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; the complex plane, with dtype as numpy.float64.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; arctan2</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.angle([1.0, 1.0j, 1+1j])&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; # in radians</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 0.&nbsp; &nbsp; &nbsp; &nbsp; ,&nbsp; 1.57079633,&nbsp; 0.78539816])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.angle(1+1j, deg=True)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # in degrees</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 45.0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>deg</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>fact</span> <span class='op'>=</span> <span class='num'>180</span><span class='op'>/</span><span class='nam'>pi</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>fact</span> <span class='op'>=</span> <span class='num'>1.0</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>z</span> <span class='op'>=</span> <span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>z</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='op'>(</span><span class='nam'>issubclass</span><span class='op'>(</span><span class='nam'>z</span><span class='op'>.</span><span class='nam'>dtype</span><span class='op'>.</span><span class='nam'>type</span><span class='op'>,</span> <span class='nam'>_nx</span><span class='op'>.</span><span class='nam'>complexfloating</span><span class='op'>)</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>zimag</span> <span class='op'>=</span> <span class='nam'>z</span><span class='op'>.</span><span class='nam'>imag</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>zreal</span> <span class='op'>=</span> <span class='nam'>z</span><span class='op'>.</span><span class='nam'>real</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>zimag</span> <span class='op'>=</span> <span class='num'>0</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>zreal</span> <span class='op'>=</span> <span class='nam'>z</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>arctan2</span><span class='op'>(</span><span class='nam'>zimag</span><span class='op'>,</span> <span class='nam'>zreal</span><span class='op'>)</span> <span class='op'>*</span> <span class='nam'>fact</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>unwrap</span><span class='op'>(</span><span class='nam'>p</span><span class='op'>,</span> <span class='nam'>discont</span><span class='op'>=</span><span class='nam'>pi</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Unwrap by changing deltas between values to 2*pi complement.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Unwrap radian phase `p` by changing absolute jumps greater than</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; `discont` to their 2*pi complement along the given axis.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; p : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Input array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; discont : float</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Maximum discontinuity between values.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; axis : integer</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Axis along which unwrap will operate.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Output array</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>p</span> <span class='op'>=</span> <span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>p</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>nd</span> <span class='op'>=</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>p</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>dd</span> <span class='op'>=</span> <span class='nam'>diff</span><span class='op'>(</span><span class='nam'>p</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='nam'>axis</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>slice1</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>,</span> <span class='nam'>None</span><span class='op'>)</span><span class='op'>]</span><span class='op'>*</span><span class='nam'>nd</span>&nbsp; &nbsp;&nbsp; <span class='com'># full slices</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>slice1</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='num'>1</span><span class='op'>,</span> <span class='nam'>None</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>ddmod</span> <span class='op'>=</span> <span class='nam'>mod</span><span class='op'>(</span><span class='nam'>dd</span><span class='op'>+</span><span class='nam'>pi</span><span class='op'>,</span> <span class='num'>2</span><span class='op'>*</span><span class='nam'>pi</span><span class='op'>)</span><span class='op'>-</span><span class='nam'>pi</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>_nx</span><span class='op'>.</span><span class='nam'>putmask</span><span class='op'>(</span><span class='nam'>ddmod</span><span class='op'>,</span> <span class='op'>(</span><span class='nam'>ddmod</span><span class='op'>==</span><span class='op'>-</span><span class='nam'>pi</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>(</span><span class='nam'>dd</span> <span class='op'>&gt;</span> <span class='num'>0</span><span class='op'>)</span><span class='op'>,</span> <span class='nam'>pi</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>ph_correct</span> <span class='op'>=</span> <span class='nam'>ddmod</span> <span class='op'>-</span> <span class='nam'>dd</span><span class='op'>;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>_nx</span><span class='op'>.</span><span class='nam'>putmask</span><span class='op'>(</span><span class='nam'>ph_correct</span><span class='op'>,</span> <span class='nam'>abs</span><span class='op'>(</span><span class='nam'>dd</span><span class='op'>)</span><span class='op'>&lt;</span><span class='nam'>discont</span><span class='op'>,</span> <span class='num'>0</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>up</span> <span class='op'>=</span> <span class='nam'>array</span><span class='op'>(</span><span class='nam'>p</span><span class='op'>,</span> <span class='nam'>copy</span><span class='op'>=</span><span class='nam'>True</span><span class='op'>,</span> <span class='nam'>dtype</span><span class='op'>=</span><span class='str'>&#39;d&#39;</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>up</span><span class='op'>[</span><span class='nam'>slice1</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>p</span><span class='op'>[</span><span class='nam'>slice1</span><span class='op'>]</span> <span class='op'>+</span> <span class='nam'>ph_correct</span><span class='op'>.</span><span class='nam'>cumsum</span><span class='op'>(</span><span class='nam'>axis</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>up</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>sort_complex</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Sort a complex array using the real part first, then the imaginary part.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; a : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Input array</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : complex ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Always returns a sorted complex array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.sort_complex([5, 3, 6, 2, 1])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 1.+0.j,&nbsp; 2.+0.j,&nbsp; 3.+0.j,&nbsp; 5.+0.j,&nbsp; 6.+0.j])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.sort_complex([5 + 2j, 3 - 1j, 6 - 2j, 2 - 3j, 1 - 5j])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 1.-5.j,&nbsp; 2.-3.j,&nbsp; 3.-1.j,&nbsp; 5.+2.j,&nbsp; 6.-2.j])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>b</span> <span class='op'>=</span> <span class='nam'>array</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>,</span><span class='nam'>copy</span><span class='op'>=</span><span class='nam'>True</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>b</span><span class='op'>.</span><span class='nam'>sort</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='key'>not</span> <span class='nam'>issubclass</span><span class='op'>(</span><span class='nam'>b</span><span class='op'>.</span><span class='nam'>dtype</span><span class='op'>.</span><span class='nam'>type</span><span class='op'>,</span> <span class='nam'>_nx</span><span class='op'>.</span><span class='nam'>complexfloating</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>b</span><span class='op'>.</span><span class='nam'>dtype</span><span class='op'>.</span><span class='nam'>char</span> <span class='key'>in</span> <span class='str'>&#39;bhBH&#39;</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>b</span><span class='op'>.</span><span class='nam'>astype</span><span class='op'>(</span><span class='str'>&#39;F&#39;</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>elif</span> <span class='nam'>b</span><span class='op'>.</span><span class='nam'>dtype</span><span class='op'>.</span><span class='nam'>char</span> <span class='op'>==</span> <span class='str'>&#39;g&#39;</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>b</span><span class='op'>.</span><span class='nam'>astype</span><span class='op'>(</span><span class='str'>&#39;G&#39;</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>b</span><span class='op'>.</span><span class='nam'>astype</span><span class='op'>(</span><span class='str'>&#39;D&#39;</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>b</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>trim_zeros</span><span class='op'>(</span><span class='nam'>filt</span><span class='op'>,</span> <span class='nam'>trim</span><span class='op'>=</span><span class='str'>&#39;fb&#39;</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Trim the leading and trailing zeros from a 1D array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; filt : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Input array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; trim : string, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; A string with &#39;f&#39; representing trim from front and &#39;b&#39; to trim from</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; back.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; a = np.array((0, 0, 0, 1, 2, 3, 2, 1, 0))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.trim_zeros(a)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([1, 2, 3, 2, 1])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>first</span> <span class='op'>=</span> <span class='num'>0</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>trim</span> <span class='op'>=</span> <span class='nam'>trim</span><span class='op'>.</span><span class='nam'>upper</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='str'>&#39;F&#39;</span> <span class='key'>in</span> <span class='nam'>trim</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>i</span> <span class='key'>in</span> <span class='nam'>filt</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>i</span> <span class='op'>!=</span> <span class='num'>0.</span><span class='op'>:</span> <span class='key'>break</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span> <span class='nam'>first</span> <span class='op'>=</span> <span class='nam'>first</span> <span class='op'>+</span> <span class='num'>1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>last</span> <span class='op'>=</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>filt</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='str'>&#39;B&#39;</span> <span class='key'>in</span> <span class='nam'>trim</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>i</span> <span class='key'>in</span> <span class='nam'>filt</span><span class='op'>[</span><span class='op'>:</span><span class='op'>:</span><span class='op'>-</span><span class='num'>1</span><span class='op'>]</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>i</span> <span class='op'>!=</span> <span class='num'>0.</span><span class='op'>:</span> <span class='key'>break</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span> <span class='nam'>last</span> <span class='op'>=</span> <span class='nam'>last</span> <span class='op'>-</span> <span class='num'>1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>filt</span><span class='op'>[</span><span class='nam'>first</span><span class='op'>:</span><span class='nam'>last</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>import</span> <span class='nam'>sys</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>if</span> <span class='nam'>sys</span><span class='op'>.</span><span class='nam'>hexversion</span> <span class='op'>&lt;</span> <span class='num'>0x2040000</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>from</span> <span class='nam'>sets</span> <span class='key'>import</span> <span class='nam'>Set</span> <span class='key'>as</span> <span class='nam'>set</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>unique</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return the sorted, unique elements of an array or sequence.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; x : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Input array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; y : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The sorted, unique elements are returned in a 1-D array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.unique([1, 1, 2, 2, 3, 3])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([1, 2, 3])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; a = np.array([[1, 1], [2, 3]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.unique(a)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([1, 2, 3])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>try</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>tmp</span> <span class='op'>=</span> <span class='nam'>x</span><span class='op'>.</span><span class='nam'>flatten</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>tmp</span><span class='op'>.</span><span class='nam'>size</span> <span class='op'>==</span> <span class='num'>0</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>tmp</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>tmp</span><span class='op'>.</span><span class='nam'>sort</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>idx</span> <span class='op'>=</span> <span class='nam'>concatenate</span><span class='op'>(</span><span class='op'>(</span><span class='op'>[</span><span class='nam'>True</span><span class='op'>]</span><span class='op'>,</span><span class='nam'>tmp</span><span class='op'>[</span><span class='num'>1</span><span class='op'>:</span><span class='op'>]</span><span class='op'>!=</span><span class='nam'>tmp</span><span class='op'>[</span><span class='op'>:</span><span class='op'>-</span><span class='num'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>tmp</span><span class='op'>[</span><span class='nam'>idx</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>except</span> <span class='nam'>AttributeError</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>items</span> <span class='op'>=</span> <span class='nam'>list</span><span class='op'>(</span><span class='nam'>set</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>items</span><span class='op'>.</span><span class='nam'>sort</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>items</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>extract</span><span class='op'>(</span><span class='nam'>condition</span><span class='op'>,</span> <span class='nam'>arr</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return the elements of an array that satisfy some condition.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; This is equivalent to ``np.compress(ravel(condition), ravel(arr))``.&nbsp; If</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; `condition` is boolean ``np.extract`` is equivalent to ``arr[condition]``.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; condition : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; An array whose nonzero or True entries indicate the elements of `arr`</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; to extract.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; arr : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Input array of the same size as `condition`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; take, put, putmask</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; arr = np.array([[1,2,3,4],[5,6,7,8],[9,10,11,12]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; arr</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([[ 1,&nbsp; 2,&nbsp; 3,&nbsp; 4],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [ 5,&nbsp; 6,&nbsp; 7,&nbsp; 8],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [ 9, 10, 11, 12]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; condition = np.mod(arr, 3)==0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; condition</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([[False, False,&nbsp; True, False],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [False,&nbsp; True, False, False],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [ True, False, False,&nbsp; True]], dtype=bool)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.extract(condition, arr)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 3,&nbsp; 6,&nbsp; 9, 12])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; If `condition` is boolean:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; arr[condition]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 3,&nbsp; 6,&nbsp; 9, 12])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>_nx</span><span class='op'>.</span><span class='nam'>take</span><span class='op'>(</span><span class='nam'>ravel</span><span class='op'>(</span><span class='nam'>arr</span><span class='op'>)</span><span class='op'>,</span> <span class='nam'>nonzero</span><span class='op'>(</span><span class='nam'>ravel</span><span class='op'>(</span><span class='nam'>condition</span><span class='op'>)</span><span class='op'>)</span><span class='op'>[</span><span class='num'>0</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>place</span><span class='op'>(</span><span class='nam'>arr</span><span class='op'>,</span> <span class='nam'>mask</span><span class='op'>,</span> <span class='nam'>vals</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Changes elements of an array based on conditional and input values.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Similar to ``putmask(a, mask, vals)`` but the 1D array `vals` has the</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; same number of elements as the non-zero values of `mask`. Inverse of</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ``extract``.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Sets `a`.flat[n] = `values`\\[n] for each n where `mask`.flat[n] is true.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; a : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Array to put data into.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; mask : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Boolean mask array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; values : array_like, shape(number of non-zero `mask`, )</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Values to put into `a`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; putmask, put, take</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>_insert</span><span class='op'>(</span><span class='nam'>arr</span><span class='op'>,</span> <span class='nam'>mask</span><span class='op'>,</span> <span class='nam'>vals</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>_nanop</span><span class='op'>(</span><span class='nam'>op</span><span class='op'>,</span> <span class='nam'>fill</span><span class='op'>,</span> <span class='nam'>a</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; General operation on arrays with not-a-number values.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; op : callable</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Operation to perform.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; fill : float</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; NaN values are set to fill before doing the operation.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; a : array-like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Input array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; axis : {int, None}, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Axis along which the operation is computed.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; By default the input is flattened.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; y : {ndarray, scalar}</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Processed data.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>y</span> <span class='op'>=</span> <span class='nam'>array</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>,</span><span class='nam'>subok</span><span class='op'>=</span><span class='nam'>True</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>mask</span> <span class='op'>=</span> <span class='nam'>isnan</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>mask</span><span class='op'>.</span><span class='nam'>all</span><span class='op'>(</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>nan</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='key'>not</span> <span class='nam'>issubclass</span><span class='op'>(</span><span class='nam'>y</span><span class='op'>.</span><span class='nam'>dtype</span><span class='op'>.</span><span class='nam'>type</span><span class='op'>,</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>integer</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>y</span><span class='op'>[</span><span class='nam'>mask</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>fill</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>op</span><span class='op'>(</span><span class='nam'>y</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='nam'>axis</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>nansum</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return the sum of array elements over a given axis treating</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Not a Numbers (NaNs) as zero.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; a : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Array containing numbers whose sum is desired. If `a` is not an</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; array, a conversion is attempted.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; axis : int, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Axis along which the sum is computed. The default is to compute</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; the sum of the flattened array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; y : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; An array with the same shape as a, with the specified axis removed.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; If a is a 0-d array, or if axis is None, a scalar is returned with</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; the same dtype as `a`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; numpy.sum : Sum across array including Not a Numbers.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; isnan : Shows which elements are Not a Number (NaN).</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; isfinite: Shows which elements are not: Not a Number, positive and</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; negative infinity</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Numpy uses the IEEE Standard for Binary Floating-Point for Arithmetic</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; (IEEE 754). This means that Not a Number is not equivalent to infinity.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; If positive or negative infinity are present the result is positive or</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; negative infinity. But if both positive and negative infinity are present,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; the result is Not A Number (NaN).</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Arithmetic is modular when using integer types (all elements of `a` must</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; be finite i.e. no elements that are NaNs, positive infinity and negative</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; infinity because NaNs are floating point types), and no error is raised</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; on overflow.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nansum(1)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 1</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nansum([1])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 1</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nansum([1, np.nan])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 1.0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; a = np.array([[1, 1], [1, np.nan]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nansum(a)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 3.0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nansum(a, axis=0)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 2.,&nbsp; 1.])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; When positive infinity and negative infinity are present</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nansum([1, np.nan, np.inf])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; inf</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nansum([1, np.nan, np.NINF])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -inf</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nansum([1, np.nan, np.inf, np.NINF])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; nan</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>_nanop</span><span class='op'>(</span><span class='nam'>np</span><span class='op'>.</span><span class='nam'>sum</span><span class='op'>,</span> <span class='num'>0</span><span class='op'>,</span> <span class='nam'>a</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>nanmin</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return the minimum of array elements over the given axis ignoring any NaNs.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; a : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Array containing numbers whose sum is desired. If `a` is not</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; an array, a conversion is attempted.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; axis : int, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Axis along which the minimum is computed.The default is to compute</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; the minimum of the flattened array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; y : {ndarray, scalar}</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; An array with the same shape as `a`, with the specified axis removed.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; If `a` is a 0-d array, or if axis is None, a scalar is returned. The</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; the same dtype as `a` is returned.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; numpy.amin : Minimum across array including any Not a Numbers.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; numpy.nanmax : Maximum across array ignoring any Not a Numbers.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; isnan : Shows which elements are Not a Number (NaN).</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; isfinite: Shows which elements are not: Not a Number, positive and</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; negative infinity</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Numpy uses the IEEE Standard for Binary Floating-Point for Arithmetic</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; (IEEE 754). This means that Not a Number is not equivalent to infinity.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Positive infinity is treated as a very large number and negative infinity</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; is treated as a very small (i.e. negative) number.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; If the input has a integer type, an integer type is returned unless</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; the input contains NaNs and infinity.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; a = np.array([[1, 2], [3, np.nan]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nanmin(a)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 1.0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nanmin(a, axis=0)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 1.,&nbsp; 2.])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nanmin(a, axis=1)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 1.,&nbsp; 3.])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; When positive infinity and negative infinity are present:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nanmin([1, 2, np.nan, np.inf])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 1.0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nanmin([1, 2, np.nan, np.NINF])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -inf</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>_nanop</span><span class='op'>(</span><span class='nam'>np</span><span class='op'>.</span><span class='nam'>min</span><span class='op'>,</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>inf</span><span class='op'>,</span> <span class='nam'>a</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>nanargmin</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return indices of the minimum values along an axis, ignoring NaNs.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; nanargmax : corresponding function for maxima; see for details.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>_nanop</span><span class='op'>(</span><span class='nam'>np</span><span class='op'>.</span><span class='nam'>argmin</span><span class='op'>,</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>inf</span><span class='op'>,</span> <span class='nam'>a</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>nanmax</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return the maximum of array elements over the given axis ignoring any NaNs.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; a : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Array containing numbers whose maximum is desired. If `a` is not</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; an array, a conversion is attempted.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; axis : int, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Axis along which the maximum is computed.The default is to compute</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; the maximum of the flattened array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; y : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; An array with the same shape as `a`, with the specified axis removed.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; If `a` is a 0-d array, or if axis is None, a scalar is returned. The</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; the same dtype as `a` is returned.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; numpy.amax : Maximum across array including any Not a Numbers.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; numpy.nanmin : Minimum across array ignoring any Not a Numbers.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; isnan : Shows which elements are Not a Number (NaN).</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; isfinite: Shows which elements are not: Not a Number, positive and</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; negative infinity</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Numpy uses the IEEE Standard for Binary Floating-Point for Arithmetic</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; (IEEE 754). This means that Not a Number is not equivalent to infinity.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Positive infinity is treated as a very large number and negative infinity</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; is treated as a very small (i.e. negative) number.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; If the input has a integer type, an integer type is returned unless</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; the input contains NaNs and infinity.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; a = np.array([[1, 2], [3, np.nan]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nanmax(a)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 3.0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nanmax(a, axis=0)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 3.,&nbsp; 2.])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nanmax(a, axis=1)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 2.,&nbsp; 3.])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; When positive infinity and negative infinity are present:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nanmax([1, 2, np.nan, np.NINF])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 2.0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nanmax([1, 2, np.nan, np.inf])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; inf</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>_nanop</span><span class='op'>(</span><span class='nam'>np</span><span class='op'>.</span><span class='nam'>max</span><span class='op'>,</span> <span class='op'>-</span><span class='nam'>np</span><span class='op'>.</span><span class='nam'>inf</span><span class='op'>,</span> <span class='nam'>a</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>nanargmax</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return indices of the maximum values over an axis, ignoring NaNs.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; a : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Input data.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; axis : int, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Axis along which to operate.&nbsp; By default flattened input is used.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; index_array : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; An array of indices or a single index value.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; argmax, nanargmin</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; a = np.array([[np.nan, 4], [2, 3]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.argmax(a)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nanargmax(a)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 1</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nanargmax(a, axis=0)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([1, 1])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nanargmax(a, axis=1)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([1, 0])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>_nanop</span><span class='op'>(</span><span class='nam'>np</span><span class='op'>.</span><span class='nam'>argmax</span><span class='op'>,</span> <span class='op'>-</span><span class='nam'>np</span><span class='op'>.</span><span class='nam'>inf</span><span class='op'>,</span> <span class='nam'>a</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>disp</span><span class='op'>(</span><span class='nam'>mesg</span><span class='op'>,</span> <span class='nam'>device</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>,</span> <span class='nam'>linefeed</span><span class='op'>=</span><span class='nam'>True</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Display a message on a device</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; mesg : string</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Message to display.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; device : device object with &#39;write&#39; method</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Device to write message.&nbsp; If None, defaults to ``sys.stdout`` which is</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; very similar to ``print``.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; linefeed : bool, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Option whether to print a line feed or not.&nbsp; Defaults to True.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>device</span> <span class='key'>is</span> <span class='nam'>None</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>import</span> <span class='nam'>sys</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>device</span> <span class='op'>=</span> <span class='nam'>sys</span><span class='op'>.</span><span class='nam'>stdout</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>linefeed</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>device</span><span class='op'>.</span><span class='nam'>write</span><span class='op'>(</span><span class='str'>&#39;%s\n&#39;</span> <span class='op'>%</span> <span class='nam'>mesg</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>device</span><span class='op'>.</span><span class='nam'>write</span><span class='op'>(</span><span class='str'>&#39;%s&#39;</span> <span class='op'>%</span> <span class='nam'>mesg</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>device</span><span class='op'>.</span><span class='nam'>flush</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'># return number of input arguments and</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'>#&nbsp; number of default arguments</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>import</span> <span class='nam'>re</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>_get_nargs</span><span class='op'>(</span><span class='nam'>obj</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='key'>not</span> <span class='nam'>callable</span><span class='op'>(</span><span class='nam'>obj</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>TypeError</span><span class='op'>,</span> <span class='str'>&quot;Object is not callable.&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>hasattr</span><span class='op'>(</span><span class='nam'>obj</span><span class='op'>,</span><span class='str'>&#39;func_code&#39;</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>fcode</span> <span class='op'>=</span> <span class='nam'>obj</span><span class='op'>.</span><span class='nam'>func_code</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>nargs</span> <span class='op'>=</span> <span class='nam'>fcode</span><span class='op'>.</span><span class='nam'>co_argcount</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>obj</span><span class='op'>.</span><span class='nam'>func_defaults</span> <span class='key'>is</span> <span class='key'>not</span> <span class='nam'>None</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>ndefaults</span> <span class='op'>=</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>obj</span><span class='op'>.</span><span class='nam'>func_defaults</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>ndefaults</span> <span class='op'>=</span> <span class='num'>0</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>isinstance</span><span class='op'>(</span><span class='nam'>obj</span><span class='op'>,</span> <span class='nam'>types</span><span class='op'>.</span><span class='nam'>MethodType</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>nargs</span> <span class='op'>-=</span> <span class='num'>1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>nargs</span><span class='op'>,</span> <span class='nam'>ndefaults</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>terr</span> <span class='op'>=</span> <span class='nam'>re</span><span class='op'>.</span><span class='nam'>compile</span><span class='op'>(</span><span class='str'>r&#39;.*? takes exactly (?P&lt;exargs&gt;\d+) argument(s|) \((?P&lt;gargs&gt;\d+) given\)&#39;</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>try</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>obj</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='num'>0</span><span class='op'>,</span> <span class='num'>0</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>except</span> <span class='nam'>TypeError</span><span class='op'>,</span> <span class='nam'>msg</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>m</span> <span class='op'>=</span> <span class='nam'>terr</span><span class='op'>.</span><span class='nam'>match</span><span class='op'>(</span><span class='nam'>str</span><span class='op'>(</span><span class='nam'>msg</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>m</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>nargs</span> <span class='op'>=</span> <span class='nam'>int</span><span class='op'>(</span><span class='nam'>m</span><span class='op'>.</span><span class='nam'>group</span><span class='op'>(</span><span class='str'>&#39;exargs&#39;</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>ndefaults</span> <span class='op'>=</span> <span class='nam'>int</span><span class='op'>(</span><span class='nam'>m</span><span class='op'>.</span><span class='nam'>group</span><span class='op'>(</span><span class='str'>&#39;gargs&#39;</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>isinstance</span><span class='op'>(</span><span class='nam'>obj</span><span class='op'>,</span> <span class='nam'>types</span><span class='op'>.</span><span class='nam'>MethodType</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>nargs</span> <span class='op'>-=</span> <span class='num'>1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>nargs</span><span class='op'>,</span> <span class='nam'>ndefaults</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>ValueError</span><span class='op'>,</span> <span class='str'>&#39;failed to determine the number of arguments for %s&#39;</span> <span class='op'>%</span> <span class='op'>(</span><span class='nam'>obj</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>class</span> <span class='nam'>vectorize</span><span class='op'>(</span><span class='nam'>object</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; vectorize(somefunction, otypes=None, doc=None)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Generalized function class.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Define a vectorized function which takes nested sequence</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; of objects or numpy arrays as inputs and returns a</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; numpy array as output, evaluating the function over successive</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; tuples of the input arrays like the python map function except it uses</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; the broadcasting rules of numpy.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Data-type of output of vectorized is determined by calling the function</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; with the first element of the input.&nbsp; This can be avoided by specifying</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; the otypes argument as either a string of typecode characters or a list</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; of data-types specifiers.&nbsp; There should be one data-type specifier for</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; each output.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; f : callable</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; A Python function or method.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; def myfunc(a, b):</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ...&nbsp; &nbsp; if a &gt; b:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ...&nbsp; &nbsp; &nbsp; &nbsp; return a-b</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ...&nbsp; &nbsp; else:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ...&nbsp; &nbsp; &nbsp; &nbsp; return a+b</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; vfunc = np.vectorize(myfunc)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; vfunc([1, 2, 3, 4], 2)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([3, 4, 1, 2])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'>&nbsp; &nbsp; <span class='key'>def</span> <span class='nam'>__init__</span><span class='op'>(</span><span class='nam'>self</span><span class='op'>,</span> <span class='nam'>pyfunc</span><span class='op'>,</span> <span class='nam'>otypes</span><span class='op'>=</span><span class='str'>&#39;&#39;</span><span class='op'>,</span> <span class='nam'>doc</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>self</span><span class='op'>.</span><span class='nam'>thefunc</span> <span class='op'>=</span> <span class='nam'>pyfunc</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>self</span><span class='op'>.</span><span class='nam'>ufunc</span> <span class='op'>=</span> <span class='nam'>None</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>nin</span><span class='op'>,</span> <span class='nam'>ndefault</span> <span class='op'>=</span> <span class='nam'>_get_nargs</span><span class='op'>(</span><span class='nam'>pyfunc</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>nin</span> <span class='op'>==</span> <span class='num'>0</span> <span class='key'>and</span> <span class='nam'>ndefault</span> <span class='op'>==</span> <span class='num'>0</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>self</span><span class='op'>.</span><span class='nam'>nin</span> <span class='op'>=</span> <span class='nam'>None</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>self</span><span class='op'>.</span><span class='nam'>nin_wo_defaults</span> <span class='op'>=</span> <span class='nam'>None</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>self</span><span class='op'>.</span><span class='nam'>nin</span> <span class='op'>=</span> <span class='nam'>nin</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>self</span><span class='op'>.</span><span class='nam'>nin_wo_defaults</span> <span class='op'>=</span> <span class='nam'>nin</span> <span class='op'>-</span> <span class='nam'>ndefault</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>self</span><span class='op'>.</span><span class='nam'>nout</span> <span class='op'>=</span> <span class='nam'>None</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>doc</span> <span class='key'>is</span> <span class='nam'>None</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>self</span><span class='op'>.</span><span class='nam'>__doc__</span> <span class='op'>=</span> <span class='nam'>pyfunc</span><span class='op'>.</span><span class='nam'>__doc__</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>self</span><span class='op'>.</span><span class='nam'>__doc__</span> <span class='op'>=</span> <span class='nam'>doc</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>isinstance</span><span class='op'>(</span><span class='nam'>otypes</span><span class='op'>,</span> <span class='nam'>str</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>self</span><span class='op'>.</span><span class='nam'>otypes</span> <span class='op'>=</span> <span class='nam'>otypes</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>char</span> <span class='key'>in</span> <span class='nam'>self</span><span class='op'>.</span><span class='nam'>otypes</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>char</span> <span class='key'>not</span> <span class='key'>in</span> <span class='nam'>typecodes</span><span class='op'>[</span><span class='str'>&#39;All&#39;</span><span class='op'>]</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>ValueError</span><span class='op'>,</span> <span class='str'>&quot;invalid otype specified&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>elif</span> <span class='nam'>iterable</span><span class='op'>(</span><span class='nam'>otypes</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>self</span><span class='op'>.</span><span class='nam'>otypes</span> <span class='op'>=</span> <span class='str'>&#39;&#39;</span><span class='op'>.</span><span class='nam'>join</span><span class='op'>(</span><span class='op'>[</span><span class='nam'>_nx</span><span class='op'>.</span><span class='nam'>dtype</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>char</span> <span class='key'>for</span> <span class='nam'>x</span> <span class='key'>in</span> <span class='nam'>otypes</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>ValueError</span><span class='op'>,</span> <span class='str'>&quot;output types must be a string of typecode characters or a list of data-types&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>self</span><span class='op'>.</span><span class='nam'>lastcallargs</span> <span class='op'>=</span> <span class='num'>0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'>&nbsp; &nbsp; <span class='key'>def</span> <span class='nam'>__call__</span><span class='op'>(</span><span class='nam'>self</span><span class='op'>,</span> <span class='op'>*</span><span class='nam'>args</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># get number of outputs and output types by calling</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'>#&nbsp; the function on the first entries of args</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>nargs</span> <span class='op'>=</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>args</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>self</span><span class='op'>.</span><span class='nam'>nin</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='op'>(</span><span class='nam'>nargs</span> <span class='op'>&gt;</span> <span class='nam'>self</span><span class='op'>.</span><span class='nam'>nin</span><span class='op'>)</span> <span class='key'>or</span> <span class='op'>(</span><span class='nam'>nargs</span> <span class='op'>&lt;</span> <span class='nam'>self</span><span class='op'>.</span><span class='nam'>nin_wo_defaults</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>ValueError</span><span class='op'>,</span> <span class='str'>&quot;mismatch between python function inputs&quot;</span><span class='xx'>\</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='str'>&quot; and received arguments&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># we need a new ufunc if this is being called with more arguments.</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='op'>(</span><span class='nam'>self</span><span class='op'>.</span><span class='nam'>lastcallargs</span> <span class='op'>!=</span> <span class='nam'>nargs</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>self</span><span class='op'>.</span><span class='nam'>lastcallargs</span> <span class='op'>=</span> <span class='nam'>nargs</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>self</span><span class='op'>.</span><span class='nam'>ufunc</span> <span class='op'>=</span> <span class='nam'>None</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>self</span><span class='op'>.</span><span class='nam'>nout</span> <span class='op'>=</span> <span class='nam'>None</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>self</span><span class='op'>.</span><span class='nam'>nout</span> <span class='key'>is</span> <span class='nam'>None</span> <span class='key'>or</span> <span class='nam'>self</span><span class='op'>.</span><span class='nam'>otypes</span> <span class='op'>==</span> <span class='str'>&#39;&#39;</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>newargs</span> <span class='op'>=</span> <span class='op'>[</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>arg</span> <span class='key'>in</span> <span class='nam'>args</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>newargs</span><span class='op'>.</span><span class='nam'>append</span><span class='op'>(</span><span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>arg</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>flat</span><span class='op'>[</span><span class='num'>0</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>theout</span> <span class='op'>=</span> <span class='nam'>self</span><span class='op'>.</span><span class='nam'>thefunc</span><span class='op'>(</span><span class='op'>*</span><span class='nam'>newargs</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>isinstance</span><span class='op'>(</span><span class='nam'>theout</span><span class='op'>,</span> <span class='nam'>tuple</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>self</span><span class='op'>.</span><span class='nam'>nout</span> <span class='op'>=</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>theout</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>self</span><span class='op'>.</span><span class='nam'>nout</span> <span class='op'>=</span> <span class='num'>1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>theout</span> <span class='op'>=</span> <span class='op'>(</span><span class='nam'>theout</span><span class='op'>,</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>self</span><span class='op'>.</span><span class='nam'>otypes</span> <span class='op'>==</span> <span class='str'>&#39;&#39;</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>otypes</span> <span class='op'>=</span> <span class='op'>[</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>k</span> <span class='key'>in</span> <span class='nam'>range</span><span class='op'>(</span><span class='nam'>self</span><span class='op'>.</span><span class='nam'>nout</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>otypes</span><span class='op'>.</span><span class='nam'>append</span><span class='op'>(</span><span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>theout</span><span class='op'>[</span><span class='nam'>k</span><span class='op'>]</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>dtype</span><span class='op'>.</span><span class='nam'>char</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>self</span><span class='op'>.</span><span class='nam'>otypes</span> <span class='op'>=</span> <span class='str'>&#39;&#39;</span><span class='op'>.</span><span class='nam'>join</span><span class='op'>(</span><span class='nam'>otypes</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># Create ufunc if not already created</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='op'>(</span><span class='nam'>self</span><span class='op'>.</span><span class='nam'>ufunc</span> <span class='key'>is</span> <span class='nam'>None</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>self</span><span class='op'>.</span><span class='nam'>ufunc</span> <span class='op'>=</span> <span class='nam'>frompyfunc</span><span class='op'>(</span><span class='nam'>self</span><span class='op'>.</span><span class='nam'>thefunc</span><span class='op'>,</span> <span class='nam'>nargs</span><span class='op'>,</span> <span class='nam'>self</span><span class='op'>.</span><span class='nam'>nout</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># Convert to object arrays first</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>newargs</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>array</span><span class='op'>(</span><span class='nam'>arg</span><span class='op'>,</span><span class='nam'>copy</span><span class='op'>=</span><span class='nam'>False</span><span class='op'>,</span><span class='nam'>subok</span><span class='op'>=</span><span class='nam'>True</span><span class='op'>,</span><span class='nam'>dtype</span><span class='op'>=</span><span class='nam'>object</span><span class='op'>)</span> <span class='key'>for</span> <span class='nam'>arg</span> <span class='key'>in</span> <span class='nam'>args</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>self</span><span class='op'>.</span><span class='nam'>nout</span> <span class='op'>==</span> <span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>_res</span> <span class='op'>=</span> <span class='nam'>array</span><span class='op'>(</span><span class='nam'>self</span><span class='op'>.</span><span class='nam'>ufunc</span><span class='op'>(</span><span class='op'>*</span><span class='nam'>newargs</span><span class='op'>)</span><span class='op'>,</span><span class='nam'>copy</span><span class='op'>=</span><span class='nam'>False</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class='nam'>subok</span><span class='op'>=</span><span class='nam'>True</span><span class='op'>,</span><span class='nam'>dtype</span><span class='op'>=</span><span class='nam'>self</span><span class='op'>.</span><span class='nam'>otypes</span><span class='op'>[</span><span class='num'>0</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>_res</span> <span class='op'>=</span> <span class='nam'>tuple</span><span class='op'>(</span><span class='op'>[</span><span class='nam'>array</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>,</span><span class='nam'>copy</span><span class='op'>=</span><span class='nam'>False</span><span class='op'>,</span><span class='nam'>subok</span><span class='op'>=</span><span class='nam'>True</span><span class='op'>,</span><span class='nam'>dtype</span><span class='op'>=</span><span class='nam'>c</span><span class='op'>)</span> <span class='xx'>\</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>x</span><span class='op'>,</span> <span class='nam'>c</span> <span class='key'>in</span> <span class='nam'>zip</span><span class='op'>(</span><span class='nam'>self</span><span class='op'>.</span><span class='nam'>ufunc</span><span class='op'>(</span><span class='op'>*</span><span class='nam'>newargs</span><span class='op'>)</span><span class='op'>,</span> <span class='nam'>self</span><span class='op'>.</span><span class='nam'>otypes</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>_res</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>cov</span><span class='op'>(</span><span class='nam'>m</span><span class='op'>,</span> <span class='nam'>y</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>,</span> <span class='nam'>rowvar</span><span class='op'>=</span><span class='num'>1</span><span class='op'>,</span> <span class='nam'>bias</span><span class='op'>=</span><span class='num'>0</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Estimate a covariance matrix, given data.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Covariance indicates the level to which two variables vary together.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; If we examine N-dimensional samples, :math:`X = [x_1, x_2, ... x_N]^T`,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; then the covariance matrix element :math:`C_{ij}` is the covariance of</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; :math:`x_i` and :math:`x_j`. The element :math:`C_{ii}` is the variance</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; of :math:`x_i`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; m : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; A 1-D or 2-D array containing multiple variables and observations.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Each row of `m` represents a variable, and each column a single</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; observation of all those variables. Also see `rowvar` below.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; y : array_like, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; An additional set of variables and observations. `y` has the same</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; form as that of `m`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; rowvar : int, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; If `rowvar` is non-zero (default), then each row represents a</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; variable, with observations in the columns. Otherwise, the relationship</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; is transposed: each column represents a variable, while the rows</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; contain observations.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; bias : int, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Default normalization is by ``(N-1)``, where ``N`` is the number of</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; observations given (unbiased estimate). If `bias` is 1, then</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; normalization is by ``N``.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The covariance matrix of the variables.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; corrcoef : Normalized covariance matrix</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Consider two variables, :math:`x_0` and :math:`x_1`, which</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; correlate perfectly, but in opposite directions:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; x = np.array([[0, 2], [1, 1], [2, 0]]).T</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; x</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([[0, 1, 2],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [2, 1, 0]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Note how :math:`x_0` increases while :math:`x_1` decreases. The covariance</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; matrix shows this clearly:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.cov(x)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([[ 1., -1.],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [-1.,&nbsp; 1.]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Note that element :math:`C_{0,1}`, which shows the correlation between</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; :math:`x_0` and :math:`x_1`, is negative.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Further, note how `x` and `y` are combined:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; x = [-2.1, -1,&nbsp; 4.3]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; y = [3,&nbsp; 1.1,&nbsp; 0.12]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; X = np.vstack((x,y))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; print np.cov(X)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; [[ 11.71&nbsp; &nbsp; &nbsp; &nbsp; -4.286&nbsp; &nbsp;&nbsp; ]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp;&nbsp; [ -4.286&nbsp; &nbsp; &nbsp; &nbsp; 2.14413333]]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; print np.cov(x, y)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; [[ 11.71&nbsp; &nbsp; &nbsp; &nbsp; -4.286&nbsp; &nbsp;&nbsp; ]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp;&nbsp; [ -4.286&nbsp; &nbsp; &nbsp; &nbsp; 2.14413333]]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; print np.cov(x)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 11.71</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>X</span> <span class='op'>=</span> <span class='nam'>array</span><span class='op'>(</span><span class='nam'>m</span><span class='op'>,</span> <span class='nam'>ndmin</span><span class='op'>=</span><span class='num'>2</span><span class='op'>,</span> <span class='nam'>dtype</span><span class='op'>=</span><span class='nam'>float</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>X</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>[</span><span class='num'>0</span><span class='op'>]</span> <span class='op'>==</span> <span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>rowvar</span> <span class='op'>=</span> <span class='num'>1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>rowvar</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>axis</span> <span class='op'>=</span> <span class='num'>0</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>tup</span> <span class='op'>=</span> <span class='op'>(</span><span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>,</span><span class='nam'>newaxis</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>axis</span> <span class='op'>=</span> <span class='num'>1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>tup</span> <span class='op'>=</span> <span class='op'>(</span><span class='nam'>newaxis</span><span class='op'>,</span> <span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>y</span> <span class='key'>is</span> <span class='key'>not</span> <span class='nam'>None</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>y</span> <span class='op'>=</span> <span class='nam'>array</span><span class='op'>(</span><span class='nam'>y</span><span class='op'>,</span> <span class='nam'>copy</span><span class='op'>=</span><span class='nam'>False</span><span class='op'>,</span> <span class='nam'>ndmin</span><span class='op'>=</span><span class='num'>2</span><span class='op'>,</span> <span class='nam'>dtype</span><span class='op'>=</span><span class='nam'>float</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>X</span> <span class='op'>=</span> <span class='nam'>concatenate</span><span class='op'>(</span><span class='op'>(</span><span class='nam'>X</span><span class='op'>,</span><span class='nam'>y</span><span class='op'>)</span><span class='op'>,</span><span class='nam'>axis</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>X</span> <span class='op'>-=</span> <span class='nam'>X</span><span class='op'>.</span><span class='nam'>mean</span><span class='op'>(</span><span class='nam'>axis</span><span class='op'>=</span><span class='num'>1</span><span class='op'>-</span><span class='nam'>axis</span><span class='op'>)</span><span class='op'>[</span><span class='nam'>tup</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>rowvar</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>N</span> <span class='op'>=</span> <span class='nam'>X</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>[</span><span class='num'>1</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>N</span> <span class='op'>=</span> <span class='nam'>X</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>[</span><span class='num'>0</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>bias</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>fact</span> <span class='op'>=</span> <span class='nam'>N</span><span class='op'>*</span><span class='num'>1.0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>fact</span> <span class='op'>=</span> <span class='nam'>N</span><span class='op'>-</span><span class='num'>1.0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='key'>not</span> <span class='nam'>rowvar</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='op'>(</span><span class='nam'>dot</span><span class='op'>(</span><span class='nam'>X</span><span class='op'>.</span><span class='nam'>T</span><span class='op'>,</span> <span class='nam'>X</span><span class='op'>.</span><span class='nam'>conj</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='nam'>fact</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>squeeze</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='op'>(</span><span class='nam'>dot</span><span class='op'>(</span><span class='nam'>X</span><span class='op'>,</span> <span class='nam'>X</span><span class='op'>.</span><span class='nam'>T</span><span class='op'>.</span><span class='nam'>conj</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='nam'>fact</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>squeeze</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>corrcoef</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>,</span> <span class='nam'>y</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>,</span> <span class='nam'>rowvar</span><span class='op'>=</span><span class='num'>1</span><span class='op'>,</span> <span class='nam'>bias</span><span class='op'>=</span><span class='num'>0</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return correlation coefficients.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Please refer to the documentation for `cov` for more detail.&nbsp; The</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; relationship between the correlation coefficient matrix, P, and the</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; covariance matrix, C, is</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. math:: P_{ij} = \\frac{ C_{ij} } { \\sqrt{ C_{ii} * C_{jj} } }</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The values of P are between -1 and 1.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; cov : Covariance matrix</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>c</span> <span class='op'>=</span> <span class='nam'>cov</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>,</span> <span class='nam'>y</span><span class='op'>,</span> <span class='nam'>rowvar</span><span class='op'>,</span> <span class='nam'>bias</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>try</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>d</span> <span class='op'>=</span> <span class='nam'>diag</span><span class='op'>(</span><span class='nam'>c</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>except</span> <span class='nam'>ValueError</span><span class='op'>:</span> <span class='com'># scalar covariance</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='num'>1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>c</span><span class='op'>/</span><span class='nam'>sqrt</span><span class='op'>(</span><span class='nam'>multiply</span><span class='op'>.</span><span class='nam'>outer</span><span class='op'>(</span><span class='nam'>d</span><span class='op'>,</span><span class='nam'>d</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>blackman</span><span class='op'>(</span><span class='nam'>M</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return the Blackman window.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The Blackman window is a taper formed by using the the first</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; three terms of a summation of cosines. It was designed to have close</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; to the minimal leakage possible.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; It is close to optimal, only slightly worse than a Kaiser window.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; M : int</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Number of points in the output window. If zero or less, an</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; empty array is returned.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : array</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The window, normalized to one (the value one</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; appears only if the number of samples is odd).</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; bartlett, hamming, hanning, kaiser</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The Blackman window is defined as</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. math::&nbsp; w(n) = 0.42 - 0.5 \\cos(2\\pi n/M) + 0.08 \\cos(4\\pi n/M)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Most references to the Blackman window come from the signal processing</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; literature, where it is used as one of many windowing functions for</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; smoothing values.&nbsp; It is also known as an apodization (which means</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;removing the foot&quot;, i.e. smoothing discontinuities at the beginning</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; and end of the sampled signal) or tapering function. It is known as a</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;near optimal&quot; tapering function, almost as good (by some measures)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; as the kaiser window.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; References</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [1] Blackman, R.B. and Tukey, J.W., (1958) The measurement of power</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; spectra, Dover Publications, New York.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [2] Wikipedia, &quot;Window function&quot;,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; http://en.wikipedia.org/wiki/Window_function</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [3] Oppenheim, A.V., and R.W. Schafer. Discrete-Time Signal Processing.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Upper Saddle River, NJ: Prentice-Hall, 1999, pp. 468-471.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; from numpy import blackman</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; blackman(12)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ -1.38777878e-17,&nbsp;&nbsp; 3.26064346e-02,&nbsp;&nbsp; 1.59903635e-01,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 4.14397981e-01,&nbsp;&nbsp; 7.36045180e-01,&nbsp;&nbsp; 9.67046769e-01,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 9.67046769e-01,&nbsp;&nbsp; 7.36045180e-01,&nbsp;&nbsp; 4.14397981e-01,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 1.59903635e-01,&nbsp;&nbsp; 3.26064346e-02,&nbsp; -1.38777878e-17])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Plot the window and the frequency response:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; from numpy import clip, log10, array, bartlett</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; from scipy.fftpack import fft, fftshift</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; import matplotlib.pyplot as plt</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; window = blackman(51)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.plot(window)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.title(&quot;Blackman window&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.ylabel(&quot;Amplitude&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.xlabel(&quot;Sample&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.show()</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; A = fft(window, 2048) / 25.5</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; mag = abs(fftshift(A))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; freq = linspace(-0.5,0.5,len(A))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; response = 20*log10(mag)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; response = clip(response,-100,100)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.plot(freq, response)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.title(&quot;Frequency response of Bartlett window&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.ylabel(&quot;Magnitude [dB]&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.xlabel(&quot;Normalized frequency [cycles per sample]&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.axis(&#39;tight&#39;); plt.show()</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>M</span> <span class='op'>&lt;</span> <span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>array</span><span class='op'>(</span><span class='op'>[</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>M</span> <span class='op'>==</span> <span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>ones</span><span class='op'>(</span><span class='num'>1</span><span class='op'>,</span> <span class='nam'>float</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>n</span> <span class='op'>=</span> <span class='nam'>arange</span><span class='op'>(</span><span class='num'>0</span><span class='op'>,</span><span class='nam'>M</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='num'>0.42</span><span class='op'>-</span><span class='num'>0.5</span><span class='op'>*</span><span class='nam'>cos</span><span class='op'>(</span><span class='num'>2.0</span><span class='op'>*</span><span class='nam'>pi</span><span class='op'>*</span><span class='nam'>n</span><span class='op'>/</span><span class='op'>(</span><span class='nam'>M</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='num'>0.08</span><span class='op'>*</span><span class='nam'>cos</span><span class='op'>(</span><span class='num'>4.0</span><span class='op'>*</span><span class='nam'>pi</span><span class='op'>*</span><span class='nam'>n</span><span class='op'>/</span><span class='op'>(</span><span class='nam'>M</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>bartlett</span><span class='op'>(</span><span class='nam'>M</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return the Bartlett window.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The Bartlett window is very similar to a triangular window, except</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; that the end points are at zero.&nbsp; It is often used in signal</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; processing for tapering a signal, without generating too much</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ripple in the frequency domain.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; M : int</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Number of points in the output window. If zero or less, an</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; empty array is returned.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : array</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The triangular window, normalized to one (the value one</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; appears only if the number of samples is odd), with the first</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; and last samples equal to zero.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; blackman, hamming, hanning, kaiser</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The Bartlett window is defined as</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. math:: w(n) = \\frac{2}{M-1} \\left(</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \\frac{M-1}{2} - \\left|n - \\frac{M-1}{2}\\right|</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \\right)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Most references to the Bartlett window come from the signal</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; processing literature, where it is used as one of many windowing</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; functions for smoothing values.&nbsp; Note that convolution with this</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; window produces linear interpolation.&nbsp; It is also known as an</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; apodization (which means&quot;removing the foot&quot;, i.e. smoothing</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; discontinuities at the beginning and end of the sampled signal) or</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; tapering function. The fourier transform of the Bartlett is the product</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; of two sinc functions.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Note the excellent discussion in Kanasewich.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; References</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [1] M.S. Bartlett, &quot;Periodogram Analysis and Continuous Spectra&quot;,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Biometrika 37, 1-16, 1950.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [2] E.R. Kanasewich, &quot;Time Sequence Analysis in Geophysics&quot;,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; The University of Alberta Press, 1975, pp. 109-110.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [3] A.V. Oppenheim and R.W. Schafer, &quot;Discrete-Time Signal</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Processing&quot;, Prentice-Hall, 1999, pp. 468-471.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [4] Wikipedia, &quot;Window function&quot;,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; http://en.wikipedia.org/wiki/Window_function</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [5] W.H. Press,&nbsp; B.P. Flannery, S.A. Teukolsky, and W.T. Vetterling,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &quot;Numerical Recipes&quot;, Cambridge University Press, 1986, page 429.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.bartlett(12)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 0.&nbsp; &nbsp; &nbsp; &nbsp; ,&nbsp; 0.18181818,&nbsp; 0.36363636,&nbsp; 0.54545455,&nbsp; 0.72727273,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.90909091,&nbsp; 0.90909091,&nbsp; 0.72727273,&nbsp; 0.54545455,&nbsp; 0.36363636,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.18181818,&nbsp; 0.&nbsp; &nbsp; &nbsp; &nbsp; ])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Plot the window and its frequency response (requires SciPy and matplotlib):</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; from numpy import clip, log10, array, bartlett</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; from numpy.fft import fft</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; import matplotlib.pyplot as plt</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; window = bartlett(51)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.plot(window)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.title(&quot;Bartlett window&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.ylabel(&quot;Amplitude&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.xlabel(&quot;Sample&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.show()</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; A = fft(window, 2048) / 25.5</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; mag = abs(fftshift(A))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; freq = linspace(-0.5,0.5,len(A))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; response = 20*log10(mag)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; response = clip(response,-100,100)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.plot(freq, response)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.title(&quot;Frequency response of Bartlett window&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.ylabel(&quot;Magnitude [dB]&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.xlabel(&quot;Normalized frequency [cycles per sample]&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.axis(&#39;tight&#39;); plt.show()</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>M</span> <span class='op'>&lt;</span> <span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>array</span><span class='op'>(</span><span class='op'>[</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>M</span> <span class='op'>==</span> <span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>ones</span><span class='op'>(</span><span class='num'>1</span><span class='op'>,</span> <span class='nam'>float</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>n</span> <span class='op'>=</span> <span class='nam'>arange</span><span class='op'>(</span><span class='num'>0</span><span class='op'>,</span><span class='nam'>M</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>where</span><span class='op'>(</span><span class='nam'>less_equal</span><span class='op'>(</span><span class='nam'>n</span><span class='op'>,</span><span class='op'>(</span><span class='nam'>M</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='op'>/</span><span class='num'>2.0</span><span class='op'>)</span><span class='op'>,</span><span class='num'>2.0</span><span class='op'>*</span><span class='nam'>n</span><span class='op'>/</span><span class='op'>(</span><span class='nam'>M</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='op'>,</span><span class='num'>2.0</span><span class='op'>-</span><span class='num'>2.0</span><span class='op'>*</span><span class='nam'>n</span><span class='op'>/</span><span class='op'>(</span><span class='nam'>M</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>hanning</span><span class='op'>(</span><span class='nam'>M</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return the Hanning window.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The Hanning window is a taper formed by using a weighted cosine.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; M : int</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Number of points in the output window. If zero or less, an</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; empty array is returned.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : ndarray, shape(M,)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The window, normalized to one (the value one</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; appears only if `M` is odd).</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; bartlett, blackman, hamming, kaiser</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The Hanning window is defined as</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. math::&nbsp; w(n) = 0.5 - 0.5cos\\left(\\frac{2\\pi{n}}{M-1}\\right)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; \\qquad 0 \\leq n \\leq M-1</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The Hanning was named for Julius van Hann, an Austrian meterologist. It is</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; also known as the Cosine Bell. Some authors prefer that it be called a</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Hann window, to help avoid confusion with the very similar Hamming window.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Most references to the Hanning window come from the signal processing</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; literature, where it is used as one of many windowing functions for</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; smoothing values.&nbsp; It is also known as an apodization (which means</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;removing the foot&quot;, i.e. smoothing discontinuities at the beginning</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; and end of the sampled signal) or tapering function.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; References</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [1] Blackman, R.B. and Tukey, J.W., (1958) The measurement of power</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; spectra, Dover Publications, New York.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [2] E.R. Kanasewich, &quot;Time Sequence Analysis in Geophysics&quot;,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; The University of Alberta Press, 1975, pp. 106-108.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [3] Wikipedia, &quot;Window function&quot;,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; http://en.wikipedia.org/wiki/Window_function</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [4] W.H. Press,&nbsp; B.P. Flannery, S.A. Teukolsky, and W.T. Vetterling,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &quot;Numerical Recipes&quot;, Cambridge University Press, 1986, page 425.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; from numpy import hanning</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; hanning(12)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 0.&nbsp; &nbsp; &nbsp; &nbsp; ,&nbsp; 0.07937323,&nbsp; 0.29229249,&nbsp; 0.57115742,&nbsp; 0.82743037,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.97974649,&nbsp; 0.97974649,&nbsp; 0.82743037,&nbsp; 0.57115742,&nbsp; 0.29229249,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.07937323,&nbsp; 0.&nbsp; &nbsp; &nbsp; &nbsp; ])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Plot the window and its frequency response:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; from numpy.fft import fft, fftshift</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; import matplotlib.pyplot as plt</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; window = np.hanning(51)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.subplot(121)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.plot(window)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.title(&quot;Hann window&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.ylabel(&quot;Amplitude&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.xlabel(&quot;Sample&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; A = fft(window, 2048) / 25.5</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; mag = abs(fftshift(A))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; freq = np.linspace(-0.5,0.5,len(A))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; response = 20*np.log10(mag)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; response = np.clip(response,-100,100)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.subplot(122)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.plot(freq, response)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.title(&quot;Frequency response of the Hann window&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.ylabel(&quot;Magnitude [dB]&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.xlabel(&quot;Normalized frequency [cycles per sample]&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.axis(&#39;tight&#39;); plt.show()</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>M</span> <span class='op'>&lt;</span> <span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>array</span><span class='op'>(</span><span class='op'>[</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>M</span> <span class='op'>==</span> <span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>ones</span><span class='op'>(</span><span class='num'>1</span><span class='op'>,</span> <span class='nam'>float</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>n</span> <span class='op'>=</span> <span class='nam'>arange</span><span class='op'>(</span><span class='num'>0</span><span class='op'>,</span><span class='nam'>M</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='num'>0.5</span><span class='op'>-</span><span class='num'>0.5</span><span class='op'>*</span><span class='nam'>cos</span><span class='op'>(</span><span class='num'>2.0</span><span class='op'>*</span><span class='nam'>pi</span><span class='op'>*</span><span class='nam'>n</span><span class='op'>/</span><span class='op'>(</span><span class='nam'>M</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>hamming</span><span class='op'>(</span><span class='nam'>M</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return the Hamming window.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The Hamming window is a taper formed by using a weighted cosine.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; M : int</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Number of points in the output window. If zero or less, an</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; empty array is returned.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The window, normalized to one (the value one</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; appears only if the number of samples is odd).</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; bartlett, blackman, hanning, kaiser</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The Hamming window is defined as</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. math::&nbsp; w(n) = 0.54 + 0.46cos\\left(\\frac{2\\pi{n}}{M-1}\\right)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; \\qquad 0 \\leq n \\leq M-1</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The Hamming was named for R. W. Hamming, an associate of J. W. Tukey and</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; is described in Blackman and Tukey. It was recommended for smoothing the</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; truncated autocovariance function in the time domain.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Most references to the Hamming window come from the signal processing</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; literature, where it is used as one of many windowing functions for</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; smoothing values.&nbsp; It is also known as an apodization (which means</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;removing the foot&quot;, i.e. smoothing discontinuities at the beginning</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; and end of the sampled signal) or tapering function.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; References</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [1] Blackman, R.B. and Tukey, J.W., (1958) The measurement of power</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; spectra, Dover Publications, New York.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [2] E.R. Kanasewich, &quot;Time Sequence Analysis in Geophysics&quot;, The</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; University of Alberta Press, 1975, pp. 109-110.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [3] Wikipedia, &quot;Window function&quot;,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; http://en.wikipedia.org/wiki/Window_function</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [4] W.H. Press,&nbsp; B.P. Flannery, S.A. Teukolsky, and W.T. Vetterling,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &quot;Numerical Recipes&quot;, Cambridge University Press, 1986, page 425.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; from numpy import hamming</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; hamming(12)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 0.08&nbsp; &nbsp; &nbsp; ,&nbsp; 0.15302337,&nbsp; 0.34890909,&nbsp; 0.60546483,&nbsp; 0.84123594,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.98136677,&nbsp; 0.98136677,&nbsp; 0.84123594,&nbsp; 0.60546483,&nbsp; 0.34890909,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0.15302337,&nbsp; 0.08&nbsp; &nbsp; &nbsp; ])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Plot the window and the frequency response:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; from numpy import clip, log10, array, hamming</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; from scipy.fftpack import fft, fftshift</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; import matplotlib.pyplot as plt</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; window = hamming(51)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.plot(window)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.title(&quot;Hamming window&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.ylabel(&quot;Amplitude&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.xlabel(&quot;Sample&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.show()</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; A = fft(window, 2048) / 25.5</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; mag = abs(fftshift(A))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; freq = linspace(-0.5,0.5,len(A))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; response = 20*log10(mag)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; response = clip(response,-100,100)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.plot(freq, response)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.title(&quot;Frequency response of Hamming window&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.ylabel(&quot;Magnitude [dB]&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.xlabel(&quot;Normalized frequency [cycles per sample]&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.axis(&#39;tight&#39;); plt.show()</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>M</span> <span class='op'>&lt;</span> <span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>array</span><span class='op'>(</span><span class='op'>[</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>M</span> <span class='op'>==</span> <span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>ones</span><span class='op'>(</span><span class='num'>1</span><span class='op'>,</span><span class='nam'>float</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>n</span> <span class='op'>=</span> <span class='nam'>arange</span><span class='op'>(</span><span class='num'>0</span><span class='op'>,</span><span class='nam'>M</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='num'>0.54</span><span class='op'>-</span><span class='num'>0.46</span><span class='op'>*</span><span class='nam'>cos</span><span class='op'>(</span><span class='num'>2.0</span><span class='op'>*</span><span class='nam'>pi</span><span class='op'>*</span><span class='nam'>n</span><span class='op'>/</span><span class='op'>(</span><span class='nam'>M</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'>## Code from cephes for i0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='nam'>_i0A</span> <span class='op'>=</span> <span class='op'>[</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>4.41534164647933937950E-18</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>3.33079451882223809783E-17</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>2.43127984654795469359E-16</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>1.71539128555513303061E-15</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>1.16853328779934516808E-14</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>7.67618549860493561688E-14</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>4.85644678311192946090E-13</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>2.95505266312963983461E-12</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>1.72682629144155570723E-11</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>9.67580903537323691224E-11</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>5.18979560163526290666E-10</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>2.65982372468238665035E-9</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>1.30002500998624804212E-8</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>6.04699502254191894932E-8</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>2.67079385394061173391E-7</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>1.11738753912010371815E-6</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>4.41673835845875056359E-6</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>1.64484480707288970893E-5</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>5.75419501008210370398E-5</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>1.88502885095841655729E-4</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>5.76375574538582365885E-4</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>1.63947561694133579842E-3</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>4.32430999505057594430E-3</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>1.05464603945949983183E-2</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>2.37374148058994688156E-2</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>4.93052842396707084878E-2</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>9.49010970480476444210E-2</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>1.71620901522208775349E-1</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>3.04682672343198398683E-1</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>6.76795274409476084995E-1</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='nam'>_i0B</span> <span class='op'>=</span> <span class='op'>[</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>7.23318048787475395456E-18</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>4.83050448594418207126E-18</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>4.46562142029675999901E-17</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>3.46122286769746109310E-17</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>2.82762398051658348494E-16</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>3.42548561967721913462E-16</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>1.77256013305652638360E-15</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>3.81168066935262242075E-15</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>9.55484669882830764870E-15</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>4.15056934728722208663E-14</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>1.54008621752140982691E-14</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>3.85277838274214270114E-13</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>7.18012445138366623367E-13</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>1.79417853150680611778E-12</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>1.32158118404477131188E-11</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='op'>-</span><span class='num'>3.14991652796324136454E-11</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>1.18891471078464383424E-11</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>4.94060238822496958910E-10</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>3.39623202570838634515E-9</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>2.26666899049817806459E-8</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>2.04891858946906374183E-7</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>2.89137052083475648297E-6</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>6.88975834691682398426E-5</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>3.36911647825569408990E-3</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'> <span class='num'>8.04490411014108831608E-1</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>_chbevl</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>,</span> <span class='nam'>vals</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>b0</span> <span class='op'>=</span> <span class='nam'>vals</span><span class='op'>[</span><span class='num'>0</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>b1</span> <span class='op'>=</span> <span class='num'>0.0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>i</span> <span class='key'>in</span> <span class='nam'>xrange</span><span class='op'>(</span><span class='num'>1</span><span class='op'>,</span><span class='nam'>len</span><span class='op'>(</span><span class='nam'>vals</span><span class='op'>)</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>b2</span> <span class='op'>=</span> <span class='nam'>b1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>b1</span> <span class='op'>=</span> <span class='nam'>b0</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>b0</span> <span class='op'>=</span> <span class='nam'>x</span><span class='op'>*</span><span class='nam'>b1</span> <span class='op'>-</span> <span class='nam'>b2</span> <span class='op'>+</span> <span class='nam'>vals</span><span class='op'>[</span><span class='nam'>i</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='num'>0.5</span><span class='op'>*</span><span class='op'>(</span><span class='nam'>b0</span> <span class='op'>-</span> <span class='nam'>b2</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>_i0_1</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>exp</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>)</span> <span class='op'>*</span> <span class='nam'>_chbevl</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>/</span><span class='num'>2.0</span><span class='op'>-</span><span class='num'>2</span><span class='op'>,</span> <span class='nam'>_i0A</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>_i0_2</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>exp</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>)</span> <span class='op'>*</span> <span class='nam'>_chbevl</span><span class='op'>(</span><span class='num'>32.0</span><span class='op'>/</span><span class='nam'>x</span> <span class='op'>-</span> <span class='num'>2.0</span><span class='op'>,</span> <span class='nam'>_i0B</span><span class='op'>)</span> <span class='op'>/</span> <span class='nam'>sqrt</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>i0</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Modified Bessel function of the first kind, order 0.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Usually denoted :math:`I_0`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; x : array_like, dtype float or complex</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Argument of the Bessel function.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : ndarray, shape z.shape, dtype z.dtype</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The modified Bessel function evaluated at the elements of `x`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; scipy.special.iv, scipy.special.ive</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; References</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [1] M. Abramowitz and I.A. Stegun, &quot;Handbook of Mathematical Functions&quot;,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 10th printing, 1964, pp. 374. http://www.math.sfu.ca/~cbm/aands/</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [2] Wikipedia, &quot;Bessel function&quot;,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; http://en.wikipedia.org/wiki/Bessel_function</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.i0([0.])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array(1.0)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.i0([0., 1. + 2j])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 1.00000000+0.j&nbsp; &nbsp; &nbsp; &nbsp; ,&nbsp; 0.18785373+0.64616944j])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>x</span> <span class='op'>=</span> <span class='nam'>atleast_1d</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>copy</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>y</span> <span class='op'>=</span> <span class='nam'>empty_like</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>ind</span> <span class='op'>=</span> <span class='op'>(</span><span class='nam'>x</span><span class='op'>&lt;</span><span class='num'>0</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>x</span><span class='op'>[</span><span class='nam'>ind</span><span class='op'>]</span> <span class='op'>=</span> <span class='op'>-</span><span class='nam'>x</span><span class='op'>[</span><span class='nam'>ind</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>ind</span> <span class='op'>=</span> <span class='op'>(</span><span class='nam'>x</span><span class='op'>&lt;=</span><span class='num'>8.0</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>y</span><span class='op'>[</span><span class='nam'>ind</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>_i0_1</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>[</span><span class='nam'>ind</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>ind2</span> <span class='op'>=</span> <span class='op'>~</span><span class='nam'>ind</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>y</span><span class='op'>[</span><span class='nam'>ind2</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>_i0_2</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>[</span><span class='nam'>ind2</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>y</span><span class='op'>.</span><span class='nam'>squeeze</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'>## End of cephes code for i0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>kaiser</span><span class='op'>(</span><span class='nam'>M</span><span class='op'>,</span><span class='nam'>beta</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return the Kaiser window.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The Kaiser window is a taper formed by using a Bessel function.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; M : int</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Number of points in the output window. If zero or less, an</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; empty array is returned.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; beta : float</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Shape parameter for window.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : array</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The window, normalized to one (the value one</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; appears only if the number of samples is odd).</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; bartlett, blackman, hamming, hanning</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The Kaiser window is defined as</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. math::&nbsp; w(n) = I_0\\left( \\beta \\sqrt{1-\\frac{4n^2}{(M-1)^2}}</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; \\right)/I_0(\\beta)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; with</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. math:: \\quad -\\frac{M-1}{2} \\leq n \\leq \\frac{M-1}{2},</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; where :math:`I_0` is the modified zeroth-order Bessel function.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The Kaiser was named for Jim Kaiser, who discovered a simple approximation</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; to the DPSS window based on Bessel functions.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The Kaiser window is a very good approximation to the Digital Prolate</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Spheroidal Sequence, or Slepian window, which is the transform which</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; maximizes the energy in the main lobe of the window relative to total</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; energy.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The Kaiser can approximate many other windows by varying the beta</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; parameter.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ====&nbsp; =======================</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; beta&nbsp; Window shape</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ====&nbsp; =======================</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 0&nbsp; &nbsp;&nbsp; Rectangular</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 5&nbsp; &nbsp;&nbsp; Similar to a Hamming</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 6&nbsp; &nbsp;&nbsp; Similar to a Hanning</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 8.6&nbsp;&nbsp; Similar to a Blackman</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ====&nbsp; =======================</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; A beta value of 14 is probably a good starting point. Note that as beta</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; gets large, the window narrows, and so the number of samples needs to be</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; large enough to sample the increasingly narrow spike, otherwise nans will</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; get returned.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Most references to the Kaiser window come from the signal processing</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; literature, where it is used as one of many windowing functions for</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; smoothing values.&nbsp; It is also known as an apodization (which means</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;removing the foot&quot;, i.e. smoothing discontinuities at the beginning</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; and end of the sampled signal) or tapering function.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; References</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [1] J. F. Kaiser, &quot;Digital Filters&quot; - Ch 7 in &quot;Systems analysis by</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; digital computer&quot;, Editors: F.F. Kuo and J.F. Kaiser, p 218-285.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; John Wiley and Sons, New York, (1966).</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [2] E.R. Kanasewich, &quot;Time Sequence Analysis in Geophysics&quot;, The</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; University of Alberta Press, 1975, pp. 177-178.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [3] Wikipedia, &quot;Window function&quot;,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; http://en.wikipedia.org/wiki/Window_function</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; from numpy import kaiser</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; kaiser(12, 14)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([&nbsp; 7.72686684e-06,&nbsp;&nbsp; 3.46009194e-03,&nbsp;&nbsp; 4.65200189e-02,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 2.29737120e-01,&nbsp;&nbsp; 5.99885316e-01,&nbsp;&nbsp; 9.45674898e-01,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 9.45674898e-01,&nbsp;&nbsp; 5.99885316e-01,&nbsp;&nbsp; 2.29737120e-01,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 4.65200189e-02,&nbsp;&nbsp; 3.46009194e-03,&nbsp;&nbsp; 7.72686684e-06])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Plot the window and the frequency response:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; from numpy import clip, log10, array, kaiser</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; from scipy.fftpack import fft, fftshift</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; import matplotlib.pyplot as plt</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; window = kaiser(51, 14)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.plot(window)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.title(&quot;Kaiser window&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.ylabel(&quot;Amplitude&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.xlabel(&quot;Sample&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.show()</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; A = fft(window, 2048) / 25.5</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; mag = abs(fftshift(A))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; freq = linspace(-0.5,0.5,len(A))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; response = 20*log10(mag)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; response = clip(response,-100,100)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.plot(freq, response)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.title(&quot;Frequency response of Kaiser window&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.ylabel(&quot;Magnitude [dB]&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.xlabel(&quot;Normalized frequency [cycles per sample]&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.axis(&#39;tight&#39;); plt.show()</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>from</span> <span class='nam'>numpy</span><span class='op'>.</span><span class='nam'>dual</span> <span class='key'>import</span> <span class='nam'>i0</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>n</span> <span class='op'>=</span> <span class='nam'>arange</span><span class='op'>(</span><span class='num'>0</span><span class='op'>,</span><span class='nam'>M</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>alpha</span> <span class='op'>=</span> <span class='op'>(</span><span class='nam'>M</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='op'>/</span><span class='num'>2.0</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>i0</span><span class='op'>(</span><span class='nam'>beta</span> <span class='op'>*</span> <span class='nam'>sqrt</span><span class='op'>(</span><span class='num'>1</span><span class='op'>-</span><span class='op'>(</span><span class='op'>(</span><span class='nam'>n</span><span class='op'>-</span><span class='nam'>alpha</span><span class='op'>)</span><span class='op'>/</span><span class='nam'>alpha</span><span class='op'>)</span><span class='op'>**</span><span class='num'>2.0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='nam'>i0</span><span class='op'>(</span><span class='nam'>beta</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>sinc</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return the sinc function.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The sinc function is :math:`\\sin(\\pi x)/(\\pi x)`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; x : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Array (possibly multi-dimensional) of values for which to to</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; calculate ``sinc(x)``.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; ``sinc(x)``, which has the same shape as the input.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ``sinc(0)`` is the limit value 1.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The name sinc is short for &quot;sine cardinal&quot; or &quot;sinus cardinalis&quot;.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The sinc function is used in various signal processing applications,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; including in anti-aliasing, in the construction of a</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Lanczos resampling filter, and in interpolation.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; For bandlimited interpolation of discrete-time signals, the ideal</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; interpolation kernel is proportional to the sinc function.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; References</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [1] Weisstein, Eric W. &quot;Sinc Function.&quot; From MathWorld--A Wolfram Web</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; Resource. http://mathworld.wolfram.com/SincFunction.html</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. [2] Wikipedia, &quot;Sinc function&quot;,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; http://en.wikipedia.org/wiki/Sinc_function</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; x = np.arange(-20., 21.)/5.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.sinc(x)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ -3.89804309e-17,&nbsp; -4.92362781e-02,&nbsp; -8.40918587e-02,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -8.90384387e-02,&nbsp; -5.84680802e-02,&nbsp;&nbsp; 3.89804309e-17,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 6.68206631e-02,&nbsp;&nbsp; 1.16434881e-01,&nbsp;&nbsp; 1.26137788e-01,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 8.50444803e-02,&nbsp; -3.89804309e-17,&nbsp; -1.03943254e-01,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -1.89206682e-01,&nbsp; -2.16236208e-01,&nbsp; -1.55914881e-01,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 3.89804309e-17,&nbsp;&nbsp; 2.33872321e-01,&nbsp;&nbsp; 5.04551152e-01,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 7.56826729e-01,&nbsp;&nbsp; 9.35489284e-01,&nbsp;&nbsp; 1.00000000e+00,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 9.35489284e-01,&nbsp;&nbsp; 7.56826729e-01,&nbsp;&nbsp; 5.04551152e-01,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 2.33872321e-01,&nbsp;&nbsp; 3.89804309e-17,&nbsp; -1.55914881e-01,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -2.16236208e-01,&nbsp; -1.89206682e-01,&nbsp; -1.03943254e-01,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -3.89804309e-17,&nbsp;&nbsp; 8.50444803e-02,&nbsp;&nbsp; 1.26137788e-01,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 1.16434881e-01,&nbsp;&nbsp; 6.68206631e-02,&nbsp;&nbsp; 3.89804309e-17,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -5.84680802e-02,&nbsp; -8.90384387e-02,&nbsp; -8.40918587e-02,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -4.92362781e-02,&nbsp; -3.89804309e-17])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; import matplotlib.pyplot as plt</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.plot(x, sinc(x))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.title(&quot;Sinc Function&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.ylabel(&quot;Amplitude&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.xlabel(&quot;X&quot;)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.show()</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; It works in 2-D as well:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; x = np.arange(-200., 201.)/50.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; xx = np.outer(x, x)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; plt.imshow(sinc(xx))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>y</span> <span class='op'>=</span> <span class='nam'>pi</span><span class='op'>*</span> <span class='nam'>where</span><span class='op'>(</span><span class='nam'>x</span> <span class='op'>==</span> <span class='num'>0</span><span class='op'>,</span> <span class='num'>1.0e-20</span><span class='op'>,</span> <span class='nam'>x</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>sin</span><span class='op'>(</span><span class='nam'>y</span><span class='op'>)</span><span class='op'>/</span><span class='nam'>y</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>msort</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return a copy of an array sorted along the first axis.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; a : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Array to be sorted.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; sorted_array : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Array of the same type and shape as `a`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; sort</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ``np.msort(a)`` is equivalent to&nbsp; ``np.sort(a, axis=0)``.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>b</span> <span class='op'>=</span> <span class='nam'>array</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>,</span><span class='nam'>subok</span><span class='op'>=</span><span class='nam'>True</span><span class='op'>,</span><span class='nam'>copy</span><span class='op'>=</span><span class='nam'>True</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>b</span><span class='op'>.</span><span class='nam'>sort</span><span class='op'>(</span><span class='num'>0</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>b</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>median</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>,</span> <span class='nam'>out</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>,</span> <span class='nam'>overwrite_input</span><span class='op'>=</span><span class='nam'>False</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Compute the median along the specified axis.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns the median of the array elements.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; a : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Input array or object that can be converted to an array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; axis : {None, int}, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Axis along which the medians are computed. The default (axis=None) is to</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; compute the median along a flattened version of the array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : ndarray, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Alternative output array in which to place the result. It must</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; have the same shape and buffer length as the expected output,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; but the type (of the output) will be cast if necessary.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; overwrite_input : {False, True}, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp;&nbsp; If True, then allow use of memory of input array (a) for</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp;&nbsp; calculations. The input array will be modified by the call to</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp;&nbsp; median. This will save memory when you do not need to preserve</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp;&nbsp; the contents of the input array. Treat the input as undefined,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp;&nbsp; but it will probably be fully or partially sorted. Default is</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp;&nbsp; False. Note that, if `overwrite_input` is True and the input</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp;&nbsp; is not already an ndarray, an error will be raised.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; median : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; A new array holding the result (unless `out` is specified, in</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; which case that array is returned instead).&nbsp; If the input contains</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; integers, or floats of smaller precision than 64, then the output</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; data-type is float64.&nbsp; Otherwise, the output data-type is the same</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; as that of the input.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; mean</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Given a vector V of length N, the median of V is the middle value of</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; a sorted copy of V, ``V_sorted`` - i.e., ``V_sorted[(N-1)/2]``, when N is</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; odd.&nbsp; When N is even, it is the average of the two middle values of</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ``V_sorted``.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; a = np.array([[10, 7, 4], [3, 2, 1]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; a</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([[10,&nbsp; 7,&nbsp; 4],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [ 3,&nbsp; 2,&nbsp; 1]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.median(a)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 3.5</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.median(a, axis=0)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 6.5,&nbsp; 4.5,&nbsp; 2.5])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.median(a, axis=1)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 7.,&nbsp; 2.])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; m = np.median(a, axis=0)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; out = np.zeros_like(m)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.median(a, axis=0, out=m)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 6.5,&nbsp; 4.5,&nbsp; 2.5])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; m</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 6.5,&nbsp; 4.5,&nbsp; 2.5])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; b = a.copy()</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.median(b, axis=1, overwrite_input=True)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 7.,&nbsp; 2.])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; assert not np.all(a==b)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; b = a.copy()</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.median(b, axis=None, overwrite_input=True)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 3.5</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; assert not np.all(a==b)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>overwrite_input</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>axis</span> <span class='key'>is</span> <span class='nam'>None</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>sorted</span> <span class='op'>=</span> <span class='nam'>a</span><span class='op'>.</span><span class='nam'>ravel</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>sorted</span><span class='op'>.</span><span class='nam'>sort</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>a</span><span class='op'>.</span><span class='nam'>sort</span><span class='op'>(</span><span class='nam'>axis</span><span class='op'>=</span><span class='nam'>axis</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>sorted</span> <span class='op'>=</span> <span class='nam'>a</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>sorted</span> <span class='op'>=</span> <span class='nam'>sort</span><span class='op'>(</span><span class='nam'>a</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='nam'>axis</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>axis</span> <span class='key'>is</span> <span class='nam'>None</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>axis</span> <span class='op'>=</span> <span class='num'>0</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>indexer</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>*</span> <span class='nam'>sorted</span><span class='op'>.</span><span class='nam'>ndim</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>index</span> <span class='op'>=</span> <span class='nam'>int</span><span class='op'>(</span><span class='nam'>sorted</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span><span class='op'>/</span><span class='num'>2</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>sorted</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>%</span> <span class='num'>2</span> <span class='op'>==</span> <span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># index with slice to allow mean (below) to work</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>indexer</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='nam'>index</span><span class='op'>,</span> <span class='nam'>index</span><span class='op'>+</span><span class='num'>1</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>indexer</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='nam'>index</span><span class='op'>-</span><span class='num'>1</span><span class='op'>,</span> <span class='nam'>index</span><span class='op'>+</span><span class='num'>1</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># Use mean in odd and even case to coerce data type</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># and check, use out array.</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>mean</span><span class='op'>(</span><span class='nam'>sorted</span><span class='op'>[</span><span class='nam'>indexer</span><span class='op'>]</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='nam'>axis</span><span class='op'>,</span> <span class='nam'>out</span><span class='op'>=</span><span class='nam'>out</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>trapz</span><span class='op'>(</span><span class='nam'>y</span><span class='op'>,</span> <span class='nam'>x</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>,</span> <span class='nam'>dx</span><span class='op'>=</span><span class='num'>1.0</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Integrate along the given axis using the composite trapezoidal rule.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Integrate `y` (`x`) along given axis.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; y : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Input array to integrate.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; x : array_like, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; If `x` is None, then spacing between all `y` elements is 1.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; dx : scalar, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; If `x` is None, spacing given by `dx` is assumed.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; axis : int, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Specify the axis.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.trapz([1,2,3])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; 4.0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.trapz([1,2,3], [4,6,8])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; 8.0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>y</span> <span class='op'>=</span> <span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>y</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>x</span> <span class='key'>is</span> <span class='nam'>None</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>d</span> <span class='op'>=</span> <span class='nam'>dx</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>d</span> <span class='op'>=</span> <span class='nam'>diff</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>,</span><span class='nam'>axis</span><span class='op'>=</span><span class='nam'>axis</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>nd</span> <span class='op'>=</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>y</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>slice1</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>]</span><span class='op'>*</span><span class='nam'>nd</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>slice2</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>]</span><span class='op'>*</span><span class='nam'>nd</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>slice1</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='num'>1</span><span class='op'>,</span><span class='nam'>None</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>slice2</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>,</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>add</span><span class='op'>.</span><span class='nam'>reduce</span><span class='op'>(</span><span class='nam'>d</span> <span class='op'>*</span> <span class='op'>(</span><span class='nam'>y</span><span class='op'>[</span><span class='nam'>slice1</span><span class='op'>]</span><span class='op'>+</span><span class='nam'>y</span><span class='op'>[</span><span class='nam'>slice2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>/</span><span class='num'>2.0</span><span class='op'>,</span><span class='nam'>axis</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'>#always succeed</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>add_newdoc</span><span class='op'>(</span><span class='nam'>place</span><span class='op'>,</span> <span class='nam'>obj</span><span class='op'>,</span> <span class='nam'>doc</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;Adds documentation to obj which is in module place.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; If doc is a string add it to obj as a docstring</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; If doc is a tuple, then the first element is interpreted as</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp;&nbsp; an attribute of obj and the second as the docstring</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (method, docstring)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; If doc is a list, then each element of the list should be a</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp;&nbsp; sequence of length two --&gt; [(method1, docstring1),</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp;&nbsp; (method2, docstring2), ...]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; This routine never raises an error.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp;&nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'>&nbsp; &nbsp; <span class='key'>try</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>new</span> <span class='op'>=</span> <span class='op'>{</span><span class='op'>}</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>exec</span> <span class='str'>&#39;from %s import %s&#39;</span> <span class='op'>%</span> <span class='op'>(</span><span class='nam'>place</span><span class='op'>,</span> <span class='nam'>obj</span><span class='op'>)</span> <span class='key'>in</span> <span class='nam'>new</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>isinstance</span><span class='op'>(</span><span class='nam'>doc</span><span class='op'>,</span> <span class='nam'>str</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>add_docstring</span><span class='op'>(</span><span class='nam'>new</span><span class='op'>[</span><span class='nam'>obj</span><span class='op'>]</span><span class='op'>,</span> <span class='nam'>doc</span><span class='op'>.</span><span class='nam'>strip</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>elif</span> <span class='nam'>isinstance</span><span class='op'>(</span><span class='nam'>doc</span><span class='op'>,</span> <span class='nam'>tuple</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>add_docstring</span><span class='op'>(</span><span class='nam'>getattr</span><span class='op'>(</span><span class='nam'>new</span><span class='op'>[</span><span class='nam'>obj</span><span class='op'>]</span><span class='op'>,</span> <span class='nam'>doc</span><span class='op'>[</span><span class='num'>0</span><span class='op'>]</span><span class='op'>)</span><span class='op'>,</span> <span class='nam'>doc</span><span class='op'>[</span><span class='num'>1</span><span class='op'>]</span><span class='op'>.</span><span class='nam'>strip</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>elif</span> <span class='nam'>isinstance</span><span class='op'>(</span><span class='nam'>doc</span><span class='op'>,</span> <span class='nam'>list</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>for</span> <span class='nam'>val</span> <span class='key'>in</span> <span class='nam'>doc</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>add_docstring</span><span class='op'>(</span><span class='nam'>getattr</span><span class='op'>(</span><span class='nam'>new</span><span class='op'>[</span><span class='nam'>obj</span><span class='op'>]</span><span class='op'>,</span> <span class='nam'>val</span><span class='op'>[</span><span class='num'>0</span><span class='op'>]</span><span class='op'>)</span><span class='op'>,</span> <span class='nam'>val</span><span class='op'>[</span><span class='num'>1</span><span class='op'>]</span><span class='op'>.</span><span class='nam'>strip</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'>&nbsp; &nbsp; <span class='key'>except</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>pass</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'># From matplotlib</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>meshgrid</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>,</span><span class='nam'>y</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return coordinate matrices from two coordinate vectors.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; x, y : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Two 1D arrays representing the x and y coordinates</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; X, Y : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; For vectors `x`, `y` with lengths Nx=len(`x`) and Ny=len(`y`),</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; return `X`, `Y` where `X` and `Y` are (Ny, Nx) shaped arrays</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; with the elements of `x` and y repeated to fill the matrix along</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; the first dimension for `x`, the second for `y`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; numpy.mgrid : Construct a multi-dimensional &quot;meshgrid&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; using indexing notation.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; X, Y = numpy.meshgrid([1,2,3], [4,5,6,7])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; X</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([[1, 2, 3],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [1, 2, 3],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [1, 2, 3],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [1, 2, 3]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; Y</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([[4, 4, 4],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [5, 5, 5],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [6, 6, 6],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [7, 7, 7]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>x</span> <span class='op'>=</span> <span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>y</span> <span class='op'>=</span> <span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>y</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>numRows</span><span class='op'>,</span> <span class='nam'>numCols</span> <span class='op'>=</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>y</span><span class='op'>)</span><span class='op'>,</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>x</span><span class='op'>)</span>&nbsp; <span class='com'># yes, reversed</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>x</span> <span class='op'>=</span> <span class='nam'>x</span><span class='op'>.</span><span class='nam'>reshape</span><span class='op'>(</span><span class='num'>1</span><span class='op'>,</span><span class='nam'>numCols</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>X</span> <span class='op'>=</span> <span class='nam'>x</span><span class='op'>.</span><span class='nam'>repeat</span><span class='op'>(</span><span class='nam'>numRows</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='num'>0</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>y</span> <span class='op'>=</span> <span class='nam'>y</span><span class='op'>.</span><span class='nam'>reshape</span><span class='op'>(</span><span class='nam'>numRows</span><span class='op'>,</span><span class='num'>1</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>Y</span> <span class='op'>=</span> <span class='nam'>y</span><span class='op'>.</span><span class='nam'>repeat</span><span class='op'>(</span><span class='nam'>numCols</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='num'>1</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>X</span><span class='op'>,</span> <span class='nam'>Y</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>delete</span><span class='op'>(</span><span class='nam'>arr</span><span class='op'>,</span> <span class='nam'>obj</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return a new array with sub-arrays along an axis deleted.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; arr : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; Input array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; obj : slice, integer or an array of integers</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; Indicate which sub-arrays to remove.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; axis : integer, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; The axis along which to delete the subarray defined by `obj`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; If `axis` is None, `obj` is applied to the flattened array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; insert : Insert values into an array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; append : Append values at the end of an array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; arr = np.array([[1,2,3,4],[5,6,7,8],[9,10,11,12]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; arr</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([[ 1,&nbsp; 2,&nbsp; 3,&nbsp; 4],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [ 5,&nbsp; 6,&nbsp; 7,&nbsp; 8],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [ 9, 10, 11, 12]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.delete(arr, 1, 0)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([[ 1,&nbsp; 2,&nbsp; 3,&nbsp; 4],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [ 9, 10, 11, 12]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.delete(arr, np.s_[::2], 1)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([[ 2,&nbsp; 4],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [ 6,&nbsp; 8],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [10, 12]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.delete(arr, [1,3,5], None)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 1,&nbsp; 3,&nbsp; 5,&nbsp; 7,&nbsp; 8,&nbsp; 9, 10, 11, 12])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>wrap</span> <span class='op'>=</span> <span class='nam'>None</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>type</span><span class='op'>(</span><span class='nam'>arr</span><span class='op'>)</span> <span class='key'>is</span> <span class='key'>not</span> <span class='nam'>ndarray</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>try</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>wrap</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>__array_wrap__</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>except</span> <span class='nam'>AttributeError</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>pass</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>arr</span> <span class='op'>=</span> <span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>arr</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>ndim</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>ndim</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>axis</span> <span class='key'>is</span> <span class='nam'>None</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>ndim</span> <span class='op'>!=</span> <span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>arr</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>ravel</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>ndim</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>ndim</span><span class='op'>;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>axis</span> <span class='op'>=</span> <span class='nam'>ndim</span><span class='op'>-</span><span class='num'>1</span><span class='op'>;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>ndim</span> <span class='op'>==</span> <span class='num'>0</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>wrap</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>wrap</span><span class='op'>(</span><span class='nam'>arr</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>copy</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>slobj</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>]</span><span class='op'>*</span><span class='nam'>ndim</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>N</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>newshape</span> <span class='op'>=</span> <span class='nam'>list</span><span class='op'>(</span><span class='nam'>arr</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>isinstance</span><span class='op'>(</span><span class='nam'>obj</span><span class='op'>,</span> <span class='op'>(</span><span class='nam'>int</span><span class='op'>,</span> <span class='nam'>long</span><span class='op'>,</span> <span class='nam'>integer</span><span class='op'>)</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='op'>(</span><span class='nam'>obj</span> <span class='op'>&lt;</span> <span class='num'>0</span><span class='op'>)</span><span class='op'>:</span> <span class='nam'>obj</span> <span class='op'>+=</span> <span class='nam'>N</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='op'>(</span><span class='nam'>obj</span> <span class='op'>&lt;</span> <span class='num'>0</span> <span class='key'>or</span> <span class='nam'>obj</span> <span class='op'>&gt;=</span><span class='nam'>N</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>ValueError</span><span class='op'>,</span> <span class='str'>&quot;invalid entry&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>newshape</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span><span class='op'>-=</span><span class='num'>1</span><span class='op'>;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>new</span> <span class='op'>=</span> <span class='nam'>empty</span><span class='op'>(</span><span class='nam'>newshape</span><span class='op'>,</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>dtype</span><span class='op'>,</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>flags</span><span class='op'>.</span><span class='nam'>fnc</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slobj</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>,</span> <span class='nam'>obj</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>new</span><span class='op'>[</span><span class='nam'>slobj</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>[</span><span class='nam'>slobj</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slobj</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='nam'>obj</span><span class='op'>,</span><span class='nam'>None</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slobj2</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>]</span><span class='op'>*</span><span class='nam'>ndim</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slobj2</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='nam'>obj</span><span class='op'>+</span><span class='num'>1</span><span class='op'>,</span><span class='nam'>None</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>new</span><span class='op'>[</span><span class='nam'>slobj</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>[</span><span class='nam'>slobj2</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>elif</span> <span class='nam'>isinstance</span><span class='op'>(</span><span class='nam'>obj</span><span class='op'>,</span> <span class='nam'>slice</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>start</span><span class='op'>,</span> <span class='nam'>stop</span><span class='op'>,</span> <span class='nam'>step</span> <span class='op'>=</span> <span class='nam'>obj</span><span class='op'>.</span><span class='nam'>indices</span><span class='op'>(</span><span class='nam'>N</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>numtodel</span> <span class='op'>=</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>xrange</span><span class='op'>(</span><span class='nam'>start</span><span class='op'>,</span> <span class='nam'>stop</span><span class='op'>,</span> <span class='nam'>step</span><span class='op'>)</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>numtodel</span> <span class='op'>&lt;=</span> <span class='num'>0</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>wrap</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>wrap</span><span class='op'>(</span><span class='nam'>new</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>copy</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>newshape</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>-=</span> <span class='nam'>numtodel</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>new</span> <span class='op'>=</span> <span class='nam'>empty</span><span class='op'>(</span><span class='nam'>newshape</span><span class='op'>,</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>dtype</span><span class='op'>,</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>flags</span><span class='op'>.</span><span class='nam'>fnc</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># copy initial chunk</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>start</span> <span class='op'>==</span> <span class='num'>0</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>pass</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slobj</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>,</span> <span class='nam'>start</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>new</span><span class='op'>[</span><span class='nam'>slobj</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>[</span><span class='nam'>slobj</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># copy end chunck</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>stop</span> <span class='op'>==</span> <span class='nam'>N</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>pass</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slobj</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='nam'>stop</span><span class='op'>-</span><span class='nam'>numtodel</span><span class='op'>,</span><span class='nam'>None</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slobj2</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>]</span><span class='op'>*</span><span class='nam'>ndim</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slobj2</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='nam'>stop</span><span class='op'>,</span> <span class='nam'>None</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>new</span><span class='op'>[</span><span class='nam'>slobj</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>[</span><span class='nam'>slobj2</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># copy middle pieces</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>step</span> <span class='op'>==</span> <span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>pass</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span>&nbsp; <span class='com'># use array indexing.</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>obj</span> <span class='op'>=</span> <span class='nam'>arange</span><span class='op'>(</span><span class='nam'>start</span><span class='op'>,</span> <span class='nam'>stop</span><span class='op'>,</span> <span class='nam'>step</span><span class='op'>,</span> <span class='nam'>dtype</span><span class='op'>=</span><span class='nam'>intp</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>all</span> <span class='op'>=</span> <span class='nam'>arange</span><span class='op'>(</span><span class='nam'>start</span><span class='op'>,</span> <span class='nam'>stop</span><span class='op'>,</span> <span class='nam'>dtype</span><span class='op'>=</span><span class='nam'>intp</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>obj</span> <span class='op'>=</span> <span class='nam'>setdiff1d</span><span class='op'>(</span><span class='nam'>all</span><span class='op'>,</span> <span class='nam'>obj</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slobj</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='nam'>start</span><span class='op'>,</span> <span class='nam'>stop</span><span class='op'>-</span><span class='nam'>numtodel</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slobj2</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>]</span><span class='op'>*</span><span class='nam'>ndim</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slobj2</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>obj</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>new</span><span class='op'>[</span><span class='nam'>slobj</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>[</span><span class='nam'>slobj2</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span> <span class='com'># default behavior</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>obj</span> <span class='op'>=</span> <span class='nam'>array</span><span class='op'>(</span><span class='nam'>obj</span><span class='op'>,</span> <span class='nam'>dtype</span><span class='op'>=</span><span class='nam'>intp</span><span class='op'>,</span> <span class='nam'>copy</span><span class='op'>=</span><span class='num'>0</span><span class='op'>,</span> <span class='nam'>ndmin</span><span class='op'>=</span><span class='num'>1</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>all</span> <span class='op'>=</span> <span class='nam'>arange</span><span class='op'>(</span><span class='nam'>N</span><span class='op'>,</span> <span class='nam'>dtype</span><span class='op'>=</span><span class='nam'>intp</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>obj</span> <span class='op'>=</span> <span class='nam'>setdiff1d</span><span class='op'>(</span><span class='nam'>all</span><span class='op'>,</span> <span class='nam'>obj</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slobj</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>obj</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>new</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>[</span><span class='nam'>slobj</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>wrap</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>wrap</span><span class='op'>(</span><span class='nam'>new</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>new</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>insert</span><span class='op'>(</span><span class='nam'>arr</span><span class='op'>,</span> <span class='nam'>obj</span><span class='op'>,</span> <span class='nam'>values</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Insert values along the given axis before the given indices.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; arr : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Input array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; obj : {integer, slice, integer array_like}</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Insert `values` before `obj` indices.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; values :</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Values to insert into `arr`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; axis : int, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Axis along which to insert `values`.&nbsp; If `axis` is None then ravel</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; `arr` first.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; a = np.array([[1,2,3],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ...&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [4,5,6],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ...&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [7,8,9]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.insert(a, [1,2], [[4],[5]], axis=0)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([[1, 2, 3],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [4, 4, 4],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [4, 5, 6],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [5, 5, 5],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [7, 8, 9]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>wrap</span> <span class='op'>=</span> <span class='nam'>None</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>type</span><span class='op'>(</span><span class='nam'>arr</span><span class='op'>)</span> <span class='key'>is</span> <span class='key'>not</span> <span class='nam'>ndarray</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>try</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>wrap</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>__array_wrap__</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>except</span> <span class='nam'>AttributeError</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>pass</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>arr</span> <span class='op'>=</span> <span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>arr</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>ndim</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>ndim</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>axis</span> <span class='key'>is</span> <span class='nam'>None</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>ndim</span> <span class='op'>!=</span> <span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>arr</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>ravel</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>ndim</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>ndim</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>axis</span> <span class='op'>=</span> <span class='nam'>ndim</span><span class='op'>-</span><span class='num'>1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='op'>(</span><span class='nam'>ndim</span> <span class='op'>==</span> <span class='num'>0</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>arr</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>copy</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>arr</span><span class='op'>[</span><span class='op'>.</span><span class='op'>.</span><span class='op'>.</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>values</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>wrap</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>wrap</span><span class='op'>(</span><span class='nam'>arr</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>arr</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>slobj</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>]</span><span class='op'>*</span><span class='nam'>ndim</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>N</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>newshape</span> <span class='op'>=</span> <span class='nam'>list</span><span class='op'>(</span><span class='nam'>arr</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>isinstance</span><span class='op'>(</span><span class='nam'>obj</span><span class='op'>,</span> <span class='op'>(</span><span class='nam'>int</span><span class='op'>,</span> <span class='nam'>long</span><span class='op'>,</span> <span class='nam'>integer</span><span class='op'>)</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='op'>(</span><span class='nam'>obj</span> <span class='op'>&lt;</span> <span class='num'>0</span><span class='op'>)</span><span class='op'>:</span> <span class='nam'>obj</span> <span class='op'>+=</span> <span class='nam'>N</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>obj</span> <span class='op'>&lt;</span> <span class='num'>0</span> <span class='key'>or</span> <span class='nam'>obj</span> <span class='op'>&gt;</span> <span class='nam'>N</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>ValueError</span><span class='op'>,</span> <span class='str'>&quot;index (%d) out of range (0&lt;=index&lt;=%d) &quot;</span><span class='xx'>\</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='str'>&quot;in dimension %d&quot;</span> <span class='op'>%</span> <span class='op'>(</span><span class='nam'>obj</span><span class='op'>,</span> <span class='nam'>N</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>newshape</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>+=</span> <span class='num'>1</span><span class='op'>;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>new</span> <span class='op'>=</span> <span class='nam'>empty</span><span class='op'>(</span><span class='nam'>newshape</span><span class='op'>,</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>dtype</span><span class='op'>,</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>flags</span><span class='op'>.</span><span class='nam'>fnc</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slobj</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>,</span> <span class='nam'>obj</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>new</span><span class='op'>[</span><span class='nam'>slobj</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>[</span><span class='nam'>slobj</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slobj</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>obj</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>new</span><span class='op'>[</span><span class='nam'>slobj</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>values</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slobj</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='nam'>obj</span><span class='op'>+</span><span class='num'>1</span><span class='op'>,</span><span class='nam'>None</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slobj2</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>]</span><span class='op'>*</span><span class='nam'>ndim</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>slobj2</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>slice</span><span class='op'>(</span><span class='nam'>obj</span><span class='op'>,</span><span class='nam'>None</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>new</span><span class='op'>[</span><span class='nam'>slobj</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>[</span><span class='nam'>slobj2</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>wrap</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>wrap</span><span class='op'>(</span><span class='nam'>new</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>new</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>elif</span> <span class='nam'>isinstance</span><span class='op'>(</span><span class='nam'>obj</span><span class='op'>,</span> <span class='nam'>slice</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># turn it into a range object</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>obj</span> <span class='op'>=</span> <span class='nam'>arange</span><span class='op'>(</span><span class='op'>*</span><span class='nam'>obj</span><span class='op'>.</span><span class='nam'>indices</span><span class='op'>(</span><span class='nam'>N</span><span class='op'>)</span><span class='op'>,</span><span class='op'>**</span><span class='op'>{</span><span class='str'>&#39;dtype&#39;</span><span class='op'>:</span><span class='nam'>intp</span><span class='op'>}</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># get two sets of indices</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'>#&nbsp; one is the indices which will hold the new stuff</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'>#&nbsp; two is the indices where arr will be copied over</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>obj</span> <span class='op'>=</span> <span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>obj</span><span class='op'>,</span> <span class='nam'>dtype</span><span class='op'>=</span><span class='nam'>intp</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>numnew</span> <span class='op'>=</span> <span class='nam'>len</span><span class='op'>(</span><span class='nam'>obj</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>index1</span> <span class='op'>=</span> <span class='nam'>obj</span> <span class='op'>+</span> <span class='nam'>arange</span><span class='op'>(</span><span class='nam'>numnew</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>index2</span> <span class='op'>=</span> <span class='nam'>setdiff1d</span><span class='op'>(</span><span class='nam'>arange</span><span class='op'>(</span><span class='nam'>numnew</span><span class='op'>+</span><span class='nam'>N</span><span class='op'>)</span><span class='op'>,</span><span class='nam'>index1</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>newshape</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>+=</span> <span class='nam'>numnew</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>new</span> <span class='op'>=</span> <span class='nam'>empty</span><span class='op'>(</span><span class='nam'>newshape</span><span class='op'>,</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>dtype</span><span class='op'>,</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>flags</span><span class='op'>.</span><span class='nam'>fnc</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>slobj2</span> <span class='op'>=</span> <span class='op'>[</span><span class='nam'>slice</span><span class='op'>(</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>]</span><span class='op'>*</span><span class='nam'>ndim</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>slobj</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>index1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>slobj2</span><span class='op'>[</span><span class='nam'>axis</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>index2</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>new</span><span class='op'>[</span><span class='nam'>slobj</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>values</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>new</span><span class='op'>[</span><span class='nam'>slobj2</span><span class='op'>]</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>wrap</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>wrap</span><span class='op'>(</span><span class='nam'>new</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>new</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>append</span><span class='op'>(</span><span class='nam'>arr</span><span class='op'>,</span> <span class='nam'>values</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='nam'>None</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Append values to the end of an array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; arr : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Values are appended to a copy of this array.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; values : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; These values are appended to a copy of `arr`.&nbsp; It must be of the</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; correct shape (the same shape as `arr`, excluding `axis`).&nbsp; If `axis`</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; is not specified, `values` can be any shape and will be flattened</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; before use.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; axis : int, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The axis along which `values` are appended.&nbsp; If `axis` is not given,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; both `arr` and `values` are flattened before use.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; A copy of `arr` with `values` appended to `axis`.&nbsp; Note that `append`</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; does not occur in-place: a new array is allocated and filled.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.append([1, 2, 3], [[4, 5, 6], [7, 8, 9]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([1, 2, 3, 4, 5, 6, 7, 8, 9])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.append([[1, 2, 3], [4, 5, 6]], [[7, 8, 9]], axis=0)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([[1, 2, 3],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [4, 5, 6],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [7, 8, 9]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>arr</span> <span class='op'>=</span> <span class='nam'>asanyarray</span><span class='op'>(</span><span class='nam'>arr</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>axis</span> <span class='key'>is</span> <span class='nam'>None</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>ndim</span> <span class='op'>!=</span> <span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>arr</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>ravel</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>values</span> <span class='op'>=</span> <span class='nam'>ravel</span><span class='op'>(</span><span class='nam'>values</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>axis</span> <span class='op'>=</span> <span class='nam'>arr</span><span class='op'>.</span><span class='nam'>ndim</span><span class='op'>-</span><span class='num'>1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>concatenate</span><span class='op'>(</span><span class='op'>(</span><span class='nam'>arr</span><span class='op'>,</span> <span class='nam'>values</span><span class='op'>)</span><span class='op'>,</span> <span class='nam'>axis</span><span class='op'>=</span><span class='nam'>axis</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
    
</td>
</tr>
</table>
</div>

</body>
</html>
