<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv='Content-Type' content='text/html; charset=utf-8'>
<title>Coverage for /System/Library/Frameworks/Python.framework/Versions/2.6/Extras/lib/python/numpy/lib/financial</title>
<link rel='stylesheet' href='style.css' type='text/css'>
<script type='text/javascript' src='jquery-1.3.2.min.js'></script>
<script type='text/javascript'>
function toggle_lines(btn, cls) {
    var btn = $(btn);
    var hide = "hide_"+cls;
    if (btn.hasClass(hide)) {
        $("#source ."+cls).removeClass(hide);
        btn.removeClass(hide);
    }
    else {
        $("#source ."+cls).addClass(hide);
        btn.addClass(hide);
    }
}
</script>
</head>
<body>
<div id='header'>
    <div class='content'>
        <h1>Coverage for <b>/System/Library/Frameworks/Python.framework/Versions/2.6/Extras/lib/python/numpy/lib/financial</b> :
            <span class='pc_cov'>16%</span>
        </h1>
        <h2 class='stats'>
            92 statements
            <span class='run hide_run' onclick='toggle_lines(this, "run")'>15 run</span>
            <span class='exc' onclick='toggle_lines(this, "exc")'>0 excluded</span>
            <span class='mis' onclick='toggle_lines(this, "mis")'>77 missing</span>
            
        </h2>
    </div>
</div>

<div id='source'>
<table cellspacing='0' cellpadding='0'>
<tr>
<td class='linenos' valign='top'>
<p class='pln'>1</p>
<p class='pln'>2</p>
<p class='pln'>3</p>
<p class='pln'>4</p>
<p class='pln'>5</p>
<p class='pln'>6</p>
<p class='pln'>7</p>
<p class='stm run hide_run'>8</p>
<p class='pln'>9</p>
<p class='stm run hide_run'>10</p>
<p class='pln'>11</p>
<p class='pln'>12</p>
<p class='stm run hide_run'>13</p>
<p class='pln'>14</p>
<p class='pln'>15</p>
<p class='pln'>16</p>
<p class='pln'>17</p>
<p class='pln'>18</p>
<p class='pln'>19</p>
<p class='stm run hide_run'>20</p>
<p class='stm mis'>21</p>
<p class='stm mis'>22</p>
<p class='stm mis'>23</p>
<p class='stm mis'>24</p>
<p class='pln'>25</p>
<p class='pln'>26</p>
<p class='stm run hide_run'>27</p>
<p class='pln'>28</p>
<p class='pln'>29</p>
<p class='pln'>30</p>
<p class='pln'>31</p>
<p class='pln'>32</p>
<p class='pln'>33</p>
<p class='pln'>34</p>
<p class='pln'>35</p>
<p class='pln'>36</p>
<p class='pln'>37</p>
<p class='pln'>38</p>
<p class='pln'>39</p>
<p class='pln'>40</p>
<p class='pln'>41</p>
<p class='pln'>42</p>
<p class='pln'>43</p>
<p class='pln'>44</p>
<p class='pln'>45</p>
<p class='pln'>46</p>
<p class='pln'>47</p>
<p class='pln'>48</p>
<p class='pln'>49</p>
<p class='pln'>50</p>
<p class='pln'>51</p>
<p class='pln'>52</p>
<p class='pln'>53</p>
<p class='pln'>54</p>
<p class='pln'>55</p>
<p class='pln'>56</p>
<p class='pln'>57</p>
<p class='pln'>58</p>
<p class='pln'>59</p>
<p class='pln'>60</p>
<p class='pln'>61</p>
<p class='pln'>62</p>
<p class='pln'>63</p>
<p class='pln'>64</p>
<p class='pln'>65</p>
<p class='pln'>66</p>
<p class='pln'>67</p>
<p class='pln'>68</p>
<p class='pln'>69</p>
<p class='pln'>70</p>
<p class='pln'>71</p>
<p class='pln'>72</p>
<p class='pln'>73</p>
<p class='pln'>74</p>
<p class='pln'>75</p>
<p class='pln'>76</p>
<p class='pln'>77</p>
<p class='pln'>78</p>
<p class='pln'>79</p>
<p class='pln'>80</p>
<p class='pln'>81</p>
<p class='pln'>82</p>
<p class='pln'>83</p>
<p class='pln'>84</p>
<p class='stm mis'>85</p>
<p class='stm mis'>86</p>
<p class='stm mis'>87</p>
<p class='stm mis'>88</p>
<p class='stm mis'>89</p>
<p class='stm mis'>90</p>
<p class='stm mis'>91</p>
<p class='pln'>92</p>
<p class='stm run hide_run'>93</p>
<p class='pln'>94</p>
<p class='pln'>95</p>
<p class='pln'>96</p>
<p class='pln'>97</p>
<p class='pln'>98</p>
<p class='pln'>99</p>
<p class='pln'>100</p>
<p class='pln'>101</p>
<p class='pln'>102</p>
<p class='pln'>103</p>
<p class='pln'>104</p>
<p class='pln'>105</p>
<p class='pln'>106</p>
<p class='pln'>107</p>
<p class='pln'>108</p>
<p class='pln'>109</p>
<p class='pln'>110</p>
<p class='pln'>111</p>
<p class='pln'>112</p>
<p class='pln'>113</p>
<p class='pln'>114</p>
<p class='pln'>115</p>
<p class='pln'>116</p>
<p class='pln'>117</p>
<p class='pln'>118</p>
<p class='pln'>119</p>
<p class='pln'>120</p>
<p class='pln'>121</p>
<p class='pln'>122</p>
<p class='pln'>123</p>
<p class='pln'>124</p>
<p class='pln'>125</p>
<p class='pln'>126</p>
<p class='pln'>127</p>
<p class='pln'>128</p>
<p class='pln'>129</p>
<p class='pln'>130</p>
<p class='pln'>131</p>
<p class='pln'>132</p>
<p class='pln'>133</p>
<p class='pln'>134</p>
<p class='pln'>135</p>
<p class='pln'>136</p>
<p class='pln'>137</p>
<p class='pln'>138</p>
<p class='pln'>139</p>
<p class='pln'>140</p>
<p class='pln'>141</p>
<p class='stm mis'>142</p>
<p class='stm mis'>143</p>
<p class='stm mis'>144</p>
<p class='stm mis'>145</p>
<p class='stm mis'>146</p>
<p class='stm mis'>147</p>
<p class='stm mis'>148</p>
<p class='pln'>149</p>
<p class='stm run hide_run'>150</p>
<p class='pln'>151</p>
<p class='pln'>152</p>
<p class='pln'>153</p>
<p class='pln'>154</p>
<p class='pln'>155</p>
<p class='pln'>156</p>
<p class='pln'>157</p>
<p class='pln'>158</p>
<p class='pln'>159</p>
<p class='pln'>160</p>
<p class='pln'>161</p>
<p class='pln'>162</p>
<p class='pln'>163</p>
<p class='pln'>164</p>
<p class='pln'>165</p>
<p class='pln'>166</p>
<p class='pln'>167</p>
<p class='pln'>168</p>
<p class='pln'>169</p>
<p class='pln'>170</p>
<p class='pln'>171</p>
<p class='pln'>172</p>
<p class='pln'>173</p>
<p class='pln'>174</p>
<p class='pln'>175</p>
<p class='pln'>176</p>
<p class='pln'>177</p>
<p class='pln'>178</p>
<p class='pln'>179</p>
<p class='pln'>180</p>
<p class='pln'>181</p>
<p class='pln'>182</p>
<p class='pln'>183</p>
<p class='pln'>184</p>
<p class='pln'>185</p>
<p class='pln'>186</p>
<p class='pln'>187</p>
<p class='pln'>188</p>
<p class='pln'>189</p>
<p class='pln'>190</p>
<p class='pln'>191</p>
<p class='pln'>192</p>
<p class='pln'>193</p>
<p class='pln'>194</p>
<p class='pln'>195</p>
<p class='pln'>196</p>
<p class='pln'>197</p>
<p class='stm mis'>198</p>
<p class='stm mis'>199</p>
<p class='stm mis'>200</p>
<p class='stm mis'>201</p>
<p class='stm mis'>202</p>
<p class='stm mis'>203</p>
<p class='stm mis'>204</p>
<p class='stm mis'>205</p>
<p class='stm mis'>206</p>
<p class='stm mis'>207</p>
<p class='stm mis'>208</p>
<p class='pln'>209</p>
<p class='stm run hide_run'>210</p>
<p class='pln'>211</p>
<p class='pln'>212</p>
<p class='pln'>213</p>
<p class='pln'>214</p>
<p class='pln'>215</p>
<p class='pln'>216</p>
<p class='pln'>217</p>
<p class='pln'>218</p>
<p class='pln'>219</p>
<p class='pln'>220</p>
<p class='pln'>221</p>
<p class='pln'>222</p>
<p class='pln'>223</p>
<p class='pln'>224</p>
<p class='pln'>225</p>
<p class='pln'>226</p>
<p class='pln'>227</p>
<p class='pln'>228</p>
<p class='pln'>229</p>
<p class='pln'>230</p>
<p class='pln'>231</p>
<p class='pln'>232</p>
<p class='pln'>233</p>
<p class='pln'>234</p>
<p class='pln'>235</p>
<p class='pln'>236</p>
<p class='pln'>237</p>
<p class='pln'>238</p>
<p class='pln'>239</p>
<p class='pln'>240</p>
<p class='pln'>241</p>
<p class='pln'>242</p>
<p class='pln'>243</p>
<p class='pln'>244</p>
<p class='pln'>245</p>
<p class='pln'>246</p>
<p class='pln'>247</p>
<p class='pln'>248</p>
<p class='pln'>249</p>
<p class='stm mis'>250</p>
<p class='pln'>251</p>
<p class='stm mis'>252</p>
<p class='pln'>253</p>
<p class='stm run hide_run'>254</p>
<p class='pln'>255</p>
<p class='pln'>256</p>
<p class='pln'>257</p>
<p class='pln'>258</p>
<p class='pln'>259</p>
<p class='pln'>260</p>
<p class='pln'>261</p>
<p class='pln'>262</p>
<p class='pln'>263</p>
<p class='pln'>264</p>
<p class='pln'>265</p>
<p class='pln'>266</p>
<p class='pln'>267</p>
<p class='pln'>268</p>
<p class='pln'>269</p>
<p class='pln'>270</p>
<p class='pln'>271</p>
<p class='pln'>272</p>
<p class='pln'>273</p>
<p class='pln'>274</p>
<p class='pln'>275</p>
<p class='pln'>276</p>
<p class='pln'>277</p>
<p class='pln'>278</p>
<p class='stm mis'>279</p>
<p class='stm mis'>280</p>
<p class='pln'>281</p>
<p class='stm run hide_run'>282</p>
<p class='pln'>283</p>
<p class='pln'>284</p>
<p class='pln'>285</p>
<p class='pln'>286</p>
<p class='pln'>287</p>
<p class='pln'>288</p>
<p class='pln'>289</p>
<p class='pln'>290</p>
<p class='pln'>291</p>
<p class='pln'>292</p>
<p class='pln'>293</p>
<p class='pln'>294</p>
<p class='pln'>295</p>
<p class='pln'>296</p>
<p class='pln'>297</p>
<p class='pln'>298</p>
<p class='pln'>299</p>
<p class='pln'>300</p>
<p class='pln'>301</p>
<p class='pln'>302</p>
<p class='pln'>303</p>
<p class='pln'>304</p>
<p class='pln'>305</p>
<p class='pln'>306</p>
<p class='pln'>307</p>
<p class='pln'>308</p>
<p class='pln'>309</p>
<p class='pln'>310</p>
<p class='pln'>311</p>
<p class='pln'>312</p>
<p class='pln'>313</p>
<p class='pln'>314</p>
<p class='pln'>315</p>
<p class='pln'>316</p>
<p class='stm mis'>317</p>
<p class='stm mis'>318</p>
<p class='stm mis'>319</p>
<p class='stm mis'>320</p>
<p class='stm mis'>321</p>
<p class='stm mis'>322</p>
<p class='stm mis'>323</p>
<p class='pln'>324</p>
<p class='pln'>325</p>
<p class='pln'>326</p>
<p class='pln'>327</p>
<p class='stm run hide_run'>328</p>
<p class='stm mis'>329</p>
<p class='stm mis'>330</p>
<p class='stm mis'>331</p>
<p class='pln'>332</p>
<p class='pln'>333</p>
<p class='pln'>334</p>
<p class='pln'>335</p>
<p class='pln'>336</p>
<p class='pln'>337</p>
<p class='pln'>338</p>
<p class='pln'>339</p>
<p class='stm run hide_run'>340</p>
<p class='pln'>341</p>
<p class='pln'>342</p>
<p class='pln'>343</p>
<p class='pln'>344</p>
<p class='pln'>345</p>
<p class='pln'>346</p>
<p class='pln'>347</p>
<p class='pln'>348</p>
<p class='pln'>349</p>
<p class='pln'>350</p>
<p class='pln'>351</p>
<p class='pln'>352</p>
<p class='pln'>353</p>
<p class='pln'>354</p>
<p class='pln'>355</p>
<p class='pln'>356</p>
<p class='pln'>357</p>
<p class='pln'>358</p>
<p class='pln'>359</p>
<p class='pln'>360</p>
<p class='pln'>361</p>
<p class='pln'>362</p>
<p class='pln'>363</p>
<p class='pln'>364</p>
<p class='pln'>365</p>
<p class='pln'>366</p>
<p class='pln'>367</p>
<p class='pln'>368</p>
<p class='pln'>369</p>
<p class='pln'>370</p>
<p class='pln'>371</p>
<p class='pln'>372</p>
<p class='pln'>373</p>
<p class='stm mis'>374</p>
<p class='stm mis'>375</p>
<p class='stm mis'>376</p>
<p class='stm mis'>377</p>
<p class='stm mis'>378</p>
<p class='stm mis'>379</p>
<p class='stm mis'>380</p>
<p class='stm mis'>381</p>
<p class='stm mis'>382</p>
<p class='stm mis'>383</p>
<p class='stm mis'>384</p>
<p class='stm mis'>385</p>
<p class='pln'>386</p>
<p class='stm mis'>387</p>
<p class='pln'>388</p>
<p class='stm mis'>389</p>
<p class='pln'>390</p>
<p class='stm run hide_run'>391</p>
<p class='pln'>392</p>
<p class='pln'>393</p>
<p class='pln'>394</p>
<p class='pln'>395</p>
<p class='pln'>396</p>
<p class='pln'>397</p>
<p class='pln'>398</p>
<p class='pln'>399</p>
<p class='pln'>400</p>
<p class='pln'>401</p>
<p class='pln'>402</p>
<p class='pln'>403</p>
<p class='pln'>404</p>
<p class='pln'>405</p>
<p class='pln'>406</p>
<p class='pln'>407</p>
<p class='pln'>408</p>
<p class='pln'>409</p>
<p class='pln'>410</p>
<p class='pln'>411</p>
<p class='pln'>412</p>
<p class='pln'>413</p>
<p class='stm mis'>414</p>
<p class='pln'>415</p>
<p class='stm mis'>416</p>
<p class='stm mis'>417</p>
<p class='stm mis'>418</p>
<p class='stm mis'>419</p>
<p class='stm mis'>420</p>
<p class='stm mis'>421</p>
<p class='stm mis'>422</p>
<p class='stm mis'>423</p>
<p class='pln'>424</p>
<p class='stm run hide_run'>425</p>
<p class='pln'>426</p>
<p class='pln'>427</p>
<p class='pln'>428</p>
<p class='pln'>429</p>
<p class='pln'>430</p>
<p class='pln'>431</p>
<p class='pln'>432</p>
<p class='pln'>433</p>
<p class='pln'>434</p>
<p class='pln'>435</p>
<p class='pln'>436</p>
<p class='pln'>437</p>
<p class='pln'>438</p>
<p class='pln'>439</p>
<p class='pln'>440</p>
<p class='pln'>441</p>
<p class='pln'>442</p>
<p class='pln'>443</p>
<p class='pln'>444</p>
<p class='pln'>445</p>
<p class='pln'>446</p>
<p class='pln'>447</p>
<p class='pln'>448</p>
<p class='stm mis'>449</p>
<p class='stm mis'>450</p>
<p class='pln'>451</p>
<p class='stm run hide_run'>452</p>
<p class='pln'>453</p>
<p class='pln'>454</p>
<p class='pln'>455</p>
<p class='pln'>456</p>
<p class='pln'>457</p>
<p class='pln'>458</p>
<p class='pln'>459</p>
<p class='pln'>460</p>
<p class='pln'>461</p>
<p class='pln'>462</p>
<p class='pln'>463</p>
<p class='pln'>464</p>
<p class='pln'>465</p>
<p class='pln'>466</p>
<p class='pln'>467</p>
<p class='pln'>468</p>
<p class='pln'>469</p>
<p class='pln'>470</p>
<p class='pln'>471</p>
<p class='pln'>472</p>
<p class='stm mis'>473</p>
<p class='stm mis'>474</p>
<p class='stm mis'>475</p>
<p class='stm mis'>476</p>
<p class='stm mis'>477</p>
<p class='pln'>478</p>
<p class='stm mis'>479</p>
<p class='stm mis'>480</p>
<p class='stm mis'>481</p>
<p class='stm mis'>482</p>
    
</td>
<td class='text' valign='top'>
<p class='pln'><span class='com'># Some simple financial calculations</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'>#&nbsp; patterned after spreadsheet computations.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'># There is some complexity in each function</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'>#&nbsp; so that the functions behave like ufuncs with</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'>#&nbsp; broadcasting and being able to be called with scalars</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'>#&nbsp; or arrays (or other sequences).</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>import</span> <span class='nam'>numpy</span> <span class='key'>as</span> <span class='nam'>np</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='nam'>__all__</span> <span class='op'>=</span> <span class='op'>[</span><span class='str'>&#39;fv&#39;</span><span class='op'>,</span> <span class='str'>&#39;pmt&#39;</span><span class='op'>,</span> <span class='str'>&#39;nper&#39;</span><span class='op'>,</span> <span class='str'>&#39;ipmt&#39;</span><span class='op'>,</span> <span class='str'>&#39;ppmt&#39;</span><span class='op'>,</span> <span class='str'>&#39;pv&#39;</span><span class='op'>,</span> <span class='str'>&#39;rate&#39;</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <span class='str'>&#39;irr&#39;</span><span class='op'>,</span> <span class='str'>&#39;npv&#39;</span><span class='op'>,</span> <span class='str'>&#39;mirr&#39;</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='nam'>_when_to_num</span> <span class='op'>=</span> <span class='op'>{</span><span class='str'>&#39;end&#39;</span><span class='op'>:</span><span class='num'>0</span><span class='op'>,</span> <span class='str'>&#39;begin&#39;</span><span class='op'>:</span><span class='num'>1</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='str'>&#39;e&#39;</span><span class='op'>:</span><span class='num'>0</span><span class='op'>,</span> <span class='str'>&#39;b&#39;</span><span class='op'>:</span><span class='num'>1</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='num'>0</span><span class='op'>:</span><span class='num'>0</span><span class='op'>,</span> <span class='num'>1</span><span class='op'>:</span><span class='num'>1</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='str'>&#39;beginning&#39;</span><span class='op'>:</span><span class='num'>1</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='str'>&#39;start&#39;</span><span class='op'>:</span><span class='num'>1</span><span class='op'>,</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class='str'>&#39;finish&#39;</span><span class='op'>:</span><span class='num'>0</span><span class='op'>}</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>_convert_when</span><span class='op'>(</span><span class='nam'>when</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>try</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>_when_to_num</span><span class='op'>[</span><span class='nam'>when</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>except</span> <span class='nam'>KeyError</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='op'>[</span><span class='nam'>_when_to_num</span><span class='op'>[</span><span class='nam'>x</span><span class='op'>]</span> <span class='key'>for</span> <span class='nam'>x</span> <span class='key'>in</span> <span class='nam'>when</span><span class='op'>]</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>fv</span><span class='op'>(</span><span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pmt</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>when</span><span class='op'>=</span><span class='str'>&#39;end&#39;</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Compute the future value.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; rate : scalar or array_like of shape(M, )</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Rate of interest as decimal (not per cent) per period</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; nper : scalar or array_like of shape(M, )</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Number of compounding periods</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; pmt : scalar or array_like of shape(M, )</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Payment</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; pv : scalar or array_like of shape(M, )</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Present value</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; when : {{&#39;begin&#39;, 1}, {&#39;end&#39;, 0}}, {string, int}, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; When payments are due (&#39;begin&#39; (1) or &#39;end&#39; (0)).</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Defaults to {&#39;end&#39;, 0}.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Future values.&nbsp; If all input is scalar, returns a scalar float.&nbsp; If</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; any input is array_like, returns future values for each input element.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; If multiple inputs are array_like, they all must have the same shape.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The future value is computed by solving the equation::</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp;&nbsp; fv +</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp;&nbsp; pv*(1+rate)**nper +</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp;&nbsp; pmt*(1 + rate*when)/rate*((1 + rate)**nper - 1) == 0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; or, when ``rate == 0``::</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp;&nbsp; fv + pv + pmt * nper == 0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; What is the future value after 10 years of saving $100 now, with</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; an additional monthly savings of $100.&nbsp; Assume the interest rate is</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 5% (annually) compounded monthly?</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.fv(0.05/12, 10*12, -100, -100)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 15692.928894335748</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; By convention, the negative sign represents cash flow out (i.e. money not</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; available today).&nbsp; Thus, saving $100 a month at 5% annual interest leads</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; to $15,692.93 available to spend in 10 years.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; If any input is array_like, returns an array of equal shape.&nbsp; Let&#39;s</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; compare different interest rates from the example above.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; a = np.array((0.05, 0.06, 0.07))/12</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.fv(a, 10*12, -100, -100)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([ 15692.92889434,&nbsp; 16569.87435405,&nbsp; 17509.44688102])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>when</span> <span class='op'>=</span> <span class='nam'>_convert_when</span><span class='op'>(</span><span class='nam'>when</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pmt</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>when</span> <span class='op'>=</span> <span class='nam'>map</span><span class='op'>(</span><span class='nam'>np</span><span class='op'>.</span><span class='nam'>asarray</span><span class='op'>,</span> <span class='op'>[</span><span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pmt</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>when</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>temp</span> <span class='op'>=</span> <span class='op'>(</span><span class='num'>1</span><span class='op'>+</span><span class='nam'>rate</span><span class='op'>)</span><span class='op'>**</span><span class='nam'>nper</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>miter</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>broadcast</span><span class='op'>(</span><span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pmt</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>when</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>zer</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>zeros</span><span class='op'>(</span><span class='nam'>miter</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>fact</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>where</span><span class='op'>(</span><span class='nam'>rate</span><span class='op'>==</span><span class='nam'>zer</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>+</span><span class='nam'>zer</span><span class='op'>,</span> <span class='op'>(</span><span class='num'>1</span><span class='op'>+</span><span class='nam'>rate</span><span class='op'>*</span><span class='nam'>when</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='nam'>temp</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='op'>/</span><span class='nam'>rate</span><span class='op'>+</span><span class='nam'>zer</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='op'>-</span><span class='op'>(</span><span class='nam'>pv</span><span class='op'>*</span><span class='nam'>temp</span> <span class='op'>+</span> <span class='nam'>pmt</span><span class='op'>*</span><span class='nam'>fact</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>pmt</span><span class='op'>(</span><span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>=</span><span class='num'>0</span><span class='op'>,</span> <span class='nam'>when</span><span class='op'>=</span><span class='str'>&#39;end&#39;</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Compute the payment against loan principal plus interest.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; rate : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Rate of interest (per period)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; nper : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Number of compounding periods</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; pv : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Present value</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; fv : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Future value</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; when : {{&#39;begin&#39;, 1}, {&#39;end&#39;, 0}}, {string, int}</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; When payments are due (&#39;begin&#39; (1) or &#39;end&#39; (0))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Payment against loan plus interest.&nbsp; If all input is scalar, returns a</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; scalar float.&nbsp; If any input is array_like, returns payment for each</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; input element. If multiple inputs are array_like, they all must have</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; the same shape.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The payment ``pmt`` is computed by solving the equation::</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp;&nbsp; fv +</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp;&nbsp; pv*(1 + rate)**nper +</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp;&nbsp; pmt*(1 + rate*when)/rate*((1 + rate)**nper - 1) == 0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; or, when ``rate == 0``::</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; fv + pv + pmt * nper == 0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; What would the monthly payment need to be to pay off a $200,000 loan in 15</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; years at an annual interest rate of 7.5%?</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.pmt(0.075/12, 12*15, 200000)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -1854.0247200054619</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; In order to pay-off (i.e. have a future-value of 0) the $200,000 obtained</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; today, a monthly payment of $1,854.02 would be required.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>when</span> <span class='op'>=</span> <span class='nam'>_convert_when</span><span class='op'>(</span><span class='nam'>when</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>,</span> <span class='nam'>when</span> <span class='op'>=</span> <span class='nam'>map</span><span class='op'>(</span><span class='nam'>np</span><span class='op'>.</span><span class='nam'>asarray</span><span class='op'>,</span> <span class='op'>[</span><span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>,</span> <span class='nam'>when</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>temp</span> <span class='op'>=</span> <span class='op'>(</span><span class='num'>1</span><span class='op'>+</span><span class='nam'>rate</span><span class='op'>)</span><span class='op'>**</span><span class='nam'>nper</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>miter</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>broadcast</span><span class='op'>(</span><span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>,</span> <span class='nam'>when</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>zer</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>zeros</span><span class='op'>(</span><span class='nam'>miter</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>fact</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>where</span><span class='op'>(</span><span class='nam'>rate</span><span class='op'>==</span><span class='nam'>zer</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>+</span><span class='nam'>zer</span><span class='op'>,</span> <span class='op'>(</span><span class='num'>1</span><span class='op'>+</span><span class='nam'>rate</span><span class='op'>*</span><span class='nam'>when</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='nam'>temp</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='op'>/</span><span class='nam'>rate</span><span class='op'>+</span><span class='nam'>zer</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='op'>-</span><span class='op'>(</span><span class='nam'>fv</span> <span class='op'>+</span> <span class='nam'>pv</span><span class='op'>*</span><span class='nam'>temp</span><span class='op'>)</span> <span class='op'>/</span> <span class='nam'>fact</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>nper</span><span class='op'>(</span><span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>pmt</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>=</span><span class='num'>0</span><span class='op'>,</span> <span class='nam'>when</span><span class='op'>=</span><span class='str'>&#39;end&#39;</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Compute the number of periods.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; rate : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Rate of interest (per period)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; pmt : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Payment</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; pv : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Present value</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; fv : array_like, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Future value</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; when : {{&#39;begin&#39;, 1}, {&#39;end&#39;, 0}}, {string, int}, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; When payments are due (&#39;begin&#39; (1) or &#39;end&#39; (0))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The number of periods ``nper`` is computed by solving the equation::</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; fv + pv*(1+rate)**nper + pmt*(1+rate*when)/rate * ((1+rate)**nper - 1) == 0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; or, when ``rate == 0``::</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; fv + pv + pmt * nper == 0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; If you only had $150 to spend as payment, how long would it take to pay-off</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; a loan of $8,000 at 7% annual interest?</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nper(0.07/12, -150, 8000)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 64.073348770661852</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; So, over 64 months would be required to pay off the loan.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The same analysis could be done with several different interest rates</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; and/or payments and/or total amounts to produce an entire table.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.nper(*(np.ogrid[0.06/12:0.071/12:0.01/12, -200:-99:100, 6000:7001:1000]))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; array([[[ 32.58497782,&nbsp; 38.57048452],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [ 71.51317802,&nbsp; 86.37179563]],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &lt;BLANKLINE&gt;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; [[ 33.07413144,&nbsp; 39.26244268],</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [ 74.06368256,&nbsp; 90.22989997]]])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>when</span> <span class='op'>=</span> <span class='nam'>_convert_when</span><span class='op'>(</span><span class='nam'>when</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>pmt</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>,</span> <span class='nam'>when</span> <span class='op'>=</span> <span class='nam'>map</span><span class='op'>(</span><span class='nam'>np</span><span class='op'>.</span><span class='nam'>asarray</span><span class='op'>,</span> <span class='op'>[</span><span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>pmt</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>,</span> <span class='nam'>when</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>try</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>z</span> <span class='op'>=</span> <span class='nam'>pmt</span><span class='op'>*</span><span class='op'>(</span><span class='num'>1.0</span><span class='op'>+</span><span class='nam'>rate</span><span class='op'>*</span><span class='nam'>when</span><span class='op'>)</span><span class='op'>/</span><span class='nam'>rate</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>except</span> <span class='nam'>ZeroDivisionError</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>z</span> <span class='op'>=</span> <span class='num'>0.0</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>A</span> <span class='op'>=</span> <span class='op'>-</span><span class='op'>(</span><span class='nam'>fv</span> <span class='op'>+</span> <span class='nam'>pv</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='nam'>pmt</span><span class='op'>+</span><span class='num'>0.0</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>B</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>log</span><span class='op'>(</span><span class='op'>(</span><span class='op'>-</span><span class='nam'>fv</span><span class='op'>+</span><span class='nam'>z</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='nam'>pv</span><span class='op'>+</span><span class='nam'>z</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='nam'>np</span><span class='op'>.</span><span class='nam'>log</span><span class='op'>(</span><span class='num'>1.0</span><span class='op'>+</span><span class='nam'>rate</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>miter</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>broadcast</span><span class='op'>(</span><span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>pmt</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>,</span> <span class='nam'>when</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>zer</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>zeros</span><span class='op'>(</span><span class='nam'>miter</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>where</span><span class='op'>(</span><span class='nam'>rate</span><span class='op'>==</span><span class='nam'>zer</span><span class='op'>,</span> <span class='nam'>A</span><span class='op'>+</span><span class='nam'>zer</span><span class='op'>,</span> <span class='nam'>B</span><span class='op'>+</span><span class='nam'>zer</span><span class='op'>)</span> <span class='op'>+</span> <span class='num'>0.0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>ipmt</span><span class='op'>(</span><span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>per</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>=</span><span class='num'>0.0</span><span class='op'>,</span> <span class='nam'>when</span><span class='op'>=</span><span class='str'>&#39;end&#39;</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Not implemented. Compute the payment portion for loan interest.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; rate : scalar or array_like of shape(M, )</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Rate of interest as decimal (not per cent) per period</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; per : scalar or array_like of shape(M, )</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Interest paid against the loan changes during the life or the loan.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The `per` is the payment period to calculate the interest amount.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; nper : scalar or array_like of shape(M, )</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Number of compounding periods</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; pv : scalar or array_like of shape(M, )</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Present value</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; fv : scalar or array_like of shape(M, ), optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Future value</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; when : {{&#39;begin&#39;, 1}, {&#39;end&#39;, 0}}, {string, int}, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; When payments are due (&#39;begin&#39; (1) or &#39;end&#39; (0)).</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Defaults to {&#39;end&#39;, 0}.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : ndarray</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Interest portion of payment.&nbsp; If all input is scalar, returns a scalar</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; float.&nbsp; If any input is array_like, returns interest payment for each</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; input element. If multiple inputs are array_like, they all must have</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; the same shape.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ppmt, pmt, pv</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The total payment is made up of payment against principal plus interest.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ``pmt = ppmt + ipmt``</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>total</span> <span class='op'>=</span> <span class='nam'>pmt</span><span class='op'>(</span><span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>,</span> <span class='nam'>when</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># Now, compute the nth step in the amortization</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>raise</span> <span class='nam'>NotImplementedError</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>ppmt</span><span class='op'>(</span><span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>per</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>=</span><span class='num'>0.0</span><span class='op'>,</span> <span class='nam'>when</span><span class='op'>=</span><span class='str'>&#39;end&#39;</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Not implemented. Compute the payment against loan principal.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; rate : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Rate of interest (per period)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; per : array_like, int</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Amount paid against the loan changes.&nbsp; The `per` is the period of</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; interest.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; nper : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Number of compounding periods</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; pv : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Present value</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; fv : array_like, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Future value</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; when : {{&#39;begin&#39;, 1}, {&#39;end&#39;, 0}}, {string, int}</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; When payments are due (&#39;begin&#39; (1) or &#39;end&#39; (0))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; See Also</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; pmt, pv, ipmt</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>total</span> <span class='op'>=</span> <span class='nam'>pmt</span><span class='op'>(</span><span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>,</span> <span class='nam'>when</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>total</span> <span class='op'>-</span> <span class='nam'>ipmt</span><span class='op'>(</span><span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>per</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>,</span> <span class='nam'>when</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>pv</span><span class='op'>(</span><span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pmt</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>=</span><span class='num'>0.0</span><span class='op'>,</span> <span class='nam'>when</span><span class='op'>=</span><span class='str'>&#39;end&#39;</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Compute the present value.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; rate : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Rate of interest (per period)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; nper : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Number of compounding periods</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; pmt : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Payment</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; fv : array_like, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Future value</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; when : {{&#39;begin&#39;, 1}, {&#39;end&#39;, 0}}, {string, int}, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; When payments are due (&#39;begin&#39; (1) or &#39;end&#39; (0))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : ndarray, float</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Present value of a series of payments or investments.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The present value ``pv`` is computed by solving the equation::</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp;&nbsp; fv +</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp;&nbsp; pv*(1 + rate)**nper +</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp;&nbsp; pmt*(1 + rate*when)/rate*((1 + rate)**nper - 1) = 0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; or, when ``rate = 0``::</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp;&nbsp; fv + pv + pmt * nper = 0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>when</span> <span class='op'>=</span> <span class='nam'>_convert_when</span><span class='op'>(</span><span class='nam'>when</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pmt</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>,</span> <span class='nam'>when</span> <span class='op'>=</span> <span class='nam'>map</span><span class='op'>(</span><span class='nam'>np</span><span class='op'>.</span><span class='nam'>asarray</span><span class='op'>,</span> <span class='op'>[</span><span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pmt</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>,</span> <span class='nam'>when</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>temp</span> <span class='op'>=</span> <span class='op'>(</span><span class='num'>1</span><span class='op'>+</span><span class='nam'>rate</span><span class='op'>)</span><span class='op'>**</span><span class='nam'>nper</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>miter</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>broadcast</span><span class='op'>(</span><span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pmt</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>,</span> <span class='nam'>when</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>zer</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>zeros</span><span class='op'>(</span><span class='nam'>miter</span><span class='op'>.</span><span class='nam'>shape</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>fact</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>where</span><span class='op'>(</span><span class='nam'>rate</span> <span class='op'>==</span> <span class='nam'>zer</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>+</span><span class='nam'>zer</span><span class='op'>,</span> <span class='op'>(</span><span class='num'>1</span><span class='op'>+</span><span class='nam'>rate</span><span class='op'>*</span><span class='nam'>when</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='nam'>temp</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='op'>/</span><span class='nam'>rate</span><span class='op'>+</span><span class='nam'>zer</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='op'>-</span><span class='op'>(</span><span class='nam'>fv</span> <span class='op'>+</span> <span class='nam'>pmt</span><span class='op'>*</span><span class='nam'>fact</span><span class='op'>)</span><span class='op'>/</span><span class='nam'>temp</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'># Computed with Sage</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'>#&nbsp; (y + (r + 1)^n*x + p*((r + 1)^n - 1)*(r*w + 1)/r)/(n*(r + 1)^(n - 1)*x - p*((r + 1)^n - 1)*(r*w + 1)/r^2 + n*p*(r + 1)^(n - 1)*(r*w + 1)/r + p*((r + 1)^n - 1)*w/r)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>_g_div_gp</span><span class='op'>(</span><span class='nam'>r</span><span class='op'>,</span> <span class='nam'>n</span><span class='op'>,</span> <span class='nam'>p</span><span class='op'>,</span> <span class='nam'>x</span><span class='op'>,</span> <span class='nam'>y</span><span class='op'>,</span> <span class='nam'>w</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>t1</span> <span class='op'>=</span> <span class='op'>(</span><span class='nam'>r</span><span class='op'>+</span><span class='num'>1</span><span class='op'>)</span><span class='op'>**</span><span class='nam'>n</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>t2</span> <span class='op'>=</span> <span class='op'>(</span><span class='nam'>r</span><span class='op'>+</span><span class='num'>1</span><span class='op'>)</span><span class='op'>**</span><span class='op'>(</span><span class='nam'>n</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='op'>(</span><span class='nam'>y</span> <span class='op'>+</span> <span class='nam'>t1</span><span class='op'>*</span><span class='nam'>x</span> <span class='op'>+</span> <span class='nam'>p</span><span class='op'>*</span><span class='op'>(</span><span class='nam'>t1</span> <span class='op'>-</span> <span class='num'>1</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='nam'>r</span><span class='op'>*</span><span class='nam'>w</span> <span class='op'>+</span> <span class='num'>1</span><span class='op'>)</span><span class='op'>/</span><span class='nam'>r</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='nam'>n</span><span class='op'>*</span><span class='nam'>t2</span><span class='op'>*</span><span class='nam'>x</span> <span class='op'>-</span> <span class='nam'>p</span><span class='op'>*</span><span class='op'>(</span><span class='nam'>t1</span> <span class='op'>-</span> <span class='num'>1</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='nam'>r</span><span class='op'>*</span><span class='nam'>w</span> <span class='op'>+</span> <span class='num'>1</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='nam'>r</span><span class='op'>**</span><span class='num'>2</span><span class='op'>)</span> <span class='op'>+</span> <span class='nam'>n</span><span class='op'>*</span><span class='nam'>p</span><span class='op'>*</span><span class='nam'>t2</span><span class='op'>*</span><span class='op'>(</span><span class='nam'>r</span><span class='op'>*</span><span class='nam'>w</span> <span class='op'>+</span> <span class='num'>1</span><span class='op'>)</span><span class='op'>/</span><span class='nam'>r</span> <span class='op'>+</span> <span class='nam'>p</span><span class='op'>*</span><span class='op'>(</span><span class='nam'>t1</span> <span class='op'>-</span> <span class='num'>1</span><span class='op'>)</span><span class='op'>*</span><span class='nam'>w</span><span class='op'>/</span><span class='nam'>r</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'># Use Newton&#39;s iteration until the change is less than 1e-6</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'>#&nbsp; for all values or a maximum of 100 iterations is reached.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'>#&nbsp; Newton&#39;s rule is</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'>#&nbsp; r_{n+1} = r_{n} - g(r_n)/g&#39;(r_n)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'>#&nbsp; &nbsp;&nbsp; where</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'>#&nbsp; g(r) is the formula</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='com'>#&nbsp; g&#39;(r) is the derivative with respect to r.</span><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>rate</span><span class='op'>(</span><span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pmt</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>,</span> <span class='nam'>when</span><span class='op'>=</span><span class='str'>&#39;end&#39;</span><span class='op'>,</span> <span class='nam'>guess</span><span class='op'>=</span><span class='num'>0.10</span><span class='op'>,</span> <span class='nam'>tol</span><span class='op'>=</span><span class='num'>1e-6</span><span class='op'>,</span> <span class='nam'>maxiter</span><span class='op'>=</span><span class='num'>100</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Compute the rate of interest per period.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; nper : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Number of compounding periods</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; pmt : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Payment</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; pv : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Present value</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; fv : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Future value</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; when : {{&#39;begin&#39;, 1}, {&#39;end&#39;, 0}}, {string, int}, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; When payments are due (&#39;begin&#39; (1) or &#39;end&#39; (0))</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; guess : float, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Starting guess for solving the rate of interest</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; tol : float, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Required tolerance for the solution</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; maxiter : int, optional</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Maximum iterations in finding the solution</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; The rate of interest ``rate`` is computed by solving the equation::</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp;&nbsp; fv + pv*(1+rate)**nper + pmt*(1+rate*when)/rate * ((1+rate)**nper - 1) = 0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; or, if ``rate = 0``::</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp;&nbsp; fv + pv + pmt * nper = 0</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>when</span> <span class='op'>=</span> <span class='nam'>_convert_when</span><span class='op'>(</span><span class='nam'>when</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pmt</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>,</span> <span class='nam'>when</span> <span class='op'>=</span> <span class='nam'>map</span><span class='op'>(</span><span class='nam'>np</span><span class='op'>.</span><span class='nam'>asarray</span><span class='op'>,</span> <span class='op'>[</span><span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pmt</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>,</span> <span class='nam'>when</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>rn</span> <span class='op'>=</span> <span class='nam'>guess</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>iter</span> <span class='op'>=</span> <span class='num'>0</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>close</span> <span class='op'>=</span> <span class='nam'>False</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>while</span> <span class='op'>(</span><span class='nam'>iter</span> <span class='op'>&lt;</span> <span class='nam'>maxiter</span><span class='op'>)</span> <span class='key'>and</span> <span class='key'>not</span> <span class='nam'>close</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>rnp1</span> <span class='op'>=</span> <span class='nam'>rn</span> <span class='op'>-</span> <span class='nam'>_g_div_gp</span><span class='op'>(</span><span class='nam'>rn</span><span class='op'>,</span> <span class='nam'>nper</span><span class='op'>,</span> <span class='nam'>pmt</span><span class='op'>,</span> <span class='nam'>pv</span><span class='op'>,</span> <span class='nam'>fv</span><span class='op'>,</span> <span class='nam'>when</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>diff</span> <span class='op'>=</span> <span class='nam'>abs</span><span class='op'>(</span><span class='nam'>rnp1</span><span class='op'>-</span><span class='nam'>rn</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>close</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>all</span><span class='op'>(</span><span class='nam'>diff</span><span class='op'>&lt;</span><span class='nam'>tol</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>iter</span> <span class='op'>+=</span> <span class='num'>1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>rn</span> <span class='op'>=</span> <span class='nam'>rnp1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='key'>not</span> <span class='nam'>close</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='com'># Return nan&#39;s in array of the same shape as rn</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>nan</span> <span class='op'>+</span> <span class='nam'>rn</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='key'>else</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>rn</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>irr</span><span class='op'>(</span><span class='nam'>values</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Return the Internal Rate of Return (IRR).</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; This is the rate of return that gives a net present value of 0.0.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; values : array_like, shape(N,)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Input cash flows per time period.&nbsp; At least the first value would be</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; negative to represent the investment in the project.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : float</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Internal Rate of Return for periodic input values.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Examples</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; --------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &gt;&gt;&gt; np.irr([-100, 39, 59, 55, 20])</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; 0.2809484211599611</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>res</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>roots</span><span class='op'>(</span><span class='nam'>values</span><span class='op'>[</span><span class='op'>:</span><span class='op'>:</span><span class='op'>-</span><span class='num'>1</span><span class='op'>]</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='com'># Find the root(s) between 0 and 1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>mask</span> <span class='op'>=</span> <span class='op'>(</span><span class='nam'>res</span><span class='op'>.</span><span class='nam'>imag</span> <span class='op'>==</span> <span class='num'>0</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>(</span><span class='nam'>res</span><span class='op'>.</span><span class='nam'>real</span> <span class='op'>&gt;</span> <span class='num'>0</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='op'>(</span><span class='nam'>res</span><span class='op'>.</span><span class='nam'>real</span> <span class='op'>&lt;=</span> <span class='num'>1</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>res</span> <span class='op'>=</span> <span class='nam'>res</span><span class='op'>[</span><span class='nam'>mask</span><span class='op'>]</span><span class='op'>.</span><span class='nam'>real</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>res</span><span class='op'>.</span><span class='nam'>size</span> <span class='op'>==</span> <span class='num'>0</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>nan</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>rate</span> <span class='op'>=</span> <span class='num'>1.0</span><span class='op'>/</span><span class='nam'>res</span> <span class='op'>-</span> <span class='num'>1</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='nam'>rate</span><span class='op'>.</span><span class='nam'>size</span> <span class='op'>==</span> <span class='num'>1</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='nam'>rate</span> <span class='op'>=</span> <span class='nam'>rate</span><span class='op'>.</span><span class='nam'>item</span><span class='op'>(</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>rate</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>npv</span><span class='op'>(</span><span class='nam'>rate</span><span class='op'>,</span> <span class='nam'>values</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns the NPV (Net Present Value) of a cash flow series.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; rate : scalar</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The discount rate.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; values : array_like, shape(M, )</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The values of the time series of cash flows.&nbsp; Must be the same</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; increment as the `rate`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : float</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; The NPV of the input cash flow series `values` at the discount `rate`.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Notes</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -----</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns the result of:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; .. math :: \\sum_{t=1}^M{\\frac{values_t}{(1+rate)^{t}}}</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>values</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>values</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='op'>(</span><span class='nam'>values</span> <span class='op'>/</span> <span class='op'>(</span><span class='num'>1</span><span class='op'>+</span><span class='nam'>rate</span><span class='op'>)</span><span class='op'>**</span><span class='nam'>np</span><span class='op'>.</span><span class='nam'>arange</span><span class='op'>(</span><span class='num'>1</span><span class='op'>,</span><span class='nam'>len</span><span class='op'>(</span><span class='nam'>values</span><span class='op'>)</span><span class='op'>+</span><span class='num'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>.</span><span class='nam'>sum</span><span class='op'>(</span><span class='nam'>axis</span><span class='op'>=</span><span class='num'>0</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm run hide_run'><span class='key'>def</span> <span class='nam'>mirr</span><span class='op'>(</span><span class='nam'>values</span><span class='op'>,</span> <span class='nam'>finance_rate</span><span class='op'>,</span> <span class='nam'>reinvest_rate</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='pln'>&nbsp; &nbsp; <span class='str'>&quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Modified internal rate of return.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Parameters</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; ----------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; values : array_like</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Cash flows (must contain at least one positive and one negative value)</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; or nan is returned.</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; finance_rate : scalar</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Interest rate paid on the cash flows</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; reinvest_rate : scalar</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Interest rate received on the cash flows upon reinvestment</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; Returns</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; -------</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; out : float</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &nbsp; &nbsp; Modified internal rate of return</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='str'>&nbsp; &nbsp; &quot;&quot;&quot;</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>values</span> <span class='op'>=</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>asarray</span><span class='op'>(</span><span class='nam'>values</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>pos</span> <span class='op'>=</span> <span class='nam'>values</span> <span class='op'>&gt;</span> <span class='num'>0</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>neg</span> <span class='op'>=</span> <span class='nam'>values</span> <span class='op'>&lt;</span> <span class='num'>0</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>if</span> <span class='key'>not</span> <span class='op'>(</span><span class='nam'>pos</span><span class='op'>.</span><span class='nam'>size</span> <span class='op'>&gt;</span> <span class='num'>0</span> <span class='key'>and</span> <span class='nam'>neg</span><span class='op'>.</span><span class='nam'>size</span> <span class='op'>&gt;</span> <span class='num'>0</span><span class='op'>)</span><span class='op'>:</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; &nbsp; &nbsp; <span class='key'>return</span> <span class='nam'>np</span><span class='op'>.</span><span class='nam'>nan</span><span class='strut'>&nbsp;</span></p>
<p class='pln'><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>n</span> <span class='op'>=</span> <span class='nam'>pos</span><span class='op'>.</span><span class='nam'>size</span> <span class='op'>+</span> <span class='nam'>neg</span><span class='op'>.</span><span class='nam'>size</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>numer</span> <span class='op'>=</span> <span class='op'>-</span><span class='nam'>npv</span><span class='op'>(</span><span class='nam'>reinvest_rate</span><span class='op'>,</span> <span class='nam'>values</span><span class='op'>[</span><span class='nam'>pos</span><span class='op'>]</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='op'>(</span><span class='num'>1</span><span class='op'>+</span><span class='nam'>reinvest_rate</span><span class='op'>)</span><span class='op'>**</span><span class='nam'>n</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='nam'>denom</span> <span class='op'>=</span> <span class='nam'>npv</span><span class='op'>(</span><span class='nam'>finance_rate</span><span class='op'>,</span> <span class='nam'>values</span><span class='op'>[</span><span class='nam'>neg</span><span class='op'>]</span><span class='op'>)</span><span class='op'>*</span><span class='op'>(</span><span class='num'>1</span><span class='op'>+</span><span class='nam'>finance_rate</span><span class='op'>)</span><span class='strut'>&nbsp;</span></p>
<p class='stm mis'>&nbsp; &nbsp; <span class='key'>return</span> <span class='op'>(</span><span class='nam'>numer</span> <span class='op'>/</span> <span class='nam'>denom</span><span class='op'>)</span><span class='op'>**</span><span class='op'>(</span><span class='num'>1.0</span><span class='op'>/</span><span class='op'>(</span><span class='nam'>n</span><span class='op'>-</span><span class='num'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-</span> <span class='num'>1</span><span class='strut'>&nbsp;</span></p>
    
</td>
</tr>
</table>
</div>

</body>
</html>
